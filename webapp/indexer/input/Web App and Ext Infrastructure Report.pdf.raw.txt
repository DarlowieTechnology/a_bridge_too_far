report for: web application and external infrastructure security assessment sample report clientname  version 3.0- page 1 of 29 1 executive summary this report presents the findings of the web application and external infrastructure security assessment conducted on behalf of client company ltd (clientname). the assessment was conducted between 15/03/2021 and 19/03/2021 and was authorised by clientname. the system being assessed allowed users to log into a website to create an insurance claim, upload supporting information (such as photographs or word documents) and review the progress of the claim. the system contained a considerable amount of personally identifiable information (pii). 1.1 overview several of the issues identified in the web application were assessed to expose the organisation to unnecessary risk. these were largely associated with the web application, with a lesser degree of risk associated with the external infrastructure. two separate application vulnerabilities could allow any user who had logged into the application to extract data from the back-end database. this data is expected to include pii such as customer names, addresses and contact information, together with details of current and resolved insurance claims. as such, any unauthorised access to this data could have regulatory implications. if a compromise which resulted in the disclosure of sensitive information became public knowledge, this could also result in reputational damage. the following table breaks down the issues which were identified by component and severity of risk (issues which are reported for information only are not included in the totals): component critical high medium low total phase 1-web application assessment 1 1 1 2 5 phase 2-external infrastructure assessment 0 0 1 5 6 total 1 1 2 7 11 1.2 assessment summary the most significant issue was assessed to pose a critical risk. a user who was logged into the web application could use sql injection to extract information from the underlying database. this information is expected to be of considerable sensitivity, unauthorised disclosure of which would adversely affect the business. the web application included a feature which allowed users to upload files providing evidence in support of claims. however, a weakness in this mechanism was assessed to pose a high risk. users could upload a wide range of file types, including some for which there is not expected to be a business requirement. in addition, no anti-virus scanning of the uploaded files was performed. this could result in the upload of malicious files or malware. in this specific instance, it would allow an attacker to upload a file which could allow them to run commands of their own choosing on the server. this might allow them to access the sensitive information held on that server. the web application was also found to be vulnerable to reflected cross-site scripting. attacks of this nature can be used to target other legitimate users of an application and are typically used to recover sensitive information such as login credentials or other personal information. version 3.0- page 2 of 29the most significant vulnerability identified in the external infrastructure was the presence of administration interfaces that were accessible from the internet. login pages to privileged functionality should be restricted so that they are only available from a limited set of trusted ip addresses. exposing them publicly greatly increases the opportunity for them to be attacked; for instance, with password attacks designed to gain unauthorised access. it is worth noting that the risk of automated password attacks had been mitigated in this instance by the use of an effective account lock out mechanism. more detailed information on each of the issues which were identified is included in the technical details section of this report. 1.3 strategic recommendations the sql injection and reflected cross-site scripting issues which were identified have a common cause: insufficient validation of the input submitted from a web browser to the back-end systems. it is seldom possible to identify all the instances of this issue within a black box assessment of this type and so it is strongly recommended that a thorough code review of the application should be performed. it is important that any remedial activity should be applied to the entire application rather than just those instances documented here. use of standard libraries to perform input validation or output encoding as appropriate to the application context would help to ensure that these mechanisms were consistently applied while also minimising the associated code maintenance overhead. as this is a live system, consideration should also be given to performing a forensic investigation to establish (if possible) whether this issue has already been exploited and the extent of any compromise which may have occurred. review the file upload mechanism and ensure that only those file types for which there is a business need can be uploaded. in this case, this is expected to be image files, word documents and possibly pdfs. files not conforming to these types should be rejected or quarantined pending further investigation. in addition, it should be ensured that effective real time anti-virus scanning is performed on all uploaded files to prevent malware being uploaded and distributed. steps should be taken to ensure that access to privileged or administrative functionality is suitably restricted. exposure of these interfaces to the internet unnecessarily increases the opportunity for attack. access should be restricted to trusted internal ip addresses only. it is recommended that the issues set out in this report should be addressed by a structured programme of remedial actions which are prioritised in accordance with the perceived risk to the organisation. it is important to recognise that even low risk issues can be exploited in combination with other issues as part of a wider attack which seeks to compromise an environment or application. in addition, resolving lower risk issues can have the dual benefit of reducing the attractiveness of systems to opportunistic attackers as well as enhancing the overall security posture. version 3.0- page 3 of 292 table of contents 1 executive summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.1 overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.2 assessment summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.3 strategic recommendations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 2 table of contents. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 3 technical summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.1 scope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.2 caveats . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.3 post assessment cleanup. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.4 risk ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 3.5 findings overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 4 technical details. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 5 supplemental data - sslscan output. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25 6 supplemental data - ssl certificate details. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26 7 supplemental data - icmp details. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27 8 document control. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 8.1 document data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 8.2 document history . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 8.3 document distribution list . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 9 assessment team . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 version 3.0- page 4 of 293 technical summary test organization was contracted by clientname to conduct a security assessment of the web application and its associ- ated external infrastructure in order to identify security issues that could negatively affect clientname's business or reputation if they led to the compromise or abuse of systems. 3.1 scope the security assessment was carried out in the live environment and included: u web application assessment u external infrastructure assessment the ip address and url within the scope of this test is listed below: u 192.001/1/111 (www.clientwebsite.com) 3.2 caveats due to the nature of the environment, checks that would have a high probability of causing disruption to the named hosts were excluded. denial of service attempts were excluded for the same reason. 3.3 post assessment cleanup any test accounts which were created for the purpose of this assessment should be disabled or removed, as appro- priate, together with any associated content. revert any waf/ids/ips/firewall changes which were made for the purposes of the assessment. version 3.0- page 5 of 293.4 risk ratings the table below gives a key to the icons and symbols used throughout this report to provide a clear and concise risk scoring system. it should be stressed that quantifying the overall business risk posed by any of the issues found in any test is outside our remit. this means that some risks may be reported as high from a technical perspective but may, as a result of other controls unknown to us, be considered acceptable. symbol risk rating cvssv2 score explanation critical 9.0 - 10 a vulnerability was discovered that has been rated as critical. this requires resolution as quickly as possible. high 7.0 - 8.9 a vulnerability was discovered that has been rated as high. this requires resolution in the short term. medium 4.0 - 6.9 a vulnerability was discovered that has been rated as medium. this should be resolved as part of the ongoing security maintenance of the system. low 1.0 - 3.9 a vulnerability was discovered that has been rated as low. this should be addressed as part of routine maintenance tasks. info 0 - 0.9 a discovery was made that is reported for information. this should be addressed in order to meet leading practice. good n/a good security practices were being followed or an audit item was found to be present and correct. version 3.0- page 6 of 293.5 findings overview all the issues identified during the assessment are listed below with a risk rating for each issue. ref finding risk sr-101-001 sql injection critical sr-101-002 uploaded file types were not restricted high sr-101-003 reflected cross-site scripting medium sr-101-007 login to administrative interface exposed medium sr-101-004 asp.net header disclosure low sr-101-005 http header discloses internal ip address low sr-101-009 wsdl descriptions could be obtained by unauthenticated users low sr-101-010 invalid ssl certificate low sr-101-012 hosts respond to icmp low sr-101-013 directory listings enabled low sr-101-015 no support for tls versions above 1.0 low sr-101-014 beast ssl / tls weaknesses info version 3.0- page 7 of 294 technical details sr-101-001 sql injection risk rating critical status open description: a critical sql injection vulnerability was found on one php page, allowing full access to the site's back-end database and extraction of sensitive customer details. this vulnerability occurs when user-supplied input is used in the dynamic construction of a sql query, without sufficient input validation being performed. this is usually a very serious vulnera- bility, as it effectively allows a remote attacker to execute (often arbitrary) sql commands on the underlying database server with the privileges of the web application's database access, leaving the database open to execution of stored procedures, privilege escalation, and information retrieval. it is important to note that this issue could be exploited by unauthenticated attackers. sql injection vulnerabilities of this nature are frequently the cause of high-profile website breaches, so it is strongly recommended that this issue is investigated further. the vulnerability was identified in at least one of the php pages (/scabc/vulnerable_page.php, job parameter). the results of an arbitrary query could be seen in the page by using the union operator to inject an additional select query into the job parameter of the url. in the screenshot below, the query injected is select user(): http://www.testorg-client.co.uk/scabc/vulnerable_page.php?job=171%20union%20select%201,2,3,user%28%29, 5,6,7,8,9,10,11,12,13,14,15,16%20order%20by%201%20asc--&postcode=m1%207ef&r=1145767722 data could be extracted efficiently using the mysql limit and offset query options, obtaining one result row per http request. for example, a query such as that shown below could be used to obtain the name of the first table in the contact database (schema): http://www.testorg-client.co.uk/scabc/jo3.php?job= 171union select 1,2,3,table_name,5,6,7,8,9,10,11,12,13,14,15,16 from information_schema.tables wher e table_schema = 0x6f6e65636f6e74616374 order by 1 asc limit 1 offset 1-- &postcode=m1 7ef&r=1145767722 the offset parameter would then be incremented to get the next row. the current database was identified as contact, with contact_agent and contact_test also being present. version 3.0- page 8 of 29a list of tables for the current database was extracted as follows: figure 1: extracted information all customer data (such as addresses and security questions and answers) could be eventually be extracted from the database using this technique. recommendation: the breach was possible due to vulnerabilities in the php source code which queried the back-end database. while only a single parameter in one php page was identified as vulnerable, it is possible that further such vulnerabilities exist which were not discovered within the time constraints of the current black box test. the source code of all pages should be reviewed for code patterns similar to those found in the vulnerable page, and all pages should be recoded to use prepared statements for database access.1, 2, 3 the same principle of using strict input validation and prepared statements applies equally to new development in other web frameworks such as asp or asp.net. banning particular sql keywords in input as a fix for sql injection is discouraged as this is often ineffective and can be evaded. further measures should be taken as part of a defence-in-depth strategy. passwords should be stored as salted hashes and sensitive details (such as security questions/answers) should be stored encrypted. users should be prevented from setting very weak passwords and be advised to not use the same passwords they use elsewhere. in general, dynamic sql should not be used within the application. environments such as j2ee, asp.net, php, and perl support the use of parameterised queries or prepared statements to ensure that the structure of the sql statement is defined prior to entering user input. if it is necessary to use dynamic sql, user input should be validated and sanitised first. numeric input should be passed through a numeric check, and string input should be fixed to escape the single quote (') character. affects: ip address dns name 192.001.1.111 www.clientwebsite.com 1owasp guidancehttps://www.owasp.org/index.php/sql_injection https://www.owasp.org/index.php/sql_injection_prevention_cheat_sheet ht tps://www.owasp.org/index.php/query_parameterization_cheat_sheet 2owasp top 10-injection https://owasp.org/www-project-top-ten/2017/a1_2017-injection 3cwe-089: improper neutralization of special elements used in an sql command ('sql injection')https://cwe.mitre.org/data/definitions/ 89.html version 3.0- page 9 of 29sr-101-002 uploaded file types were not restricted risk rating high status open description: the application allowed any type of file to be uploaded, without performing anti-virus scanning or other content checking against the uploaded file. this meant that attackers could target other users of the application by uploading malware to the server. they might also have been able target the server itself, by uploading a web shell that would provide the attacker with the capability to run commands on the server and access the file system with the full privileges of the web server process. it was also possible for an attacker to upload a malicious executable to the server. as a proof of concept, a web shell was uploaded to the server. weaknesses in the manner in which these files were stored meant it was then possible to execute the web shell under the context of the user logged into the application which allowed some limited command execution. more generally, files could also be downloaded and so might be run by other regular users which could, for instance, facilitate the spread of malware. it was also possible to upload a flash file with an allowed extension such as .jpg; such a file could be used in a cross-site data hijacking attack. figure 2: flash file with amended file extension accepted for upload it was also found that uploaded files were robustly scanned for malware. as a proof of concept, the eicar file was uploaded. this is a benign file used to test the response of anti-virus software. the application allowed the upload of this file without any apparent server-side restriction, scanning, or removal of the file. recommendation: the file types allowed to be uploaded should be restricted to only those that are necessary for business functional- ity.4, 5, 6, 7, 8 the application should perform filtering and content checking on any files which are uploaded to the server. files should be thoroughly scanned and validated before being made available to other users. if in doubt, the file should be discarded. 4owasp guidancehttps://www.owasp.org/index.php/unrestricted_file_upload 5eicar test filehttp://www.eicar.org/86-0-intended-use.html 6cwe-434: unrestricted upload of file with dangerous typehttps://cwe.mitre.org/data/definitions/434.html 7sans -8 basic rules to implement secure file uploadshttp://software-security.sans.org/blog/2009/12/28/8-basic-rules-to-implement-secure- file-uploads/ 8the pitfalls of allowing file uploads on your websitehttp://blog.detectify.com/post/86298380233/the-pitfalls-of-allowing-file-uploads-on-your- website version 3.0- page 10 of 29an anti-virus solution should be used to check the uploaded file; any files flagged as potentially malicious should be discarded. note that the effectiveness of content-checking controls should not be wholly relied upon, and that they will only provide benefit if the anti-virus and malware signatures are regularly updated. some consideration should be given to storing uploaded files in a database, rather than on the file system. this would significantly reduce the risk associated with the file upload facility, but it is recognised that this might require extensive changes to the current application design. write permission should be removed from files and folders other than the upload folders, if these are accessible to the application. in iis7 or higher, it is a good practice to disable or remove the dynamic extensions from the upload folders by using the "handler mappings" section. adding a "content-disposition: attachment" header to static files such as pdf and document files will secure the website against flash-based cross-site data hijacking. this can be done by using "http response headers" in iis for the upload folders. affects: ip address dns name 192.001.1.111 www.clientwebsite.com version 3.0- page 11 of 29sr-101-003 reflected cross-site scripting risk rating medium status open description: the application was vulnerable to reflected or non-persistent cross-site scripting (xss) attacks. this type of vulnerability occurs when data provided by a web client is used immediately by server-side scripts to generate a page of results for the user. if unvalidated user-supplied data is included in the resulting page without full and proper html escaping, client-side executable code may be injected into the dynamic page. in the case of a get request, this means that a url which appears to be associated with the site (and therefore trustworthy to regular users) could contain malicious code that would be executed by the user's browser within the context of the application when the link is visited. in the case of a post request, a victim user would have to first be coerced to an otherwise unrelated site which then launches attack using a form. figure 3: xss payload (in this case, a simple message) being executed under user's context evidence of affected urls, parameters, requests and responses has been redacted. reflected cross-site scripting vulnerabilities are extremely common in web applications but can have a serious impact. they are typically used to launch site impersonation or phishing attacks, in which unsuspecting users are lured to malicious sites via links that appear legitimate. the attacker is then free to present the user with what appears to be genuine content, in an attempt, for example, to capture authentication credentials. another common method of exploitation is to capture the session token of the victim user, allowing their session to be hijacked by the attacker. recommendation: reliable avoidance of cross-site scripting vulnerabilities should consist of two stages - input validation and output encoding.9, 10, 11 input validation involves the application rejecting any characters which are invalid for the field in question, preferably by whitelisting a limited set of characters (in a telephone number field, for example, the whitelisted characters could be 0-9, parentheses, and hyphens). this strategy can also help in mitigating other flaws which stem from a failure to sanitise input, such as sql or http header injection attacks. output encoding requires the encoding of all special characters (such as those used in html and javascript) in 9owasp xss referenceshttps://www.owasp.org/index.php/cross-site_scripting_(xss) https://www.owasp.org/index.php/xss_(cross_site_scriptin g)_prevention_cheat_sheet 10owasp top 10-cross-site scriptinghttps://owasp.org/www-project-top-ten/2017/a72017-cross-site_scripting(xss) 11cwe-079: improper neutralization of input during web page generation ('cross-site scripting')https://cwe.mitre.org/data/definitions/ 79.html version 3.0- page 12 of 29potentially malicious data. this is generally done directly before display by web applications (or client-side script), and many programming languages have built-in functions or libraries which provide this encoding (also called quoting or escaping in this context). note that the correct encoding of the output depends on the location that the data is to be used within the response. in the case of it being within the main body of the document, html entities must be encoded. if the input is to be used within a script inside of a string, the quotes used for that string must be escaped. in general, it is important to ensure that it is not possible for the data to include whatever sequence is used to demark the end of that data and the beginning of something else. the pages listed should be modified to handle malicious data properly in the associated fields. affects: ip address dns name page parameters 192.001.1.111 www.clientwebsite.com vulnerablepage.html aed222, aed223 version 3.0- page 13 of 29sr-101-007 login to administrative interface exposed risk rating medium status open description: a number of login pages for accessing administrative interfaces were identified during testing of the external infras- tructure. this is against security best practice which recommends that login pages to access such interfaces should be only available to trusted ip addresses. the following login pages were identified: testorg-client.co.uk/login recommendation: implement access control lists which only allow access from trusted ip addresses. affects: ip address dns name 192.001.1.111 www.clientwebsite.com version 3.0- page 14 of 29sr-101-004 asp.net header disclosure risk rating low status open description: various headers produced by the application provide information about the software installed on the web server. an attacker may use this information to gain a greater understanding of the underlying technologies involved and tailor further attacks to these specific products. it is therefore good practice to exclude information such as this from http responses. an example http response from the server is shown below: figure 4: http response the highlighted headers revealed the exact version of asp.net which is in use. recommendation: the web server should be reconfigured so that software version information is not included in http responses.12, 13, 14, 15, 16 u for iis 7.5 and later, the url rewrite http module available from microsoft can be configured to remove the server header from iis responses. u the x-powered-by header can be removed via the "custom http headers" section of iis manager for the relevant site. u the x-aspnet-version header can be removed by adding the following node to the <httpruntime enableversionheader="false" /> u the x-aspnetmvc-version header can be removed by adding the following line of code to the applicationstart method of the application's global.asax.cs file: mvchandler.disablemvcresponseheader = true; 12cwe-200: information exposure: https://cwe.mitre.org/data/definitions/200.html 13msdn - remove unwanted http response headers: http://blogs.msdn.com/b/varunm/archive/2013/04/23/remove-unwanted-http-response- headers.aspx 14removing unnecessary http headers in iis and asp.net: http://www.4guysfromrolla.com/articles/120209-1.aspx 15owasp examples: https://www.owasp.org/index.php/testing_for_web_application_fingerprint_(owasp-ig-004) 16change or modify a response header value using url rewrite: http://blogs.msdn.com/b/benjaminperkins/archive/2012/11/02/change-or- modify-a-response-header-value-using-url-rewrite.aspx version 3.0- page 15 of 29affects: ip address dns name 192.001.1.111 www.clientwebsite.com version 3.0- page 16 of 29sr-101-005 http header discloses internal ip address risk rating low status open description: it was possible to determine an internal ip address by sending a crafted request to the application. an attacker may use this information to gain a greater understanding of the internal network and tailor further attacks. the http request and response shown below illustrate this issue. figure 5: http response recommendation: on iis version 7 and above, this issue can be addressed by setting the iis alternatehostname property (as described at the www.iis.net link below). this allows the specified hostname to be used in place of the internal ip address in redirection responses. testing should be performed to ensure that this does not adversely affect any legitimate redirection functionality in the application.17, 18, 19 affects: ip address dns name 192.001.1.111 www.clientwebsite.com 17cwe-200: information exposure:https://cwe.mitre.org/data/definitions/200.html 18server runtime <serverruntime>:http://www.iis.net/configreference/system.webserver/serverruntime 19microsoft support-fix: http://support.microsoft.com/kb/834141 version 3.0- page 17 of 29sr-101-009 wsdl descriptions could be obtained by unauthenti- cated users risk rating low status open description: it was possible to retrieve web services description language (wsdl) from web service endpoints as an anonymous user. whilst this functionality could be of use to a legitimate developer, it would also help an attacker to determine the methods exposed by a service and how to create a well-formed request. figure 6: wsdl file recommendation: for wcf services, the displaying of exception details is largely controlled with the "servicemetadata" property, which is set in the web.config file. to prevent the download of wsdl descriptions, the configuration directive should be set as shown:20, 21, 22 <servicedebug includeexceptiondetailinfaults="false"/> alternatively, the urlscan tool, the iis request filtering feature, or a web application firewall could be used to block incoming requests for wsdl descriptions. affects: ip address dns name 192.001.1.111 www.clientwebsite.com 20<servicemetadata> behaviour:http://msdn.microsoft.com/en-us/library/ms731317(v=vs.110).aspx 21iis request filtering:http://www.iis.net/configreference/system.webserver/security/requestfiltering 22microsoft's free security tools-urlscan security tool:http://blogs.technet.com/b/security/archive/2013/01/22/microsoft-s-free-security-tools- urlscan-security-tool.aspx version 3.0- page 18 of 29sr-101-010 invalid ssl certificate risk rating low status open description: the ssl certificate installed on the service was invalid, and would not be trusted by connecting applications. this would make a man-in-the-middle attack easier to perform. the certificate was invalid because: u it was self-signed - the endpoint cannot be validated because the certificate has not been issued by a recognised certificate authority a screenshot showing the certificate and highlighting the relevant detail can be seen insupplemental data - ssl certificate details on page 26. an end user attempting to contact the secure service would likely be presented with a certificate warning, which to most users would be indistinguishable from the warning associated with a fraudulent certificate. the chance of a successful man-in-the-middle attack against the remote host is therefore increased. such an attack would allow the attacker to view and edit data in transit without the knowledge of the end user. in addition, a certificate warning being issued by the browser could reduce user confidence in the site's security. recommendation: a new ssl certificate should be purchased or generated to replace the existing one. the certificate should be signed by an established certificate authority and cover all the hosts on which it will be installed (preferably using subject alternative names where multiple hostnames are required).23, 24, 25, 26 affects: ip address dns name 192.001.1.111 www.clientwebsite.com 23crying wolf: an empirical study of ssl warning effectiveness:http://lorrie.cranor.org/pubs/sslwarnings.pdf 24benign security warnings have trained users to ignore them:http://arstechnica.com/security/2009/07/benign-security-warnings-have-trained-u sers-to-ignore-them/ 25alice in warningland: a large-scale field study of browser security warning effectiveness:https://www.usenix.org/conference/usenixsecurity13 /technical-sessions/presentation/akhawe  version 3.0- page 19 of 29sr-101-012 hosts respond to icmp risk rating low status open description: hosts were found to respond to icmp messages. further information has been included insupplemental data - icmp details on page 27. recommendation: all inbound and outbound icmp messages should be restricted at border routers and firewall devices; if they are specifically required for legitimate business reasons then access control lists for these services should be applied. note that completely disabling icmp may restrict pmtu discovery and might affect other applications on the network. the icmp requirements for the network should be considered before implementing any changes to filtering controls. affects: ip address dns name 192.001.1.111 www.clientwebsite.com version 3.0- page 20 of 29sr-101-013 directory listings enabled risk rating low status open description: directory listings were enabled for the site. this allows an attacker to browse directories for which there is no index page (e.g. index.html, index.php, or default.aspx) present. this can be used to gain knowledge of the file and folder structure, and makes it easy to look for information that may be useful when carrying out a targeted attack, such as the specific frameworks or libraries in use. it may also lead to the discovery of sensitive files which, without directory listings, would be much harder to find by brute-force. figure 7: screenshot of file structure recommendation: directory listings should be disabled.27, 28 for iis, this can be achieved in iis manager via the directory browsing section - the "disable" option should be se- lected. alternatively, the change can be carried out by direct modification of the relevant web.config file, in the system.webserver/directorybrowse attribute.29 affects: ip address dns name 192.001.1.111 www.clientwebsite.com 27cwe-548: information exposure through directory listing:http://cwe.mitre.org/data/definitions/548.html 28enable or disable directory browsing in iis 7:http://technet.microsoft.com/en-us/library/cc731109(ws.10).aspx http://technet.microsoft.com/en- us/library/cc731109(ws.10).aspx 29directory browse setting:http://www.iis.net/configreference/system.webserver/directorybrowse version 3.0- page 21 of 29sr-101-015 no support for tls versions above 1.0 risk rating low status open description: the affected server did not support tls above version 1.0. since 2008, tls has been at version 1.2, with version 1.3 being defined in august 2018. versions 1.2 and 1.3 of tls are more resistant to known attacks, and tlsv1.2 supports more modern cipher suites that are widely acknowledged to offer the best cryptography available for securing internet connections. tlsv1.3 further improves on security by removing unsafe or unused features, eliminating unnecessary handshake steps and forcing the use of newer encryption methods. t should be noted that use of tls 1.0 and 1.1 is now flagged as insecure (such as by browser warnings) by the major browsers, and in january 2021 the nsa issued guidance urging system administrators to only provide support for tls versions 1.2 or 1.3.30 tls 1.0 was the highest protocol version supported, as shown insupplemental data - sslscan output on page 25. recent versions of all web browsers support 1.2 and 1.3, and therefore supporting these protocols server-side offers better security for those clients using modern browsers. tlsv1.2 also supports a class of cipher suites that offer authenticated encryption with associated data (aead). these cipher suites include an authenticated integrity check within the encryption operation, and are resistant to more attacks than their older counterparts. google's chrome browser states that the security of connections to websites that do not use aead ciphers is "obsolete". currently, this is not presented as an error to the user, merely as information for anyone viewing the page's security report (in the browser's developer console). however, as google continues to push for the rapid adoption of more robust internet cryptography, this message may become more prominent. tlsv1.3 was approved for use in august 2018 and goes to further enhance security. the security benefits of tlsv1.3 include the removal of unsafe or unused features, elimination of unnecessary handshake steps and the forced use of newer encryption methods. as well as preventing encryption downgrade attacks, the streamlined approach to session initiation will offer performance gains over previous tls implementations. supporting tls 1.0 as a security control is non-compliant with the payment card industry (pci) data security standard (dss). while these regulations may not be directly relevant, it should be expected that this directive will become security best practice and may also be reflected in more obvious ways, such as web browser warnings. refer also to thefinding sr-101-014 on page 24. recommendation: add support for tls v1.2 and v1.3.31, 32, 33, 34, 35, 36, 37 support for tls version 1.0 should be disabled unless there is a specific business requirement to allow users of older, less secure browsers to continue to connect. consider also disabling support for version 1.1, which will become unsupported by major browsers in the near future. all affected hosts should be configured to prefer the latest cipher suites that they offer, such as aes-gcm (tls 1.2 and 1.3 only). the reference from mozilla below provides recommendations on cipher suite ordering based on the profile of con- necting clients. 30eliminating obsolete transport layer security (tls) protocol configurations -https://media.defense.gov/2021/jan/05/2002560140/-1/-1/0/elimi nating_obsolete_tls_uoo197443-20.pdf 31mozilla server side tls:https://wiki.mozilla.org/security/server_side_tls#recommended_configurations 32obsolete cipher suites:https://www.chromium.org/home/chromium-security/education/tls#toc-obsolete-cipher-suites 33owasp transport layer protection cheat sheet:https://cheatsheetseries.owasp.org/cheatsheets/transport_layer_protection_cheat_sheet.html 35 pci security standards council:https://www.pcisecuritystandards.org/documents/migrating-from-ssl-early-tls-info-supp-v1_1.pdf 36saying goodbye to ssl/early tls:blog.pcisecuritystandards.org 37overview of tls v1.3:https://owasp.org/www-pdf-archive/owasplondon20180125_tlsv1.3_andy_brodie.pdf version 3.0- page 22 of 29affects: ip address dns name 192.001.1.111 www.clientwebsite.com version 3.0- page 23 of 29sr-101-014 beast ssl / tls weaknesses risk rating informational status open description: a vulnerability that could allow information disclosure exists in ssl and version 1.0 of tls. the weakness is caused by an improper choice of initialisation vector (iv) used by block ciphers operating in cipher block chaining (cbc) mode. the exploit that takes advantage of the vulnerability is known as "browser exploit against ssl/tls" (beast). beast allows attackers to compromise the confidentiality of connections to reveal short sections of plaintext, with session cookies being the most likely target. the potential for the beast vulnerability has been reported here because the servers were seen to support block ciphers in cbc mode operating under vulnerable ssl/tls protocol versions. the beast attack itself is a client-side attack and requires the attacker to not only be in a position to inspect the encrypted traffic but also to initiate crafted requests made from the victim's browser. in addition to this requirement, the major browser vendors have implemented client-side fixes for the iv flaw (apple being the last to do so in october 2013) and thus users with up-to-date browsers should not be affected. for these reasons the issue has been rated as informational. recommendation: no server-side remedial action can fully eliminate the conditions necessary for a successful beast attack. while disabling ssl is recommended, removing support for tls version 1.0 could prevent some users from accessing the service.38, 39, 40 while prioritising the use of cipher suites based on the rc4 stream cipher would mitigate beast, rc4 has been shown to suffer from cryptographic flaws that mean this action is not a recommended solution. tls versions 1.1 and 1.2 are not susceptible to the weak iv design. however, while supporting them is recommended, that does not specifically resolve the beast attack because the man-in-the-middle attacker can launch what is known as a "protocol downgrade attack". in this attack the man-in-the-middle interferes with the tls connection to try to force browsers to use lower tls versions that are vulnerable to beast. this downgrade attack can be mitigated by supporting the tls_fallback_scsv mechanism, but this must also be supported by the user's browser for the mitigation to work. affects: ip address dns name 192.001.1.111 www.clientwebsite.com 38original beast attack:http://vnhacker.blogspot.co.uk/2011/09/beast.html 40 ssl labs:https://community.qualys.com/blogs/securitylabs/2013/09/10/is-beast-still-a-threat https://community.qualys.com/blogs/securitylabs/ 2013/10/31/apple-enabled-beast-mitigations-in-os-x-109-mavericks version 3.0- page 24 of 295 supplemental data - sslscan output redacted. version 3.0- page 25 of 296 supplemental data - ssl certificate details figure 8: ssl certificate with invalid fields highlighted version 3.0- page 26 of 297 supplemental data - icmp details redacted. version 3.0- page 27 of 29 8 8.1 document data data classification client name clientname project reference 99999 proposal reference p99999-sample document title web application and external infrastructure security assessment sample report