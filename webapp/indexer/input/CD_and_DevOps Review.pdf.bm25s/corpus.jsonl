{"id":0,"text":"sr-128-1-1 ssh private key in s3 bucket \n sr-128-1-1 high one ssl private key was identified in the private github repository. whilst the key was not immediately exposed to unauthorised access, storing keys such as this in an online location (and in an unencrypted format) places them at risk of compromise if an attacker gains access to the github account or aws s3 bucket. information could also be disclosed if a client device where the repositories had been cloned were lost or stolen."}
{"id":1,"text":"sr-128-1-2 credentials in github repository \n sr-128-1-2 medium some instances of what appeared to be aws and jfrog passwords or credentials were noted in the private github project repository. whilst it was not possible to establish from the repositories alone whether all of these were in use in production, in general it is not recommended that credentials should be stored in source code repositories in clear text."}
{"id":2,"text":"sr-128-1-3 good practice observed \n sr-128-1-3 risk rating good it was apparent that security had been a consideration in the development and deployment of the pipeline and its environment. the risk from various security flaws had been effectively mitigated. a number of useful controls and processes were observed to be in place. these included: * enforced code reviews * defined checks for committing * separate teams were responsible for different systems * developers could not bypass pipeline steps to introduce new code or change existing code * the use of multi-factor authentication was enforced for all aws and github access"}
{"id":3,"text":"sr-128-2-1 github oauth misconfiguration \n sr-128-2-1 high the github oauth plugin provided authentication and authorisation methods for the jenkins server. the authorisation settings granted read permissions to all authenticated users. this meant that any user registered with and logged into github could access jenkins, even though the participant in organization setting was originally set to prevent users from outside the organisation being able to access jenkins."}
{"id":4,"text":"sr-128-2-2 jenkins broken access control \n sr-128-2-2 high jenkins extends its functionality with plugins that c an be developed by third party companies or by individuals. the github oauth plugin was identified as being responsible for authentication and authorisation. however, this plugin contained a bug that ignored the permission relationships and allowed any users to access data , even when this should have been denied as a result of that user's permissions."}
{"id":5,"text":"sr-128-2-3 outdated jenkins software \n sr-128-2-3 medium the installed version of jenkins server was outdated and affected by a number of security vulnerabilities. the observed version of the jenkins was 2. 231 while the latest version (at the time of writing) is 2. 259. known software vulnerabilities which were unpatched in the observed version included csrf and xss weaknesses. known issues also included missing permissions checks and the potential disclosure of s mtp passwords. these vulnerabilities could allow an attacker to steal the session of an administrator, gain access to sensitive information or create files and potentially execute code on the host system. this issue has been rated as a medium risk to reflect these issues and their assigned cvss scores."}
{"id":6,"text":"sr-128-2-4 csrf protection disabled \n sr-128-2-4 medium the built-in jenkins csrf token had not been enabled. this increases the risk of a successful csrf attack which could allow an attacker to manipulate a user or an administrator into unwittingly performing actions within the application (such as changing the account password, adding accounts to the system and changing settings) on behalf of the attacker. figure 5 - crsf protection option not enabled for a csrf attack to succeed, the victim must click a malicious link or visit a malicious web page while logged in to the vulnerable application. this would cause the victim's browser to issue get or post requests to the vulnerable site by means of hidden images or embedded javascript code. as far as the application is concerned, these forged requests would appear to be the result of genuine actions performed by real users clicking on elements within the application. this is because the application did not sufficiently validate requests (such as by means of random tokens) to allow it to make this distinction."}
{"id":7,"text":"sr-128-2-5 clear text credentials \n sr-128-2-5 low jenkins uses the workspace directory to build projects, to store the checkout source code and to store the files generated by the build itself. however, some files in the workspace directory w ere not automatically deleted . some of these remaining files included credentials in clear text format, and had world readable permissions."}
{"id":8,"text":"sr-128-3-1 root account used recently \n sr-128-3-1 medium it was confirmed that the \"root\" account had been used recently as part of the security checks of the amazon console. amazon security best practice recom mends that this account should only be used when strictly necessary. other accounts with more suitably restricted permissions should be used for daily administrative duties. the following screenshot demonstrates that the root account was used recently on t he 2020-08-12: figure 8 - root account usage the use of the root account was discussed with client staff, who revealed that the use of the root account is part of a corporate account, and project staff had no direct control over the account."}
{"id":9,"text":"sr-128-3-2 iam password policy \n sr-128-3-2 medium weaknesses were noted in the password policy enabled in the iam settings. this could result in the creation of weak user passwords , more easily susceptible to recovery by an attacker . furthermore, these settings could allow a weak password to be used for an extended period of time."}
{"id":10,"text":"sr-128-3-3 ebs volumes without encryption \n sr-128-3-3 medium elastic block store (ebs) based full disk encryption (fde) was not enabled on the ebs volumes. due to the nature of a cloud-hosted environment, hosted data stored on virtual drives can be re-assigned to other hosts, often beyond the account that owns it. i f an administrator removes a virtual drive from a hosted machine, this data can be re-assigned elsewhere and in some circumstances recovered. amazon have stated that drives are wiped after deletion; however, fde ensures that if a virtual drive is removed and re-assigned to a different host controlled by another aws account then this data would be very difficult, if not impossible, to recover. the following figure highlights the volumes that did not have encryption enabled: figure 10 - ebs volumes lacking encryption 114 volumes were flagged and are detailed in supplemental data, section 3.3."}
{"id":11,"text":"sr-128-3-4 automated backups not enabled for rds instances \n sr-128-3-4 medium automated backups had not been enabled for a number of relational database service (rds) instances. this feature facilitates the creation of periodic rds instance snapshots, which in turn ensure that data restoration is possible in the event of an incident affecting the source database. the following screenshot from the aws trusted advisor shows that the main-components-db-stage and region-components-db-stage rds instances had automated backups disabled: figure 11 - rds instances with automated backups disabled"}
{"id":12,"text":"sr-128-3-5 s3 bucket configuration allowing clear text communications \n sr-128-3-5 medium the observed configuration for several s3 buckets did not enforce the use of ssl/tls connections, or prevent clients from connecting over clear text protocols. communication between clients and s3 buckets could use unencrypted http as well as https as the use of https was not enforced. as a result, sensitive information could be transmitted in clear text over the network. the following buckets were found not to enforce the use of encrypted communication: * project-jenkins-stage * project-xa-jenkins-stage * project-xb-jenkins-stage"}
{"id":13,"text":"sr-128-3-6 s3 bucket without default encryption \n sr-128-3-6 s3 bucket without default encryption medium s3 bucket without default encryption analysis of the s3 configuration indicated that a number of buckets did not have default encryption enabled. s3 default encryption provides a way to set the default encryption behaviour for an s3 bucket. w hen enabled, all objects will be encrypted when they are stored in the bucket. this will be done automatically, without having to construct a bucket policy that rejects objects that are not encrypted.  the following buckets were found not to have default encryption enabled: * project-jenkins-stage  * project-xa-jenkins-stage  * project-xc-jenkins-stage  * project-y99-jenkins-stage  * project-za-jenkins-stage  * project-xab-jenkins-stage  * project-zd-jenkins-stage  the following screenshot shows an s3 bucket with default encryption not enabled: figure 13 - bucket without default encryption enabled  default encryption was enabled on other s3 buckets configured on the system."}
{"id":14,"text":"sr-128-3-7 policy allows assumerole action for any resource with medium risk rating policy \n sr-128-3-7 medium one of the iam inline security policies reviewed during the assessment included the assumerole action, without limiting it to a specific resource."}
{"id":15,"text":"sr-128-3-8 allowing passing of any role \n sr-128-3-8 medium a number of the iam managed and inline security policies reviewed during the assessment included the  passrole\" action, without limiting it to a specific resource. to pass a role (and its permissions) to an aws service, a user must have permissions to pass the role to the service. this helps administrators ensure that only approved users can configure a service with a role that grants permissions."}
{"id":16,"text":"sr-128-3-9 default security group hardening not implemented \n sr-128-3-9 medium a number of security groups were identified to be using the default rules, allowing all inbound traffic from instances assigned to the same security group, as well as all outbound traffic. the default security group is assigned to new instances created withi n a vpc if no custom security groups are assigned to it during configuration. these rules may be overly permissive, for instance allowing an attacker who has compromised one instance with the default security group assigned to use horizontal privilege esca lation to compromise all other instances configured with the default security group. as can be seen in the following screenshot from an ncc group internal tool used during the assessment, the default security group had permissive rules defined: figure 14 - rules present in default security group the following vpcs were found to have default security groups configured with the default rules: * region 1: vpc 1 vpc 5 * region 2: vpc a vpc b it is good security practice to harden the default security group by removing all rules. any new instance created within a vpc will then be unable to communicate with other instances until custom security groups (conforming to security best practice) have been assigned. recommendation: in order to improve system hardening, remove all rules from the default security group so that it restricts all traffic. should an instance be created without custom security groups, it will inherit the default security grou p and be unable to communicate with other instances within the vpc until the required custom security groups are assigned. each vpc should be configured with custom security groups that conform to the practice of 'least privilege'. these custom security groups should be assigned on a case-by-case basis to the instances that require them, allowing communication within instances and to the wider internet under tightly controlled conditions.version 1.0 - page 37 of 44 client confidential"}
{"id":17,"text":"sr-128-3-10 single availability zone rds instance \n sr-128-3-10 low one relational database service (rds) instance was configured without the multi availability zone option enabled. without this, should an availability zone specific database failure occur, then amazon rds cannot automatically fail over to the standby availability zone so that database operations can resume quickly without administrative intervention. the following database instance was configured with multi-az disabled: * components-db-stage the following screenshot shows that multi-az was disabled for the instance listed above: figure 15 - rds availability zones"}
{"id":18,"text":"sr-128-4-1 kubernetes pod security policy overly permissive \n sr-128-4-1 medium the cluster did make use of the kubernetes pod security policy feature , but was configured to allow any user to create privileged containers. as a result, any user with the ability to create new pods on the cluster would be able to gain privileged access to the underlying cluster nodes and any secrets contained within them. kubernetes provides this feature to restrict the privileges which can be granted by users to newly created pods. this can be used to prevent mounting of host file systems and other rights, which could allow unauthorised access to the underlying operating system running on the cluster nodes. the policies configured within the project-staging cluster did not force pods to run as non-root users, and allowed privileged containers to be created and run. the output below provides evidence of the affected configuration option: <redacted>"}
{"id":19,"text":"sr-128-4-2 kubernetes unrestricted cluster network \n sr-128-4-2 medium there were no egress restrictions on traffic from pods in the cluster network. as a result, a compromised container would be able to attack kubernetes' management interfaces. by default, kubernetes clusters provide an unrestricted flat network for all pods running on them. this can be restricted in recent versions by using kubernetes net work policies. these policies can be defined to restrict inbound and outbound access from the pods running on the cluster. as this feature was not in place it was possible to contact services running in the cluster and the management services running on the nodes."}
{"id":20,"text":"sr-128-4-3  \n sr-128-4-3 medium the kubernetes service was found to be out of date, leaving the clusters and their respective containers potentially open to both security and functional issues that have been patched in later versions. due to its very fast development rate, vulnerabilities that are found in kubernetes often apply to numerous versions; however, patches are usually released soon after to remediate any current issues. issues disclosed in previous versions have included privilege escalation and information disclosure issues, some of which could potentially allow a malicious user to take full control of a cluster. although no significant vulnerabilities were found in the observed versions of kubernetes, it is strongly recommended that all clusters are kept up to date, in line with security best practice."}
