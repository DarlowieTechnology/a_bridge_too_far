report for: database review security assessment sample report clientname march 19, 2021 version: 3.0 prepared by: ncc consultant email: n.consultant@nccgroup.com telephone: +44 (0)161 209 5200 ncc group plc - security testing audit and compliance xyz building, 2 hardman boulevard, spinningfields, manchester, m3 3aq https://www.nccgroup.com version 3.0- page 1 of 32 client confidential1 executive summary this report presents the findings of the database review security assessment conducted on behalf of client com- pany ltd (clientname). the assessment was conducted between 08/03/2021 and 12/03/2021 and was authorised by clientname. the system being assessed was a pair of business-critical databases containing sensitive data. 1.1 overview the issues identified could allow an attacker who had managed to access the internal network on which these databases were located to potentially gain access to the databases and the information they contained. as these databases were analytic sandboxes containing large volumes of collated sales, pricing and customer demographic data, this information is of considerable commercial sensitivity. a significant data breach could materially affect clientname's performance. the following table breaks down the issues which were identified by component and severity of risk (issues which are reported for information only are not included in the totals): component critical high medium low total phase 1-oracle database assessment 1 3 4 1 9 phase 2-sql server database assessment 0 1 7 2 10 total 1 4 11 3 19 1.2 assessment summary this assessment reviewed instances of both the oracle and sql server databases used by clientname. both database types were affected by issues that could allow an attacker who was able to access the internal network to authenticate to these databases and access the commercially sensitive information held within them. the oracle database was assessed to expose clientname to a greater degree of risk than the sql server database due to the presence of one critical and three high risk issues. the critical risk issue, associated only with the oracle database, was the absence of a substantial number of security updates, some rated as critical or high by the vendor. this resulted in the database being vulnerable to a number of publicly documented security issues that could be exploited by an attacker. another area of concern was associated with the protection of user credentials. this affected both types of database. a number of issues were identified, with the most significant assessed to pose a high risk. these issues could allow an attacker to identify valid credentials and hence authenticate to the database. for example, the oracle database contained a large number of default passwords for some of the standard accounts provided with the database. an attacker using these default credentials would be able to access some of the database functionality. similarly, an issue in the sql server database could allow an attacker to access the encrypted passwords for the database. should they be able to recover the plaintext equivalents for those passwords, they would be able to authenticate to the database. another set of issues was concerned with the security of data in transit. a high risk issue associated with the oracle database was the ability to carry out an attack called 'tns listener poisoning'. this could, for example, allow a suitably positioned attacker to mirror the nightly flow of commercially sensitive data to the oracle database and store a copy on a server under the attacker's control. similarly, it was possible to remotely access the sql server database from other sql servers. an attacker able to compromise a remote sql server database could use it to gain access to the sensitive information held on the sql server database in scope. version 3.0- page 2 of 32 client confidentialfinally, a number of configuration options used default or insecure settings. for example, c2 auditing was not enabled in the sql server database. this logs attempts to access objects in the database and is useful in tracking unexpected activity or potential security violations in the database. the remaining issues were all assessed to pose a low risk. more detailed information on each of the issues which were identified is included in the technical details section of this report. 1.3 strategic recommendations the most significant issue was assessed to pose a critical risk and arose because of the failure to apply security updates to the oracle database in a timely manner. it is therefore recommended that, in addition to addressing the individual issues which are set out in this report, the clientname's patching policy and procedures should also be reviewed to ensure that these issues do not recur once the individual instances documented here have been addressed. the assessment identified the presence of a number of ways an attacker could potentially identify valid user credentials for both the oracle and sql server databases. once in possession of these credentials and attacker would be able to access (and potentially exfiltrate) the commercially sensitive information held in these databases. it is therefore recommended that the organisation-wide password policy should be reviewed. it should also be ensured that this policy is enforced consistently across all the systems within the organisation's information estate. finally, a number of configuration options in both databases did not appear to have been security hardened beyond the default settings or were not configured in the most secure manner. default settings are rarely the most secure and it is therefore recommended that the guidelines published by the vendor for this security hardening of this platform be followed. it is recommended that the issues set out in this report should be addressed by a structured programme of remedial actions which is prioritised by the risk perceived by clientname. this should bring the database configuration into line with security best practice. it is important to recognise that even low risk issues can be exploited in combination with other issues as part of a wider attack which seeks to compromise an environment or application. in addition, resolving lower risk issues can have the dual benefit of reducing the attractiveness of systems to opportunistic attackers as well as enhancing the overall security posture. finally, it is recommended that any configuration changes which are made as a result of this report are also considered for inclusion in the organisation's build standards and secure deployment procedures. this will help to ensure that similar issues do not recur and so maintain the organisation's security posture at an appropriate level. version 3.0- page 3 of 32 client confidential2 table of contents 1 executive summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.1 overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.2 assessment summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.3 strategic recommendations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 2 table of contents. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 3 technical summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.1 scope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.2 caveats . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.3 post assessment cleanup. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.4 risk ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 3.5 findings overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 4 technical details. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 4.1 phase 1 -oracle database assessment. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 4.2 phase 2 -sql server database assessment. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18 5 supplemental data - missing oracle security patches. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 6 supplemental data - excessive users with default profile. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 7 document control. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 7.1 document data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 7.2 document history . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 7.3 document distribution list . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 8 assessment team . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32 version 3.0- page 4 of 32 client confidential3 technical summary ncc group was contracted by clientname to conduct a security assessment of the systems within scope in order to identify security issues that could negatively affect clientname's business or reputation if they led to the compromise or abuse of systems. 3.1 scope the security assessment was carried out in the live environment and included: u assessment of oracle database u assessment of sql server database the ip addresses and hostnames within the scope of this test are listed below: u 192.168.4.3 / oradb u 192.168.3.1 / mssqldb 3.2 caveats the authorisation forms giving permission for ncc group to test the databases were not received until 11 o'clock on the first day of testing, leading to the loss of several hours of testing time. despite this, good coverage was achieved and the delay in obtaining these forms is not thought to have materially affected the quality of the testing. due to the nature of the environment, checks that would have a high probability of causing disruption to the named hosts were excluded. denial of service attempts were excluded for the same reason. 3.3 post assessment cleanup any test accounts which were created for the purpose of this assessment should be disabled or removed, as appro- priate, together with any associated content. revert any waf/ids/ips/firewall changes which were made for the purposes of the assessment. version 3.0- page 5 of 32 client confidential3.4 risk ratings the table below gives a key to the icons and symbols used throughout this report to provide a clear and concise risk scoring system. it should be stressed that quantifying the overall business risk posed by any of the issues found in any test is outside our remit. this means that some risks may be reported as high from a technical perspective but may, as a result of other controls unknown to us, be considered acceptable. symbol risk rating cvssv2 score explanation critical 9.0 - 10 a vulnerability was discovered that has been rated as critical. this requires resolution as quickly as possible. high 7.0 - 8.9 a vulnerability was discovered that has been rated as high. this requires resolution in the short term. medium 4.0 - 6.9 a vulnerability was discovered that has been rated as medium. this should be resolved as part of the ongoing security maintenance of the system. low 1.0 - 3.9 a vulnerability was discovered that has been rated as low. this should be addressed as part of routine maintenance tasks. info 0 - 0.9 a discovery was made that is reported for information. this should be addressed in order to meet leading practice. good n/a good security practices were being followed or an audit item was found to be present and correct. version 3.0- page 6 of 32 client confidential3.5 findings overview all the issues identified during the assessment are listed below with a risk rating for each issue. phase 1-oracle database assessment ref finding risk sr-103-001 missing oracle security patches critical sr-103-002 oracle tns listener poisoning attack high sr-103-003 default passwords high sr-103-004 remote login password file in use high sr-103-005 default profile settings not configured medium sr-103-006 case insensitive password hashes in use medium sr-103-007 users with create procedure privilege medium sr-103-008 database communication over clear text medium sr-103-010 excessive users with default profile low phase 2-sql server database assessment ref finding risk sr-103-011 sql server running as local system high version 3.0- page 7 of 32 client confidentialref finding risk sr-103-012 c2 audit not configured medium sr-103-013 xp_cmdshell enabled medium sr-103-014 default "sa" administrator account configured medium sr-103-015 enforce password expiration not set medium sr-103-016 mixed mode authentication medium sr-103-017 public role permissions on xp_instance_regread and xp_regread stored procedures medium sr-103-018 remote access via rpc medium sr-103-019 login auditing failed logins only low sr-103-020 number of error logs is too low low version 3.0- page 8 of 32 client confidential4 technical details 4.1 phase 1 -oracle database assessment sr-103-001 missing oracle security patches risk rating critical status open description: the oracle database management system was found to be missing multiple security patches, leaving it vulnerable to the possibility that an attacker may gain access, escalate their privileges, or cause a denial of service attack on the database software. oracle release a quarterly critical patch update, known as a cpu. these updates contain a selection of critical patches which affect the system, as well as security updates. the server was found to be missing the following cpus: u january 2021 cpu u october 2020 cpu u july 2020 cpu u april 2020cpu u january 2020 cpu u october 2019 cpu u july 2019 cpu u january 2019 cpu u october 2018 cpu only the most recent missing cpus are listed above. for the complete list of missing patches refer tosupplemental data - missing oracle security patches on page 28. recommendation: it is strongly recommended that the database is patched to a later cpu that will fix the majority of known issues.1 a patching policy should be put in place that assesses any new patches for risk. affects: ip address dns name instance 192.168.4.3 oradb sample 1critical patch updates, security alerts and third party bulletin by oracle https://www.oracle.com/technetwork/topics/security/alerts- 086861.html version 3.0- page 9 of 32 client confidentialsr-103-002 oracle tns listener poisoning attack risk rating high status open description: the oracle tns listener running on the server permitted service registration from remote hosts. an anonymous attacker able to connect to the listener could permit a poisoning attack, which would enable the attacker to manipulate database instances, potentially facilitating man-in-the-middle, session-hijacking, or denial of service attacks against the server. an attacker would be able to register new services and instances. by specifying the name of a legitimate instance, the tns listener can be convinced that the attacker's new instance is actually a failover or cluster participant for the legitimate instance. this can enable the redirection of legitimate client connections to an attacker-controlled machine. recommendation: apply the oracle critical patch update (cpu) from april 2012.2, 3 if this is not possible, apply the class of secure transport (cost) workaround specified in the oracle advisory references listed below. affects: ip address dns name instance 192.168.4.3 oradb sample 2oracle security alert for cve-2012-1675https://www.oracle.com/technetwork/topics/security/alert-cve-2012-1675-1608180.html 3the history of a -probably- 13 years old oracle bug: tns poisonhttps://seclists.org/fulldisclosure/2012/apr/204 version 3.0- page 10 of 32 client confidentialsr-103-003 default passwords risk rating high status open description: several user accounts were found to have default passwords. the affected accounts are listed below: u abm u ad_monitor u ahm u amf u applsyspub u appqossys u css u ctxsys u cue u cun u dbsnmp u dip u dmsys u eaa u evm u fpt u iba u ipd u mddatd u mdsys u me u mgdsys u odm u odm_mtr u okb u oko u okr u olapsys u oracle_ocm u orddata u ordplugins u ordsys u outln u owapub u ozs u rhx u scott u ssosdk u sys u veh u xdb u xnc u xni u xnm u xns some of these accounts are privileged accounts and should have been configured with strong passwords. recommendation: it is recommended to change the passwords for these accounts. default passwords allow attackers access to the database without triggering any alarms since brute-force attacks are not required.4 new strong passwords should be set in line with the company password policy. affects: ip address dns name instance 192.168.4.3 oradb sample 4securing oracle database user accountshttps://docs.oracle.com/cd/e11882_01/server.112/e10575/tdpsg_user_accounts.htm#tdpsg20000 version 3.0- page 11 of 32 client confidentialsr-103-004 remote login password file in use risk rating high status open description: the remote login password file had not been disabled. remote users can authenticate to the database using the internal account, or sysdba and sysoper modes. using this method the users' password hashes are held in the remote login password file. this file is named orapw[sid] on unix platforms. controls on failed login attempts cannot prevent brute-force attacks on hashes in this file, nor is auditing access possible under oracle. it is recommended that this feature is disabled and alternative methods used for remote database connection. setting this parameter to none will enforce os authenticated connections as sysdba. the roles osdba and osoper also exist to allow os authenticated users to connect to the database with system level privileges. the parameter was set to exclusive which means that only one database can use the file, however this setting did not add any security at the database configuration. recommendation: this feature should be disabled by setting remote_login_passwordfile to none in the init.ora file.5 affects: ip address dns name instance 192.168.4.3 oradb sample 5remote login password filehttps://docs.oracle.com/cd/b28359_01/server.111/b28320/initparams198.htm#refrn10184 version 3.0- page 12 of 32 client confidentialsr-103-005 default profile settings not configured risk rating medium status open description: the default profile was found not to be configured and password related parameters were set to default values. the following parameters were not configured: u password_grace_time u password_lock_time u password_verify_function u password_reuse_max u password_reuse_time u password_life_time u failed_login_attempts all values were set to unlimited or null. therefore all user accounts under the default role were vulnerable to password guessing attacks, since there was no timeout or other restrictions in place regarding password use. recommendation: all the parameters mentioned above should be configured according to company password policies and the criticality of the database.6 affects: ip address dns name instance 192.168.4.3 oradb sample 6managing user privilegeshttps://docs.oracle.com/cd/e11882_01/server.112/e10575/tdpsg_privileges.htm#tdpsg30038 version 3.0- page 13 of 32 client confidentialsr-103-006 case insensitive password hashes in use risk rating medium status open description: a number of oracle users had case-insensitive password hashes. these older style password hashes are easily crack- able, making them insecure. the highlighted password below is an example of a user with case-insensitive password: sql> select name, password, spare4 from sys.user$; name password spare4 sys cxxxxxxxxxxxxxx9 s:axxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3 note that thesec_case_sensitive_logon parameter had been set to true meaning that all new users will not have a case-insensitive password. only existing users will continue to have this older style hash until the hash is removed. recommendation: remove the weak hash manually for each account where this is set using the following command:7 update sys.user$ set password = '' where name = [user] additionally, it is recommended that the users' passwords be changed. if they are not changed and the weaker hashes are cracked then this would reveal the users' password regardless of whether they were using the new hash. affects: ip address dns name instance 192.168.4.3 oradb sample 7oracle password hasheshttps://marcel.vandewaters.nl/oracle/security/password-hashes version 3.0- page 14 of 32 client confidentialsr-103-007 users with create procedure privilege risk rating medium status open description: a number of user roles had been assigned the create procedure system privilege. having the ability to create procedures or functions allows attackers to produce scripts to take advantage of any pl/sql vulnerabilities that may exist in the database server. the ability to create procedure or functions allows an attacker to write and execute a recursive loop that will deny service. it is suggested that this privilege be dropped from the resource role and another role should be created and assigned the create procedure privilege. apex_030200 audit_partition_maint asset_schema audit_maintenance resource recommendation: assign this role only to those users that must, as a strict business requirement, be able to create procedures or functions. affects: ip address dns name instance 192.168.4.3 oradb sample version 3.0- page 15 of 32 client confidentialsr-103-008 database communication over clear text risk rating medium status open description: a number of listener connections were identified to allow clear text communication. if an attacker has access to the network and is able to sniff the network traffic then the confidentiality and integrity of this transmission could be affected. the following listeners were identified in the tnsnames.ora file as allowing clear text communication: sample service_name=sample.sample.co.uk within each of these listeners the following had been set: protocol = tcp having the protocol set to tcp states that encryption should not be utilised. recommendation: the tcps protocol should be specified for each listener within the tnsnames.ora configuration file. an example of how the listener should be configured is shown below: protocol = tcps affects: ip address dns name instance 192.168.4.3 oradb sample version 3.0- page 16 of 32 client confidentialsr-103-010 excessive users with default profile risk rating low status open description: during the assessment 258 users were found to be using the default profile. the oracle default profile is very permissive in terms of password requirements and access control. the large number of users with this profile are therefore exposed to heightened risk of account compromise. for the complete users list refer tosupplemental data - excessive users with default profile on page 29. recommendation: it is recommended to create different profiles according to the different tasks each user is performing on the database.8 affects: ip address dns name instance 192.168.4.3 oradb sample 8managing user privilegeshttps://docs.oracle.com/cd/e11882_01/server.112/e10575/tdpsg_privileges.htm#tdpsg30038 version 3.0- page 17 of 32 client confidential4.2 phase 2 -sql server database assessment sr-103-011 sql server running as local system risk rating high status open description: the sql server service was running in the context of the local system account on the host. this means that should any vulnerability be discovered in the database, allowing an attacker to access xp_cmdshell, then they would be able to run commands as local system and would have gained full access to the underlying host. the local system account has permission to access the sam database in the windows registry. the sam database contains the password hashes of all users of the system, and tools exist that can recover the plaintext passwords from these hashes. recommendation: the database should be installed as a lower privileged domain user, rather than as local system.9 affects: ip address dns name instance 192.168.3.1 mssqldb sample 9localsystem accounthttps://msdn.microsoft.com/en-us/library/windows/desktop/ms684190(v=vs.85).aspx version 3.0- page 18 of 32 client confidentialsr-103-012 c2 audit not configured risk rating medium status open description: c2 audit was not configured (via sp_configure). c2 audit mode allows auditing of attempts, both successful and unsuccessful, to access objects. it also ensures that the server will automatically shut down if it is unable to log an event (although this may not be desirable in every organisation). recommendation: consider configuring c2 audit mode, using the following commands:10 exec sp_configure 'show advanced options', '1'; reconfigure with override exec sp_configure 'c2 audit mode', '1'; reconfigure with override exec sp_configure 'show advanced options', '0'; reconfigure with override affects: ip address dns name instance 192.168.3.1 mssqldb sample 10what is c2 audit tracing in sql serverhttps://appliedsql.net/2013/11/28/what-is-c2-audit-tracing-in-sql-server/ version 3.0- page 19 of 32 client confidentialsr-103-013 xp_cmdshell enabled risk rating medium status open description: the execution of the extended stored procedurexp_cmdshell was enabled on the system (this is disabled by default). this allows users who are granted execute permission on this stored procedure to directly run operating system commands. this should always be disabled unless required for backwards compatibility. the following screenshot shows the result of the query select name,value_in_use from sys.configurations where name = 'xp_cmdshell' and value_in_use = 1, indicating that xp_cmdshell was enabled. recommendation: the xp_cmdshell stored procedure should be disabled, and ideally removed from the database.11 affects: ip address dns name instance 192.168.3.1 mssqldb sample 11xp_cmdshell https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql version 3.0- page 20 of 32 client confidentialsr-103-014 default "sa" administrator account configured risk rating medium status open description: the sql server administrator account had not been renamed from the default of 'sa'. it is more difficult to script attacks against the administrator account if the username is not known. this account should be renamed to a value other than the default. recommendation: the code below will disable and rename the sa account:12 alter login sa disable; alter login sa with name = admin_user; affects: ip address dns name instance 192.168.3.1 mssqldb sample 12microsoft sql server - choose an authentication modehttps://msdn.microsoft.com/en-us/library/ms144284.aspx version 3.0- page 21 of 32 client confidentialsr-103-015 enforce password expiration not set risk rating medium status open description: a number of accounts were found to lack the 'enforce password expiration' flag, allowing the use of the same password for extended periods, which may lead to the accounts being compromised. instance: sample name expiration checked user1 no admin1 no sa no recommendation: it is recommended to enforce the use of password expiry on all accounts, to ensure that passwords are changed on a regular basis. this can be achieved in sql server management studio by selecting an account's properties and checking the box 'enforce password expiration'. affects: ip address dns name instance 192.168.3.1 mssqldb sample version 3.0- page 22 of 32 client confidentialsr-103-016 mixed mode authentication risk rating medium status open description: sql server was configured to run in mixed mode, which allowed clients to authenticate using either integrated win- dows or native sql server methods. using native authentication means that passwords are passed across the network in a form that can easily be decrypted. recommendation: the server should be configured to use windows authentication only.13 affects: ip address dns name instance 192.168.3.1 mssqldb sample 13microsoft - change server authentication modehttps://technet.microsoft.com/en-us/library/ms188670.aspx version 3.0- page 23 of 32 client confidentialsr-103-017 public role permissions on xp_instance_regread and xp_regread stored procedures risk rating medium status open description: the public role was found to have permission to execute the xp_instance_regread and xp_regread stored procedures. this could lead to compromise of passwords, hashes, or other sensitive information stored in the registry. recommendation: it is recommended to revoke this privilege from the public role. the following sql statements can be used to fix this issue: use master revoke execute on xp_instance_regread to public use master revoke execute on xp_regread to public affects: ip address dns name instance 192.168.3.1 mssqldb sample version 3.0- page 24 of 32 client confidentialsr-103-018 remote access via rpc risk rating medium status open description: it was possible for other sql servers to connect to this server over rpc. by default, remote access should not be allowed. ensure that this is a valid setting for the database and revoke if necessary using sp_configure. recommendation: sp_configure may be used to display or change server-level settings such as this. the following sql can be used to address this issue: exec sp_configure 'remote access', '0'; reconfigure with override affects: ip address dns name instance 192.168.3.1 mssqldb sample version 3.0- page 25 of 32 client confidentialsr-103-019 login auditing failed logins only risk rating low status open description: the login audit settings were only found to log failed logins. without tracking successful logins it is difficult to track access to the system in the event of a security breach, making forensic analysis harder. the audit settings were configured as follows: figure 1: login auditing configuration recommendation: it is recommended to configure auditing to log 'both failed and successful logins'. affects: ip address dns name instance 192.168.3.1 mssqldb sample version 3.0- page 26 of 32 client confidentialsr-103-020 number of error logs is too low risk rating low status open description: the number of sql server error logs that could be created was too low. when this number is reached, old logs will be overwritten. the value at the time of the assessment was six, the default setting. recommendation: it is recommended that the value be increased to 100 by setting the registry keyhklm\software\microsoft\mssql server\mssqlserver value numerrorlogs to 100. affects: ip address dns name instance 192.168.3.1 mssqldb sample version 3.0- page 27 of 32 client confidential5 supplemental data - missing oracle security patches u missing oracle security patches cpu description redacted redacted version 3.0- page 28 of 32 client confidential6 supplemental data - excessive users with default pro- file complete list of users with default profile: username redacted version 3.0- page 29 of 32 client confidentialusername version 3.0- page 30 of 32 client confidential7 document control client confidentiality this document contains client confidential information and may not be copied without written permission. proprietary information the content of this document should be considered proprietary information and should not be disclosed outside of client company ltd (clientname). ncc group gives permission to copy this report for the purposes of disseminating information within your organisation or any regulatory agency. 7.1 document data data classification client confidential client name clientname project reference 99999 proposal reference p99999-sample document title database review security assessment sample report author ncc consultant 7.2 document history issue no. issue date issued by change description 0.1 2018-01-15 ncc consultant draft for ncc group internal review only 0.2 2018-01-16 a reviewer revised qa 1.0 2018-01-16 ncc consultant released to client 2.0 2018-02-14 ncc consultant cover page address updated 3.0 2021-03-19 ncc consultant minor content and format changes 7.3 document distribution list name role a sponsor project sponsor, clientname ncc consultant senior security consultant, ncc group a manager account manager, ncc group version 3.0- page 31 of 32 client confidential8 assessment team the following members of staff were assigned to this assessment: name job title comments ncc consultant senior security consultant, ncc group crest registered tester (crt) version 3.0- page 32 of 32 client confidential