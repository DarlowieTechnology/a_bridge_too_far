{
"finding_dict": {
"NCCGRPPHP-001" : {
  "identifier": "NCCGRPPHP-001",
  "title": "Outdated or Unsupported Third Party Software",
  "risk": "High",
  "status": "Open",
  "description": "A number of third party software packages in the source code repositories were outdated or unsupported and some were affected by publicly reported security vulnerabilities. This indicates there may be a gap within the security patching process. A full breakdown of the outdated third-party software at the time of the assessment has been provided in Affected Resources section.",
  "recommendation": "Investigate the software patching and update policy and ensure that updates are applied to all software installations, including third party applications, on a regular basis. Consideration should be given to enabling the auto-update functionality within the affected third party software, to ensure that updates are applied quickly and regularly.",
  "affects": "Third-party Software Version Supported Version URL\\nNodeJS (docker image circleci/node) 10.8 12 https://nodejs.org/en/about/releases/\\nPython (docker image circleci/python) 2.7 3.9 https://www.python.org/downloads/\\n... (rest of the list)"
},
"NCCGRPPHP-014" : {
  "identifier": "NCCGRPPHP-014",
  "title": "Lack of Certificate Validation",
  "risk": "High",
  "status": "Open",
  "description": null,
  "recommendation": null,
  "affects": null
},
"NCCGRPPHP-018" : {
  "identifier": "NCCGRPPHP-018",
  "title": "Poor Software Development Lifecycle",
  "risk": "High",
  "status": "Open",
  "description": "The code base showed insufficient adherence to a software development lifecycle (SDL). Robust SDL implementation allows development of software of consistent quality, this was not evident from the code base. Following issues in the code indicated insufficient SDL practices: u High volume of Static Analysis issues. During the course of the assessment the code was processed by three PHP static analyzers (Sonar QUBE, PHPStan, Psalm). All three tools generated thousands of issues. This indicated the Static Analysis was not a part of SDL process. u High number of technical debt issues recorded asTODO in the code (finding NCCGRPPHP-004 on page 13). The usage ofTODO does not match best SDL practices. u Uneven code quality. A number of files contained trivial errors (finding NCCGRPPHP-013 on page 18), (finding NCCGRPPHP-014 on the preceding page), (finding NCCGRPPHP-009 on page 25), (finding NCCGRPPHP-003 on page 12). This indicated insufficient code review practices and absence of coding standards. u Large number of hard-coded credentials, static keys and third-party URLs (finding NCCGRPPHP-002 on the next page), (finding NCCGRPPHP-006 on page 14), (finding NCCGRPPHP-011 on page 27). Hard-coded secrets do not match best SDL practices. u Absence of parity between production and test environments. A number of third-party connections were found to be functional only in production environment. This practice reduces test coverage before release and forces testing to be performed in production. u Outdated and unsupported third-party components (finding NCCGRPPHP-001 on page 6).",
  "recommendation": "The goal of the SDL is to minimize security-related vulnerabilities in the design, code, and documentation, and to detect and eliminate vulnerabilities as early as possible in the development lifecycle. These improvements reduce the number and severity of security vulnerabilities and improve the protection of users privacy. It is recommended to implement the following: u Integrate Static Analysis and Software Composition Analysis tools in the CI pipeline. u Migrate TODO technical issues to a issue database and perform triage of technical debt. u Enforce code review on all code by senior members of the development team. u Migrate secrets to the secure secret storage (this has been planned as indicated by the development team) u Migrate configuration system to common template to enforce parity between the environments. Use mock third-party services to emulate their behavior in the test environment. Use a copy of the database with anonymized data in the test environment. u Enforce periodic updates of third-party components including PHP and MySQL. It is important to note that the list of proposed changes is ambitious and the implementation may take a significant period of time. However, the improvement in SDL will directly affect the quality and security of the application as well as increase the productivity of developers.",
  "affects": "Project in scope"
},
"NCCGRPPHP-002" : {
  "identifier": "NCCGRPPHP-002",
  "title": "Hard-Coded Trivial Credentials",
  "risk": "Medium",
  "status": "Open",
  "description": "The codebase contained hard-coded credentials. This does not conform to security best practice, and is not indicative of a secure platform. In addition, the credentials were easily guessable.  While applications may need to access credentials without user interaction, storing them in the code makes it difficult to change them - should the credentials be discovered, an attacker could gain access to the program.  Discovery of the credentials would also be easy; strings hard-coded into a binary are trivially extractable, using a variety of common tools, and so anyone with access to the binary file would be able to discover them with little effort.  Further, if multiple installations of the product share the same credentials, then an attacker with access to one installation could gain access to other instances. This can also lead in some circumstances to the possibility of the program being used as a vector to propagate worms.  A full list of the instances of credentials in code has been provided in Affected Resources section.",
  "recommendation": "Credentials should not be hard-coded into the application. Rather, they should be stored separately, ideally in a password vault, or in an encrypted file to which only one user has access.3, 4, 5 Alternatively, credentials could be injected in the process environment. An example is shown below:  Line 184 define('MQ_PASSWORD', getenv('MYSQL_ROOT_PASSWORD'));  Line 185 define('MQ_ENQUEUE_PASSWORD', getenv('MYSQL_ROOT_PASSWORD'));",
  "affects": "File Line /client-api-master/.circleci/config.yml 16 3Hardcoded Credentials Example:http://nakedsecurity.sophos.com/2014/04/03/is-amazon-hacking-our-apps-or-doing-us-all-a-security-favour/ 4SANS Top 25 Software Flaws: Number 11, Hardcoded Credentials:http://software-security.sans.org/blog/2010/03/10/top-25-series-rank-11-hard"
},
"NCCGRPPHP-003" : {
  "identifier": "Validation error",
  "title": "Invalid response format",
  "risk": "High",
  "status": "Critical",
  "description": "Plain text responses are not permitted, please include your response in a tool call",
  "recommendation": "Fix the errors and try again",
  "affects": "[Error details]"
},
"NCCGRPPHP-004" : {
  "identifier": "NCCGRPPHP-004",
  "title": "TODO Comments Indicate Incomplete Code",
  "risk": "Medium",
  "status": "Open",
  "description": "Source code contained a large number of comments marked TODO. This indicates incomplete code and could result in incorrect or insecure behaviour of the application.",
  "recommendation": "Review TODO comments in the code. Create issues to track the code defects associated with TODO comments. Remove TODO comments for issues fixed or no longer applicable.",
  "affects": "File Line /client-api-master/app/app_api_view.php 32"
},
"NCCGRPPHP-006" : {
  "identifier": "NCCGRPPHP-006",
  "title": "Hard-coded Static Secrets",
  "risk": "Medium",
  "status": "Open",
  "description": "The code base contained hard-coded static secrets. Static secrets by design do not change over time and are valid until explicitly invalidated. As such static secrets represent continuous risk to the enterprise. Incorporating static secrets in the source code elevates the risk to the enterprise.\\nStatic secrets may include: u Cloud access keys u JWTs with secrets and no set expiration date u Private part of key pairs u Service access keys and IDs that do not require second factor authentication u Strong passwords Static secrets are different from trivial hard-coded passwords described in finding NCCGRPPHP-002 on page 11. Static secrets are designed to be resistant to brute-force attacks. An attack on static secret require gaining access to secret storage. Unlike the dedicated secret storage the source code is not meant for storage of secrets. As a result, the risk to enterprise increases.\\nBelow are examples of static secrets found in the code. u Configuration file contained cloud access keys (AWS). The cloud access keys were valid at the time of writing. The cloud access keys were used withEnumerate IAM tool10 to brute-force account privileges in AWS. The tool contained functionality to generate requests for the current version of AWS SDK. This allowed discovery of the account privileges. Lines 7-9 contain hard-coded static secrets: \\nLine 8 define('AWS_ACCESS_KEY', 'AKIA************NUU7E'); Line 9 define('AWS_SECRET_KEY', '6ZD*******************j'); $ aws sts get-caller-identity {\\\"UserId\\\": \"AID***************\",\\\"Account\\\": \"30************\",\\\"Arn\\\": \\\"arn:aws:iam::30*************:user/************\\\"} The list of static secrets found in the code is placed in theAffected Resources section. ",
  "recommendation": "Secrets should not be hard-coded into the application. Rather, they should be stored separately, ideally in a password vault, or in an encrypted file to which only one user has access.11, 12, 13 Alternatively, secrets could be injected in the process environment. An example is shown below:10Enumerate IAM: https://github.com/andresriancho/enumerate-iam\\n11Hardcoded Credentials Example:http://nakedsecurity.sophos.com/2014/04/03/is-amazon-hacking-our-apps-or-doing-us-all-a-security-favour/\\\\n12SANS Top 25 Software Flaws: Number 11, Hardcoded Credentials:http://software-security.sans.org/blog/2010/03/10/top-25-series-rank-11-hard\\ncoded-credentials/\\\\n13CWE-798: Use of Hard-Coded Credentials:http://cwe.mitre.org/data/definitions/798.html Version 1.0- Page 14 of 33 Client Confidential Line 184 define('MQ_PASSWORD', getenv('MYSQL_ROOT_PASSWORD')); Line 185 define('MQ_EN QUEUE_PASSWORD', getenv('MYSQL_ROOT_PASSWORD'));\\\\nAffects: ",
  "affects": "File Line Notes\\\\n/client-api-master/app/config/credentials/jp_ci.php 8-9 AWS access key Version 1.0- Page 15 of 33 Client Confidential"
},
"NCCGRPPHP-012" : {
  "identifier": "NCCGRPPHP-012",
  "title": "Incorrect Creation of Static Object",
  "risk": "Medium",
  "status": "Open",
  "description": "A PHP function declared a static object with the intention to create one instance and return it to all callers. The function was implemented incorrectly and returned a new instance of the object to every call.",
  "recommendation": "Review list of incorrectly implemented static object. Consider if static objects are required in each case. If static objects are required, correct the code.",
  "affects": "[{\"File\": \"client-api-master/src/Command/RebuildProductItemsIndexCommand.php\", \"Function\": \"getUpdateService()\", \"Lines\": \"143-151\"}, {\"File\": \"client-api-master/src/Command/RebuildProductItemsIndexCommand.php\", \"Function\": \"getDeleteService()\", \"Lines\": \"165-174\"}]"
},
"NCCGRPPHP-013" : {
  "identifier": "NCCGRPPHP-013 All Exceptions Caught Without Processing",
  "title": "All Exceptions Caught Without Processing",
  "risk": "Medium",
  "status": "Open",
  "description": "In a number of places all exceptions were caught without re-throw. As a result, system exceptions were also caught and masked.  PHP classException is a base class of all exceptions in PHP.14 The hierarchy of exceptions derived fromException includes such exceptions as PharException and OverflowException that are thrown by the PHP run-time. These exceptions are not meant to be processed by the application as the application has no means of fixing the underlying problem.15\\n\\nThe coding pattern when all exceptions are caught without reprocessing is called swallowing exceptions or eating errors. The following code shows the pattern:\\nLine 410 try {...<do many things>...Line 428 } catch (Exception $e) { Line 429 Log::warn(array('\\message' => 'sendEvent failed (MessageEvent::EVENT_ID_MAIL_SEND)', ));Line 432 }List of eating errors pattern implementations is placed inAffected Resources section.",
  "recommendation": "As a general rule, the application should not catch exceptions it cannot process. This rule is applicable to a large set of languages that implement exception hierarchy (C++, Java, C#, PHP, Python, etc.). It is recommended to review the instances of eating errors pattern in the code and implement specific catch clauses for application exceptions.",
  "affects": "[\"File Lines/client-api-master/app/models/bulk_distribution_service.php 400-405\", \"File Lines/client-api-master/app/models/bulk_distribution_service.php 410-432\", \"File Lines/client-api-master/app/models/bulk_distribution_service.php 437-458\", \"File Lines/client-api-master/app/models/config.php 141-145\"]"
},
"NCCGRPPHP-016" : {
  "identifier": "NCCGRPPHP-016",
  "title": "Use of MD5 and SHA1",
  "risk": "Medium",
  "status": "Open",
  "description": "The application made use of the MD5 ans SHA1 algorithms. These algorithms are now considered to be cryptographically weak, in that it is vulnerable to collision attacks. This means that it is possible for an attacker to create two messages that have the same computed hash value. Additionally MD5 is known to have a number of weaknesses, and is not allowed by the Microsoft SDL cryptographic standards.16 A full list of MD5 and SHA1 usage found in the code is included in theAffected Resources section.",
  "recommendation": "MD5 and SHA1 should be replaced with stronger algorithms, such as one of the SHA-2 family. Affects: File Lines Notes /client-api-master/app/models/raw_iv_cert.php 32 SHA1 16Analysis of MD5 Weaknesses: http://msdn.microsoft.com/en-us/magazine/ee321570.aspx",
  "affects": "File Lines Notes\\n/client-api-master/app/models/raw_iv_cert.php 32 SHA1\\n16Analysis of MD5 Weaknesses: https://www.msdn.com/library/en-us/dnb Integrator/html/b84c94ec-98ce-4218-a7f1-d4b89e0a8f2a.asp"
},
"NCCGRPPHP-017" : {
  "identifier": "NCCGRPPHP-017",
  "title": "Inconsistent SQL Injection Prevention",
  "risk": "Medium",
  "status": "Open",
  "description": "Best practice recommendations for prevention of SQL injection were not followed in the PHP code base. As a result, the application has potential SQL injection vulnerabilities. The application used PHP Data Objects (PDO) and MySQL PDO driver to access the database. Following vulnerabilities related to SQL injection were found: u An attribute PDO::ATTR_EMULATE_PREPARES was not set in the PDO. As a result, there was a possibility of prepared statements being emulated. Emulation of prepared statements does not offer protection against SQL injection.17 u The application used PDO::quote() for processing of untrusted data. PDO::quote is not recommended for defense against SQL injection.18 List of places where PDO::quote() was found is placed inAffected Resources section.",
  "recommendation": "Prepared statements or equivalent APIs that always correctly escape input to protect against SQL injection should be used.19",
  "affects": "File Lines Notes /client-api-master/app/models/admin_bulk_contact_sent_push_likes_service.php 20-26 PDO::quote() used"
},
"NCCGRPPHP-005" : {
  "identifier": "NCCGRPPHP-005",
  "title": "Nested Statements without Curly Braces",
  "risk": "Low",
  "status": "Open",
  "description": "A number of nested statements did not have curly braces. The omission of curly braces can be misleading, and may lead to the introduction of errors during maintenance.\\nAn example of affected code is shown below:\\nLine 32 foreach(Param::params() as $key => $value){\\nLine 33 if(!is_array($value))\\nLine 34 $_REQUEST[$key] = convert_en_to_em($value);\\nLine 35 }\\nA full list of locations where nested statements were found without curly braces is placed in theAffected Resources section.\\n",
  "recommendation": "Add curly braces around nested statements. More information on code correctness rules related to this issue can be found in the references.20\\n20EXP52-J. Use braces for the body of an if, for, or while statement: https://wiki.sei.cmu.edu/confluence/display/java/EXP52-J.+Use+braces+for+the+bod yof+an+if%2C+for%2C+or+while+statement",
  "affects": "File Lines\\n/client-api-master/app/app_controller.php 33-34"
},
"NCCGRPPHP-007" : {
  "identifier": "NCCGRPPHP-007",
  "title": "PHP API Calls without Side Effects",
  "risk": "Low",
  "status": "Open",
  "description": "A number of PHP functions contained PHP API calls without side effects. Such statements do not produce results and are effectively meaningless.",
  "recommendation": "A variable should be assigned the result of PHP API call. PHP API calls that do not have assignment (no side effects) should be reviewed and removed.",
  "affects": "File Line client-api-master/app/commands/standalone_command.php 68"
},
"NCCGRPPHP-008" : {
  "identifier": "NCCGRPPHP-008",
  "title": "Unreachable Code",
  "risk": "Low",
  "status": "Open",
  "description": "A number of PHP functions contained unreachable code. Such code would never execute in the program. However,\\nthe presence of the code itself may introduce logical errors as developers incorrectly rely of the functionality provided\\nbysuch code.",
  "recommendation": "Review all instances of unreachable code. Correct the flow to reach the code if the functionality is require. Remove the\\nunreachable code if functionality is not required.",
  "affects": "File Lines\\n/client-api-master/app/config/database_sql_hook.php 257-268\\n\\nVersion 1.0- \\u00b7 Page 24 of 33 Client Confidential"
},
"NCCGRPPHP-009" : {
  "identifier": "NCCGRPPHP-009 Variable Assigned to Itself",
  "title": "Variable Assigned to Itself",
  "risk": "Low",
  "status": "Open",
  "description": "A number of PHP functions contained variables assigned to themselves. There is not reason to re-assign a variable to itself.",
  "recommendation": "Review the instances of variables assigned to themselves and correct the code. u If the assignment was intended for some other variable fix the code. u If the assignment is a placeholder, no operation, refactor the code to avoid assignment altogether.",
  "affects": "[\"File Line: client-api-master/app/config/router.php 37\", \"Version: 1.0\", \"Page: 25 of 33 Client Confidential\"]"
},
"NCCGRPPHP-010" : {
  "identifier": "NCCGRPPHP-010 Parameter Assigned Before Use",
  "title": "Parameter Assigned Before Use",
  "risk": "Low",
  "status": "Open",
  "description": "A function parameter was assigned in the body of the function before use. This indicates potentially incorrect function logic.",
  "recommendation": "Do not reuse parameter names in the body of the function. Treat all parameters as read-only values.",
  "affects": null
},
"NCCGRPPHP-011" : {
  "identifier": "NCCGRPPHP-011",
  "title": "Hard-coded URLs and Cloud Bucket Names",
  "risk": "Low",
  "status": "Open",
  "description": "",
  "recommendation": "Please include the response in a tool call to fix the plain text error.",
  "affects": ""
},
"NCCGRPPHP-015" : {
  "identifier": "NCCGRPPHP-015",
  "title": "HTTP Basic Authentication in Use",
  "risk": "Low",
  "status": "Open",
  "description": "The application was accessible from the Internet and made use of HTTP basic authentication. In HTTP basic authentication, HTTP requests are sent by the client with the Authorization header, containing the username and password\\nin a base64-encoded string. This is not a significant security concern by itself and this issue has been included in the\\nreport for informational and completeness purposes. The following code used HTTP basic authentication for a cURL connection:\\r\\nLine 103 curl_setopt($curl, CURLOPT_USERPWD, sprintf(\"%s:%s\", $api[\"BASICAUTH_USER\"],\\n$api[\"BASICAUTH_PASSWORD\"]);\\nThe username and password in HTTP basic authentication can be trivially decoded by an attacker who is able to\\nintercept network traffic. For this reason, a secure encrypted transport mechanism should be used in conjunction\\nwith HTTP basic authentication. As the application did not enforce validation of TLS certificate (details in the issuefinding NCCGRPPHP-014 on page 9), a suitably positioned attacker able to intercept network traffic, would be able to derive\\nthe username and password.",
  "recommendation": "Ensure that all traffic between the users browser and the web server should be enforced over an encrypted channel.\\nThis can be achieved by using HTTPS, which uses SSL/TLS to protect the data. Do not disable TLS certificate validation\\nas it effectively removes the protection of an encrypted channel.",
  "affects": null
}}
}
