{
  "SR-103-001": "SR-103-001 Missing Oracle Security Patches\nRisk Rating Critical Status Open\nDescription:\nThe Oracle database management system was found to be missing multiple security patches, leaving it vulnerable to\nthe possibility that an attacker may gain access, escalate their privileges, or cause a denial of service attack on the\ndatabase software.\nOracle release a quarterly critical patch update, known as a CPU. These updates contain a selection of critical patches\nwhich affect the system, as well as security updates. The server was found to be missing the following CPUs:\nu January 2021 CPU\nu October 2020 CPU\nu July 2020 CPU\nu April 2020CPU\nu January 2020 CPU\nu October 2019 CPU\nu July 2019 CPU\nu January 2019 CPU\nu October 2018 CPU\nOnly the most recent missing CPUs are listed above. For the complete list of missing patches refer toSupplemental\nData - Missing Oracle Security Patches on page 28.\nRecommendation:\nIt is strongly recommended that the database is patched to a later CPU that will fix the majority of known issues.1\nA patching policy should be put in place that assesses any new patches for risk.\nAffects:\nIP Address DNS Name Instance\n192.168.4.3 ORADB SAMPLE\n1Critical Patch Updates, Security Alerts and Third Party Bulletin by Oracle https://www.oracle.com/technetwork/topics/security/alerts-\n086861.html\nVersion 3.0- Page 9 of 32 Client Confidential\n",
  "SR-103-002": "SR-103-002 Oracle TNS Listener Poisoning Attack\nRisk Rating High Status Open\nDescription:\nThe Oracle TNS listener running on the server permitted service registration from remote hosts. An anonymous\nattacker able to connect to the listener could permit a poisoning attack, which would enable the attacker to manipulate\ndatabase instances, potentially facilitating man-in-the-middle, session-hijacking, or denial of service attacks against the\nserver.\nAn attacker would be able to register new services and instances. By specifying the name of a legitimate instance,\nthe TNS listener can be convinced that the attacker\u2019s new instance is actually a failover or cluster participant for the\nlegitimate instance. This can enable the redirection of legitimate client connections to an attacker-controlled machine.\nRecommendation:\nApply the Oracle Critical Patch Update (CPU) from April 2012.2, 3\nIf this is not possible, apply the Class of Secure Transport (COST) workaround specified in the Oracle advisory references\nlisted below.\nAffects:\nIP Address DNS Name Instance\n192.168.4.3 ORADB SAMPLE\n2Oracle Security Alert for CVE-2012-1675https://www.oracle.com/technetwork/topics/security/alert-cve-2012-1675-1608180.html\n3The history of a -probably- 13 years old Oracle bug: TNS Poisonhttps://seclists.org/fulldisclosure/2012/Apr/204\nVersion 3.0- Page 10 of 32 Client Confidential\n",
  "SR-103-003": "SR-103-003 Default Passwords\nRisk Rating High Status Open\nDescription:\nSeveral user accounts were found to have default passwords.\nThe affected accounts are listed below:\nu ABM\nu AD_MONITOR\nu AHM\nu AMF\nu APPLSYSPUB\nu APPQOSSYS\nu CSS\nu CTXSYS\nu CUE\nu CUN\nu DBSNMP\nu DIP\nu DMSYS\nu EAA\nu EVM\nu FPT\nu IBA\nu IPD\nu MDDATD\nu MDSYS\nu ME\nu MGDSYS\nu ODM\nu ODM_MTR\nu OKB\nu OKO\nu OKR\nu OLAPSYS\nu ORACLE_OCM\nu ORDDATA\nu ORDPLUGINS\nu ORDSYS\nu OUTLN\nu OWAPUB\nu OZS\nu RHX\nu SCOTT\nu SSOSDK\nu SYS\nu VEH\nu XDB\nu XNC\nu XNI\nu XNM\nu XNS\nSome of these accounts are privileged accounts and should have been configured with strong passwords.\nRecommendation:\nIt is recommended to change the passwords for these accounts. Default passwords allow attackers access to the\ndatabase without triggering any alarms since brute-force attacks are not required.4\nNew strong passwords should be set in line with the company password policy.\nAffects:\nIP Address DNS Name Instance\n192.168.4.3 ORADB SAMPLE\n4Securing Oracle Database User Accountshttps://docs.oracle.com/cd/E11882_01/server.112/e10575/tdpsg_user_accounts.htm#TDPSG20000\nVersion 3.0- Page 11 of 32 Client Confidential\n",
  "SR-103-004": "SR-103-004 Remote Login Password File in Use\nRisk Rating High Status Open\nDescription:\nThe remote login password file had not been disabled.\nRemote users can authenticate to the database using the INTERNAL account, or SYSDBA and SYSOPER modes. Using\nthis method the users\u2019 password hashes are held in the Remote Login Password file. This file is named orapw[SID]\non Unix platforms. Controls on failed login attempts cannot prevent brute-force attacks on hashes in this file, nor\nis auditing access possible under Oracle. It is recommended that this feature is disabled and alternative methods\nused for remote database connection. Setting this parameter to NONE will enforce OS authenticated connections as\nSYSDBA. The roles OSDBA and OSOPER also exist to allow OS authenticated users to connect to the database with\nsystem level privileges.\nThe parameter was set to EXCLUSIVE which means that only one database can use the file, however this setting did\nnot add any security at the database configuration.\nRecommendation:\nThis feature should be disabled by setting remote_login_passwordfile to NONE in the init.ora file.5\nAffects:\nIP Address DNS Name Instance\n192.168.4.3 ORADB SAMPLE\n5Remote login password filehttps://docs.oracle.com/cd/B28359_01/server.111/b28320/initparams198.htm#REFRN10184\nVersion 3.0- Page 12 of 32 Client Confidential\n",
  "SR-103-005": "SR-103-005 Default Profile Settings Not Configured\nRisk Rating Medium Status Open\nDescription:\nThe default profile was found not to be configured and password related parameters were set to default values.\nThe following parameters were not configured:\nu PASSWORD_GRACE_TIME\nu PASSWORD_LOCK_TIME\nu PASSWORD_VERIFY_FUNCTION\nu PASSWORD_REUSE_MAX\nu PASSWORD_REUSE_TIME\nu PASSWORD_LIFE_TIME\nu FAILED_LOGIN_ATTEMPTS\nAll values were set to unlimited or null. Therefore all user accounts under the Default role were vulnerable to password\nguessing attacks, since there was no timeout or other restrictions in place regarding password use.\nRecommendation:\nAll the parameters mentioned above should be configured according to company password policies and the criticality\nof the database.6\nAffects:\nIP Address DNS Name Instance\n192.168.4.3 ORADB SAMPLE\n6Managing User Privilegeshttps://docs.oracle.com/cd/E11882_01/server.112/e10575/tdpsg_privileges.htm#TDPSG30038\nVersion 3.0- Page 13 of 32 Client Confidential\n",
  "SR-103-006": "SR-103-006 Case Insensitive Password Hashes in Use\nRisk Rating Medium Status Open\nDescription:\nA number of Oracle users had case-insensitive password hashes. These older style password hashes are easily crack-\nable, making them insecure.\nThe highlighted password below is an example of a user with case-insensitive password:\nSQL> select name, password, spare4 from sys.user$;\nNAME PASSWORD SPARE4\nSYS CXXXXXXXXXXXXXX9 S:AXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX3\nNote that theSEC_CASE_SENSITIVE_LOGON parameter had been set to true meaning that all new users will not have\na case-insensitive password. Only existing users will continue to have this older style hash until the hash is removed.\nRecommendation:\nRemove the weak hash manually for each account where this is set using the following command:7\nUPDATE SYS.USER$ SET password = '' WHERE name = [USER]\nAdditionally, it is recommended that the users\u2019 passwords be changed. If they are not changed and the weaker hashes\nare cracked then this would reveal the users\u2019 password regardless of whether they were using the new hash.\nAffects:\nIP Address DNS Name Instance\n192.168.4.3 ORADB SAMPLE\n7Oracle Password Hasheshttps://marcel.vandewaters.nl/oracle/security/password-hashes\nVersion 3.0- Page 14 of 32 Client Confidential\n",
  "SR-103-007": "SR-103-007 Users With CREATE PROCEDURE Privilege\nRisk Rating Medium Status Open\nDescription:\nA number of user roles had been assigned the CREATE PROCEDURE system privilege. Having the ability to create\nprocedures or functions allows attackers to produce scripts to take advantage of any PL/SQL vulnerabilities that may\nexist in the database server.\nThe ability to create procedure or functions allows an attacker to write and execute a recursive loop that will deny\nservice. It is suggested that this privilege be dropped from the RESOURCE role and another role should be created\nand assigned the CREATE PROCEDURE privilege.\nAPEX_030200\nAUDIT_PARTITION_MAINT\nASSET_SCHEMA\nAUDIT_MAINTENANCE\nRESOURCE\nRecommendation:\nAssign this role only to those users that must, as a strict business requirement, be able to create procedures or\nfunctions.\nAffects:\nIP Address DNS Name Instance\n192.168.4.3 ORADB SAMPLE\nVersion 3.0- Page 15 of 32 Client Confidential\n",
  "SR-103-008": "SR-103-008 Database Communication Over Clear Text\nRisk Rating Medium Status Open\nDescription:\nA number of listener connections were identified to allow clear text communication. If an attacker has access to the\nnetwork and is able to sniff the network traffic then the confidentiality and integrity of this transmission could be\naffected.\nThe following listeners were identified in the tnsnames.ora file as allowing clear text communication:\nSAMPLE SERVICE_NAME=SAMPLE.SAMPLE.co.uk\nWithin each of these listeners the following had been set:\nPROTOCOL = TCP\nHaving the protocol set to TCP states that encryption should not be utilised.\nRecommendation:\nThe TCPS protocol should be specified for each listener within the tnsnames.ora configuration file.\nAn example of how the listener should be configured is shown below:\nPROTOCOL = TCPS\nAffects:\nIP Address DNS Name Instance\n192.168.4.3 ORADB SAMPLE\nVersion 3.0- Page 16 of 32 Client Confidential\n",
  "SR-103-010": "SR-103-010 Excessive Users With Default Profile\nRisk Rating Low Status Open\nDescription:\nDuring the assessment 258 users were found to be using the default profile.\nThe Oracle default profile is very permissive in terms of password requirements and access control. The large number\nof users with this profile are therefore exposed to heightened risk of account compromise.\nFor the complete users list refer toSupplemental Data - Excessive Users with Default Profile on page 29.\nRecommendation:\nIt is recommended to create different profiles according to the different tasks each user is performing on the database.8\nAffects:\nIP Address DNS Name Instance\n192.168.4.3 ORADB SAMPLE\n8Managing User Privilegeshttps://docs.oracle.com/cd/E11882_01/server.112/e10575/tdpsg_privileges.htm#TDPSG30038\nVersion 3.0- Page 17 of 32 Client Confidential\n4.2 Phase 2 \u2012SQL Server Database Assessment\n",
  "SR-103-011": "SR-103-011 SQL Server Running As Local System\nRisk Rating High Status Open\nDescription:\nThe SQL Server service was running in the context of the Local System account on the host. This means that should\nany vulnerability be discovered in the database, allowing an attacker to access xp_cmdshell, then they would be able to\nrun commands as Local System and would have gained full access to the underlying host. The Local System account\nhas permission to access the SAM database in the Windows registry. The SAM database contains the password hashes\nof all users of the system, and tools exist that can recover the plaintext passwords from these hashes.\nRecommendation:\nThe database should be installed as a lower privileged domain user, rather than as Local System.9\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\n9LocalSystem Accounthttps://msdn.microsoft.com/en-us/library/windows/desktop/ms684190(v=vs.85).aspx\nVersion 3.0- Page 18 of 32 Client Confidential\n",
  "SR-103-012": "SR-103-012 C2 Audit Not Configured\nRisk Rating Medium Status Open\nDescription:\nC2 audit was not configured (via sp_configure). C2 audit mode allows auditing of attempts, both successful and\nunsuccessful, to access objects. It also ensures that the server will automatically shut down if it is unable to log an\nevent (although this may not be desirable in every organisation).\nRecommendation:\nConsider configuring C2 audit mode, using the following commands:10\nexec sp_configure 'show advanced options', '1'; reconfigure with override\nexec sp_configure 'c2 audit mode', '1'; reconfigure with override\nexec sp_configure 'show advanced options', '0'; reconfigure with override\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\n10What is C2 Audit Tracing in SQL Serverhttps://appliedsql.net/2013/11/28/what-is-c2-audit-tracing-in-sql-server/\nVersion 3.0- Page 19 of 32 Client Confidential\n",
  "SR-103-013": "SR-103-013 xp_cmdshell Enabled\nRisk Rating Medium Status Open\nDescription:\nThe execution of the extended stored procedurexp_cmdshell was enabled on the system (this is disabled by default).\nThis allows users who are granted execute permission on this stored procedure to directly run operating system\ncommands. This should always be disabled unless required for backwards compatibility.\nThe following screenshot shows the result of the query select name,value_in_use from sys.configurations where\nname = 'xp_cmdshell' and value_in_use = 1, indicating that xp_cmdshell was enabled.\nRecommendation:\nThe xp_cmdshell stored procedure should be disabled, and ideally removed from the database.11\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\n11xp_cmdshell https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql\nVersion 3.0- Page 20 of 32 Client Confidential\n",
  "SR-103-014": "SR-103-014 Default \u201csa\u201d Administrator Account Configured\nRisk Rating Medium Status Open\nDescription:\nThe SQL Server administrator account had not been renamed from the default of \u2018sa\u2019. It is more difficult to script attacks\nagainst the administrator account if the username is not known. This account should be renamed to a value other\nthan the default.\nRecommendation:\nThe code below will disable and rename the sa account:12\nALTER LOGIN sa DISABLE;\nALTER LOGIN sa WITH NAME = Admin_User;\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\n12Microsoft SQL Server - Choose an Authentication Modehttps://msdn.microsoft.com/en-us/library/ms144284.aspx\nVersion 3.0- Page 21 of 32 Client Confidential\n",
  "SR-103-015": "SR-103-015 Enforce Password Expiration Not Set\nRisk Rating Medium Status Open\nDescription:\nA number of accounts were found to lack the \u2018Enforce Password Expiration\u2019 flag, allowing the use of the same password\nfor extended periods, which may lead to the accounts being compromised.\nInstance: SAMPLE\nName Expiration Checked\nUser1 No\nAdmin1 No\nSa No\nRecommendation:\nIt is recommended to enforce the use of password expiry on all accounts, to ensure that passwords are changed on\na regular basis. This can be achieved in SQL Server Management Studio by selecting an account\u2019s properties and\nchecking the box \u2018Enforce Password Expiration\u2019.\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\nVersion 3.0- Page 22 of 32 Client Confidential\n",
  "SR-103-016": "SR-103-016 Mixed Mode Authentication\nRisk Rating Medium Status Open\nDescription:\nSQL Server was configured to run in mixed mode, which allowed clients to authenticate using either integrated Win-\ndows or native SQL Server methods. Using native authentication means that passwords are passed across the network\nin a form that can easily be decrypted.\nRecommendation:\nThe server should be configured to use Windows authentication only.13\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\n13Microsoft - Change Server Authentication Modehttps://technet.microsoft.com/en-us/library/ms188670.aspx\nVersion 3.0- Page 23 of 32 Client Confidential\nSR-103-017 PUBLIC Role Permissions on xp_instance_regread and\nxp_regread Stored Procedures\nRisk Rating Medium Status Open\nDescription:\nThe PUBLIC role was found to have permission to execute the xp_instance_regread and xp_regread stored procedures.\nThis could lead to compromise of passwords, hashes, or other sensitive information stored in the registry.\nRecommendation:\nIt is recommended to revoke this privilege from the PUBLIC role. The following SQL statements can be used to fix this\nissue:\nuse master revoke execute on xp_instance_regread to public\nuse master revoke execute on xp_regread to public\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\nVersion 3.0- Page 24 of 32 Client Confidential\n",
  "SR-103-018": "SR-103-018 Remote Access via RPC\nRisk Rating Medium Status Open\nDescription:\nIt was possible for other SQL Servers to connect to this server over RPC. By default, remote access should not be\nallowed. Ensure that this is a valid setting for the database and revoke if necessary using sp_configure.\nRecommendation:\nsp_configure may be used to display or change server-level settings such as this. The following SQL can be used to\naddress this issue:\nexec sp_configure 'remote access', '0'; reconfigure with override\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\nVersion 3.0- Page 25 of 32 Client Confidential\n",
  "SR-103-019": "SR-103-019 Login Auditing Failed Logins Only\nRisk Rating Low Status Open\nDescription:\nThe login audit settings were only found to log failed logins. Without tracking successful logins it is difficult to track\naccess to the system in the event of a security breach, making forensic analysis harder.\nThe audit settings were configured as follows:\nFigure 1: Login Auditing Configuration\nRecommendation:\nIt is recommended to configure auditing to log \u2018Both failed and successful logins\u2019.\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\nVersion 3.0- Page 26 of 32 Client Confidential\n",
  "SR-103-020": "SR-103-020 Number of Error Logs is Too Low\nRisk Rating Low Status Open\nDescription:\nThe number of SQL Server error logs that could be created was too low. When this number is reached, old logs will be\noverwritten.\nThe value at the time of the assessment was six, the default setting.\nRecommendation:\nIt is recommended that the value be increased to 100 by setting the registry keyHKLM\\SOFTWARE\\Microsoft\\MSSQL\nServer\\MSSQLServer value NumErrorLogs to 100.\nAffects:\nIP Address DNS Name Instance\n192.168.3.1 MSSQLDB SAMPLE\nVersion 3.0- Page 27 of 32 Client Confidential\n"
}