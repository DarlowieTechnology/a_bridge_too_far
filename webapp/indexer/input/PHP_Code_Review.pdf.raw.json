{
  "nccgrpphp-001": "nccgrpphp-001 outdated or unsupported third party software risk rating high status open description: a number of third party software packages in the source code repositories were outdated or unsupported and some were affected by publicly reported security vulnerabilities. this indicates there may be a gap within the security patching process. a full breakdown of the outdated third-party software at the time of the assessment has been provided in affected resources section. recommendation: investigate the software patching and update policy and ensure that updates are applied to all software installations, including third party applications, on a regular basis. consideration should be given to enabling the auto-update functionality within the affected third party software, to ensure that updates are applied quickly and regularly.1 where software is no longer supported, it may be necessary to initiate a programme of work to investigate the most effective path towards the use of later, or alternative, supported software. affects: third-party software version supported version url nodejs (docker image circleci/node) 10.8 12 https://nodejs.org/en/about/ releases/ python (docker image circleci/python) 2.7 3.9 https://www.python.org/ downloads/ golang (docker image circleci/golang) 1.10 1.16.6 https://github.com/golang/go/ releases php 7.3 7.4.22 https://www.php.net/ index.php#id2021-07-29-2 aws/aws-sdk-php 2.8.31 3.186.3 https://github.com/aws/ aws-sdk-php/releases/tag/3.186.3 beberlei/assert v3.2.1 v3.3.1 https://github.com/beberlei/ assert/releases/tag/v3.3.1 briannesbitt/carbon 1.21.0 2.51.1 https://github.com/briannesbitt/ carbon/releases/tag/2.51.1 composer/installers v1.10.0 v1.11.0 https://github.com/composer/ installers/releases/tag/v1.11.0 dragonmantank/cron-expression v2.2.0 v3.1.0 https://github.com/ dragonmantank/cron-expression/ releases/tag/v3.1.0 doctrine/cache 1.6.2 https://github.com/doctrine/ cache/releases/tag/2.1.1 1checking for outdated third-party packages: https://github.com/friendsofphp/security-advisories#checking-for-vulnerabilities third-party software version supported version url facebook/graph-sdk 5.6.1 https://github.com/ facebookarchive/php-graph-sdk/ releases/tag/5.7.0 firebase/php-jwt 5.0.0 5.4.0 https://github.com/firebase/ php-jwt/releases/tag/v5.4.0 fluent/fluent-logger-php v0.3.8 v1.0.1 https://github.com/fluent/fluent- logger-php/releases/tag/ v1.0.1 fzaninotto/faker 1.7.1 package fzaninotto/faker is abandoned gemorroj/archive7z 2.0.0 https://github.com/gemorroj/ archive7z/releases/tag/5.1.1 protocolbuffers/protobuf-php 3.15.8 v3.17.3 https://github.com/ protocolbuffers/protobuf-php/ releases/tag/v3.17.3 googleapis/common-protos-php 1.3 1.3.1 https://github.com/googleapis/ common-protos-php/releases/ tag/1.3.1 googleapis/ google-auth-library-php v1.7.1 v1.16.0 https://github.com/googleapis/ google-auth-library-php/releases/ tag/v1.16.0 googleapis/google-cloud-php v0.147.0 v0.163.1 https://github.com/googleapis/ google-cloud-php/releases/tag/ v0.163.1 grpc/grpc-php 1.36 1.39.0 https://github.com/grpc/ grpc-php/releases/tag/v1.39.0 guzzle/guzzle 3.7.0 guzzle/guzzle is abandoned guzzlehttp/psr7 1.4.2 2.0.0 https://github.com/guzzle/psr7/ releases/tag/2.0.0 paragonie/constant_time_encodi ng v2.2.3 v2.4.0 https://github.com/paragonie/co nstant_time_encoding/releases/ta g/v2.4.0 php-fig/cache 1.0.1 3.0.0 https://github.com/php-fig/cache/ releases/tag/3.0.0 php-fig/container 1.0.0 1.1.1 https://github.com/php-fig/ container/releases/tag/1.1.1 php-fig/log 1.1.3 1.1.4 https://github.com/php-fig/log/ releases/tag/1.1.4 phpseclib/phpseclib 2.0.31 3.0.9 https://github.com/phpseclib/ phpseclib/releases/tag/3.0.9 ramsey/uuid 3.7.1 4.1.1 https://github.com/ramsey/uuid/ releases/tag/4.1.1 seldaek/monolog 1.26.0 2.3.2 https://github.com/seldaek/ monolog/releases/tag/2.3.2 third-party software version supported version url silexphp/pimple v3.2.2 v3.4.0 https://github.com/silexphp/ pimple/releases/tag/v3.4.0 solariumphp/solarium 3.8.1 6.1.4 https://github.com/solariumphp/ solarium/releases/tag/6.1.4 swiftmailer/swiftmailer v5.4.8 https://github.com/swiftmailer/ swiftmailer/releases/tag/v6.2.7 symfony/cache 4.2.12 v5.3.4 https://github.com/symfony/ cache/releases/tag/v5.3.4 symfony/console 2.5.4 v5.3.6 https://github.com/symfony/ console/releases/tag/v5.3.6 symfony/contracts v1.0.2 v2.3.1 https://github.com/symfony/ contracts/releases/tag/v2.3.1 symfony/event-dispatcher v3.3.8 v5.3.4 https://github.com/symfony/ event-dispatcher/releases/tag/ v5.3.4 symfony/http-foundation v3.4.36 v5.3.6 https://github.com/symfony/http- foundation/releases/tag/ v5.3.6 symfony/process v3.4.1 v5.3.4 https://github.com/symfony/ process/releases/tag/v5.3.4 symfony/translation v4.4.4 v5.3.4 https://github.com/symfony/ translation/releases/tag/v5.3.4 symfony/var-exporter v3.1.13 v5.3.4 https://github.com/symfony/ var-exporter/releases/tag/v5.3.4 thephpleague/csv 9.1.4 9.7.1 https://github.com/ thephpleague/csv/releases/tag/ 9.7.1 twilio/twilio-php 5.37.0 6.27.1 https://github.com/twilio/ twilio-php/releases/tag/6.27.1",
  "nccgrpphp-014": "nccgrpphp-014 lack of certificate validation risk rating high status open description: an attacker can intercept and modify network communication. the application disabled certificate validation when using tls for secure communication. tls ensures traffic is securely encrypted so that an attacker cannot read or modify network data. however, the security of tls relies on a certificate, which uniquely identifies one side of the communication. by verifying the certificate against a local certificate authority, the client guarantees that communication has not been intercepted or modified. because the application does not correctly validate certificates, an attacker can substitute a malicious certificate in order to intercept and modify communication. essentially, the lack of certificate validation defeats the protection offered by tls. the following code disabled certificate validation: line 113 $response_code = curl_exec($curl); line 114 if (curle_ok !== curl_errno($curl)) { line 115 log::warning( 'failed to send sms with ssl option. will resend with no ssl option temporally. error: ' . curl_error($curl)); line 116 line 117 curl_setopt($curl, curlopt_ssl_verifypeer, false); line 118 curl_setopt($curl, curlopt_ssl_verifyhost, false); line 119 $response_code = curl_exec($curl); line 120 } line 121 curl_close($curl); the code attempts to connect to a third-party site and if the error is received, it attempts to connect again without certificate validation. if the third-party site presents an invalid certificate or self-sighed certificate the first attempt at connection fails due to security concerns. however, the code then removes the security checks and connects to the third-party site anyway. recommendation: do not disable certificate validation. validation of x.509 certificates is essential to create secure ssl/tls sessions not vulnerable to man-in-the-middle attacks.2 the certificate chain validation includes these steps: u the certificate is issued by its parent certificate authority or the root ca trusted by the system. u each ca is allowed to issue certificates. u each certificate in the chain is not expired. 2cwe-295: improper certificate validation: https://cwe.mitre.org/data/definitions/295.html",
  "nccgrpphp-018": "nccgrpphp-018 poor software development lifecycle risk rating high status open description: the code base showed insufficient adherence to a software development lifecycle (sdl). robust sdl implementation allows development of software of consistent quality, this was not evident from the code base. following issues in the code indicated insufficient sdl practices: u high volume of static analysis issues. during the course of the assessment the code was processed by three php static analyzers (sonar qube, phpstan, psalm). all three tools generated thousands of issues. this indicated the static analysis was not a part of sdl process. u high number of technical debt issues recorded as todo in the code (finding nccgrpphp-004 on page 13). the usage oftodo does not match best sdl practices. u uneven code quality. a number of files contained trivial errors (finding nccgrpphp-013 on page 18), (finding nccgrpphp- 014 on the preceding page), (finding nccgrpphp-009 on page 25), (finding nccgrpphp-003 on page 12). this indicated insufficient code review practices and absence of coding standards. u large number of hard-coded credentials, static keys and third-party urls (finding nccgrpphp-002 on the next page), (finding nccgrpphp-006 on page 14), (finding nccgrpphp-011 on page 27). hard-coded secrets do not match best sdl practices. u absence of parity between production and test environments. a number of third-party connections were found to be functional only in production environment. this practice reduces test coverage before release and forces testing to be performed in production. u outdated and unsupported third-party components (finding nccgrpphp-001 on page 6). recommendation: the goal of the sdl is to minimize security-related vulnerabilities in the design, code, and documentation, and to detect and eliminate vulnerabilities as early as possible in the development lifecycle. these improvements reduce the number and severity of security vulnerabilities and improve the protection of users' privacy. it is recommended to implement the following: u integrate static analysis and software composition analysis tools in the ci pipeline. u migrate todo technical issues to a issue database and perform triage of technical debt. u enforce code review on all code by senior members of the development team. u migrate secrets to the secure secret storage (this has been planned as indicated by the development team) u migrate configuration system to common template to enforce parity between the environments. use mock third- party services to emulate their behavior in the test environment. use a copy of the database with anonymized data in the test environment. u enforce periodic updates of third-party components including php and mysql. it is important to note that the list of proposed changes is ambitious and the implementation may take a significant period of time. however, the improvement in sdl will directly affect the quality and security of the application as well as increase the productivity of developers. affects: u project in scope",
  "nccgrpphp-002": "nccgrpphp-002 hard-coded trivial credentials risk rating medium status open description: the codebase contained hard-coded credentials. this does not conform to security best practice, and is not indicative of a secure platform. in addition, the credentials were easily guessable. line 14 environment: line 15 db_host: 127.0.0.1 line 16 mysql_root_password: ****** line 17 mysql_database: test line 18 mysql_user: user line 19 mysql_password: ****** while applications may need to access credentials without user interaction, storing them in the code makes it difficult to change them - should the credentials be discovered, an attacker could gain access to the program. discovery of the credentials would also be easy; strings hard-coded into a binary are trivially extractable, using a variety of common tools, and so anyone with access to the binary file would be able to discover them with little effort. further, if multiple installations of the product share the same credentials, then an attacker with access to one installation could gain access to other instances. this can also lead in some circumstances to the possibility of the program being used as a vector to propagate worms. a full list of the instances of credentials in code has been provided in affected resources section. recommendation: credentials should not be hard-coded into the application. rather, they should be stored separately, ideally in a password vault, or in an encrypted file to which only one user has access.3, 4, 5 alternatively, credentials could be injected in the process environment. an example is shown below: line 184 define('mq_password', getenv('mysql_root_password')); line 185 define('mq_enqueue_password', getenv('mysql_root_password')); affects: file line /client-api-master/.circleci/config.yml 16 3hardcoded credentials example:http://nakedsecurity.sophos.com/2014/04/03/is-amazon-hacking-our-apps-or-doing-us-all-a-security-favour/ 4sans top 25 software flaws: number 11, hardcoded credentials:http://software-security.sans.org/blog/2010/03/10/top-25-series-rank-11-har dcoded-credentials/ 5cwe-798: use of hard-coded credentials:http://cwe.mitre.org/data/definitions/798.html",
  "nccgrpphp-003": "nccgrpphp-003 subscope variable overshadows outer scope variable risk rating medium status open description: subscope variables declared with the same name as outer scope variables overshadow outer scope variables. this results in code which is difficult to read and maintain. such code can lead to bugs that are difficult to root cause. an example of an overshadowed variable in the code is shown below: line 7 protected $response = ''; ... line 9 public function render($action = null) line 10 { ... line 21 $response = self::extract($view_filename, $this->vars); php creates a new instance of the variable when it first encounters it in the scope. the code declared variable $resp one was declared in the class scope on line 7 and re-declared in the method render scope on line 21. as a result, assigning to variable$response on line 21 does not modify variable$response declared in line 7.6 a full list of overshadowed variables found in the code is placed in the affected resources section below. recommendation: do not reuse identifier names in subscopes. include the requirements in the process for code review. refer to cmu sei rules for more information7,.8 affects: file line variable overshadowed on line client-api-master/app/app_api_view.php 7 $response 21 6php variable scope:https://www.php.net/manual/en/language.variables.scope.php 7cmu sei dcl01-c do not reuse variable names in subscopes.:https://wiki.sei.cmu.edu/confluence/display/c/dcl01-c.+do+not+reuse+variable+n ames+in+subscopes 8cmu sei dcl51-j do not shadow or obscure identifiers.:https://wiki.sei.cmu.edu/confluence/display/java/dcl51-j.+do+not+shadow+or+obscure+i dentifiers+in+subscopes",
  "nccgrpphp-004": "nccgrpphp-004 todo comments indicate incomplete code risk rating medium status open description: source code contained a large number of comments marked todo. this indicates incomplete code and could result in incorrect or insecure behaviour of the application.9 an example of a todo comment is shown below: line 32 //todo: meta.notification line 33 if($this->controller->isneedforcelogout()===true){ a full list of todo comments found in the code is placed in the affected resources section below. recommendation: review todo comments in the code. create issues to track the code defects associated with todo comments. remove todo comments for issues fixed or no longer applicable. affects: file line /client-api-master/app/app_api_view.php 32 9cwe-546: suspicious comment: http://cwe.mitre.org/data/definitions/546.html",
  "nccgrpphp-006": "nccgrpphp-006 hard-coded static secrets risk rating medium status open description: the code base contained hard-coded static secrets. static secrets by design do not change over time and are valid until explicitly invalidated. as such static secrets represent continuous risk to the enterprise. incorporating static secrets in the source code elevates the risk to the enterprise. static secrets may include: u cloud access keys u jwts with secrets and no set expiration date u private part of key pairs u service access keys and ids that do not require second factor authentication u strong passwords static secrets are different from trivial hard-coded passwords described in finding nccgrpphp-002 on page 11. static secrets are designed to be resistant to brute-force attacks. an attack on static secret require gaining access to secret storage. unlike the dedicated secret storage the source code is not meant for storage of secrets. as a result, the risk to enterprise increases. below are examples of static secrets found in the code. u configuration file contained cloud access keys (aws). the cloud access keys were valid at the time of writing. the cloud access keys were used withenumberate iam tool10 to brute-force account privileges in aws. the tool contained functionality to generate requests for the current version of aws sdk. this allowed discovery of the account privileges. line 7 // aws line 8 define('aws_access_key', 'akia************nuu7e'); line 9 define('aws_secret_key', '6zd*******************j'); $ aws sts get-caller-identity { \"userid\": \"aid***************\", \"account\": \"30************\", \"arn\": \"arn:aws:iam::30*************:user/************\" } the list of static secrets found in the code is placed in the affected resources section. recommendation: secrets should not be hard-coded into the application. rather, they should be stored separately, ideally in a password vault, or in an encrypted file to which only one user has access.11, 12, 13 alternatively, secrets could be injected in the process environment. an example is shown below: 10enumerate iam: https://github.com/andresriancho/enumerate-iam 11hardcoded credentials example:http://nakedsecurity.sophos.com/2014/04/03/is-amazon-hacking-our-apps-or-doing-us-all-a-security-favour/ 12sans top 25 software flaws: number 11, hardcoded credentials:http://software-security.sans.org/blog/2010/03/10/top-25-series-rank-11-har dcoded-credentials/ 13cwe-798: use of hard-coded credentials:http://cwe.mitre.org/data/definitions/798.html line 184 define('mq_password', getenv('mysql_root_password')); line 185 define('mq_enqueue_password', getenv('mysql_root_password')); affects: file line notes /client-api-master/app/config/credentials/jp_ci.php 8-9 aws access key",
  "nccgrpphp-012": "nccgrpphp-012 incorrect creation of static object risk rating medium status open description: a php function declared a static object with the intention to create one instance and return it to all callers. the function was implemented incorrectly and returned a new instance of the object to every call. line 143 /** line 144 * @return updateservice line 145 */ line 146 private function getupdateservice() line 147 { line 148 static $service; line 149 line 150 return $service ?: new updateservice(config::get('adapter')); line 151 } the following test case was created to show the problem: <?php class singleton { function __construct() { print \"in singleton constructor\\n\"; } } class testsingleton { public function badcall() { static $service; return $service ?: new singleton(); } public function goodcall() { static $service; if (!isset($service)) { $service = new singleton(); } return $service; } } $a = new testsingleton(); print(\"========bad calls================\\n\"); $singl1 = $a->badcall(); var_dump($singl1); $singl2 = $a->badcall(); var_dump($singl2); print(\"========good calls================\\n\"); $singl3 = $a->goodcall(); var_dump($singl3); $singl4 = $a->goodcall(); var_dump($singl4); ?> output of the test below shows thatbadcall() function creates new instance of the object every call. ========bad calls================ in singleton constructor object(singleton)#3 (0) { } in singleton constructor object(singleton)#4 (0) { } ========good calls================ in singleton constructor object(singleton)#5 (0) { } object(singleton)#5 (0) { } a list of incorrectly implemented static objects is placed in the affected resources section. recommendation: review list of incorrectly implemented static object. consider if static objects are required in each case. if static objects are required, correct the code. affects: file function lines /client-api-master/src/command/rebuildproductitemsindexcommand.php getupdateservice() 143-151 /client-api-master/src/command/rebuildproductitemsindexcommand.php getdeleteservice() 165-174",
  "nccgrpphp-013": "nccgrpphp-013 all exceptions caught without processing risk rating medium status open description: in a number of places all exceptions were caught without re-throw. as a result, system exceptions were also caught and masked. php classexception is a base class of all exceptions in php.14 the hierarchy of exceptions derived fromexception includes such exceptions aspharexception and overflowexception that are thrown by the php run-time. these exceptions are not meant to be processed by the application as the application has no means of fixing the underlying problem.15 the coding pattern when all exceptions are caught without reprocessing is called \"swallowing exceptions\" or \"eating errors\". the following code shows the pattern: line 410 try { ...<do many things>... line 428 } catch (exception $e) { line 429 log::warn(array( line 430 'message' => 'sendevent failed (messageevent::event_id_mail_send)', line 431 )); line 432 } list of \"eating errors\" pattern implementations is placed inaffected resources section. recommendation: as a general rule, the application should not catch exceptions it cannot process. this rule is applicable to a large set of languages that implement exception hierarchy (c++, java, c#, php, python, etc.). it is recommended to all review the instances of \"eating errors\" pattern in the code and implement specific catch clauses for application exceptions. an example of correct exception handling is shown below. all applications level exceptions are caught and processed and all other exceptions are caught and re-thrown. line 53 try { .. <do things>... line 59 } catch (bankaccountnotfoundexception $e) { line 60 $db->rollback(); line 62 log::info([ ... line 68 } catch (aclexception $e) { line 69 $db->rollback(); line 71 log::info([ ... line 122 } catch (exception $e) { line 123 $db->rollback(); line 124 throw $e; 14php class exception: https://www.php.net/manual/en/language.exceptions.php 15php hierarchy of exceptions: https://www.php.net/manual/en/class.error.php line 125 } affects: file lines /client-api-master/app/models/bulk_distribution_service.php 400-405 /client-api-master/app/models/bulk_distribution_service.php 410-432 /client-api-master/app/models/bulk_distribution_service.php 437-458 /client-api-master/app/models/config.php 141-145",
  "nccgrpphp-016": "nccgrpphp-016 use of md5 and sha1 risk rating medium status open description: the application made use of the md5 ans sha1 algorithms. these algorithms are now considered to be cryptograph- ically weak, in that it is vulnerable to collision attacks. this means that it is possible for an attacker to create two messages that have the same computed hash value. additionally md5 is known to have a number of weaknesses, and is not allowed by the microsoft sdl cryptographic standards.16 a full list of md5 and sha1 usage found in the code is included in the affected resources section. recommendation: md5 and sha1 should be replaced with stronger algorithms, such as one of the sha-2 family. affects: file lines notes /client-api-master/app/models/raw_iv_cert.php 32 sha1 16analysis of md5 weaknesses: http://msdn.microsoft.com/en-us/magazine/ee321570.aspx",
  "nccgrpphp-017": "nccgrpphp-017 inconsistent sql injection prevention risk rating medium status open description: best practice recommendations for prevention of sql injection were not followed in the php code base. as a result, the application has potential sql injection vulnerabilities. the application used php data objects (pdo) and mysql pdo driver to access the database. following vulnerabilities related to sql injection were found: u an attributepdo::attr_emulate_prepares was not set in the pdo. as a result, there was a possibility of prepared statements being emulated. emulation of prepared statements does not offer protection against sql injection.17 u the application used pdo::quote() for processing of untrusted data. pdo::quote is not recommended for defense against sql injection.18 list of places where pdo::quote() was found is placed inaffected resources section. recommendation: prepared statements or equivalent apis that always correctly escape input to protect against sql injection should be used.19 affects: file lines notes /client-api-master/app/models/admin_bulk_contact_sent_push_likes_service.php 20-26 pdo::quote() used 17pdo attribute attr_emulate_prepares: https://www.php.net/manual/en/pdo.setattribute.php 18pdo::quote() : https://www.php.net/manual/en/pdo.quote.php 19php security cheat sheet:https://www.owasp.org/index.php/php_security_cheat_sheet",
  "nccgrpphp-005": "nccgrpphp-005 nested statements without curly braces risk rating low status open description: a number of nested statements did not have curly braces. the omission of curly braces can be misleading, and may lead to the introduction of errors during maintenance. an example of affected code is shown below: line 32 foreach(param::params() as $key => $value){ line 33 if(!is_array($value)) line 34 $_request[$key] = convert_en_to_em($value); line 35 } a full list of locations where nested statements were found without curly braces is placed in the affected resources section. recommendation: add curly braces around nested statements. more information on code correctness rules related to this issue can be found in the references.20 affects: file lines /client-api-master/app/app_controller.php 33-34 20exp52-j. use braces for the body of an if, for, or while statement: https://wiki.sei.cmu.edu/confluence/display/java/exp52-j.+use+braces+for+the+b ody+of+an+if%2c+for%2c+or+while+statement",
  "nccgrpphp-007": "nccgrpphp-007 php api calls without side effects risk rating low status open description: a number of php functions contained php api calls without side effects. such statements do not produce results and are effectively meaningless. this may indicate misunderstanding by software developer of how php apis work. as a result, the program can behave incorrectly as it relies on the result of the api call that was not assigned. an example of a php statements without side effects is placed below: line 68 trim($key); line 69 trim($value); the call to apitrim() was never assigned. the original string value was not changed and a new value created by trim() was lost. as a result, the expectation of the software developer that the string was trimmed was invalid.21 the list of php api calls without side effects is placed in affected resources section. recommendation: a variable should be assigned the result of php api call. php api calls that do not have assignment (no side effects) should be reviewed and removed. affects: file line client-api-master/app/commands/standalone_command.php 68 21php trim() manual: https://www.php.net/manual/en/function.trim.php",
  "nccgrpphp-008": "nccgrpphp-008 unreachable code risk rating low status open description: a number of php functions contained unreachable code. such code would never execute in the program. however, the presence of the code itself may introduce logical errors as developers incorrectly rely of the functionality provided by unreachable code. following is the example of unreachable code in the program: line 252 // databasedepreatedqueryconfig::$deprecated_config line 254 return $next_proxy($dbh, $sql, $params); line 255 line 257 try { line 258 list($ret, $message) = self::searchdeprecatedquery($dbh, $sql); line 259 if ($ret) { line 261 log::error([ line 262 'tag' => 'detect_deprecated_query', line 263 'message' => $message, line 264 ]); line 265 } line 266 } catch (exception $e) { line 267 log::warning($e); line 268 } the return statement on line 254 exits the scope of the function. as a result, code on lines 257-268 would never execute. however, a software developer that miss thereturn statement on line 254 would incorrectly assume code on lines 257-268 executes and would rely on the results. the presence of unreachable or dead code in the program indicates insecure software development lifecycle practices.[^footnotename1] the list of instances of unreachable code is placed inaffected resources section. [^footnotename1] :mitre cwe-561 dead code:http://cwe.mitre.org/data/definitions/561.html recommendation: review all instances of unreachable code. correct the flow to reach the code if the functionality is require. remove the unreachable code if functionality is not required. affects: file lines /client-api-master/app/config/database_sql_hook.php 257-268",
  "nccgrpphp-009": "nccgrpphp-009 variable assigned to itself risk rating low status open description: a number of php functions contained variables assigned to itself. there is not reason to re-assign a variable to itself. either the statement is redundant and should be removed, or the re-assignment is a mistake and some other variable was intended for the assignment instead. the following code shows variables assigned to itself. line 36 } elseif (strpos($url, '#') === 0) { line 37 $url = $url; line 38 } elseif (strpos($url, '?') === 0) { line 39 $url = $url; line 40 } the list of instances of variables assigned to themselves is placed in the affected resources section. recommendation: review the instances of variables assigned to themselves and correct the code. u if the assignment was intended for some other variable fix the code. u if the assignment is a placeholder no operation, refactor the code to avoid assignment altogether. affects: file line client-api-master/app/config/router.php 37",
  "nccgrpphp-010": "nccgrpphp-010 parameter assigned before use risk rating low status open description: a function parameter was assigned in the body of the function before use. this indicates potentially incorrect function logic. the following code illustrates the problem: line 410 public static function getitembrandgroup($options = null) line 411 { line 412 $db = db::conn(); line 414 $rows = $db->rows('select id, name from item_brand_groups order by id asc'); line 415 if (!$rows) { line 416 throw new notfoundexception(); line 417 } line 419 $data = []; line 420 foreach ($rows as $row) { line 421 $item_brand_group = new itembrandgroup($row); line 423 $rows_brands = $db->rows('select item_brand_id from item_brands_item_brand_groups where item_brand_group_id = ? order by id asc', [$row['id']]); line 424 if ($rows_brands) { line 425 $ids = []; line 426 foreach ($rows_brands as $rows_brand) { line 427 $ids[] = $rows_brand['item_brand_id']; line 428 } line 429 if (count($ids) > 0) { line 431 $options = ['ids' => join(',', $ids),]; function getitembrandgroup accepted parameter$options and did not use the value. the parameter was assigned on line 431. as a result the value of the parameter was lost. potential explanations include: u the function is correct. it did not require parameter$options in the first place. the reuse of the name happened accidentally. u the function has a logical error. it should use parameter$options before assignment but never did. it is impossible to evaluate the risk of this issue due to ambiguity of the code. recommendation: do not reuse parameter names in the body of the function. treat all parameters as read-only values.",
  "nccgrpphp-011": "nccgrpphp-011 hard-coded urls and cloud bucket names risk rating low status open description: a number of php files contained hard-coded web service and aws s3 bucket urls. the implementation requires high manual effort to maintain and is prone to human errors. this is indicative of a poor software development lifecycle process. the application was deployed in a number of environments (development, ci, production). corresponding php con- figuration files are listed below. u development deployment - /client-api-aster/app/config/credentials/development.php u ci deployment - /client-api-master/app/config/credentials/ci.php u production deployment - /client-api-master/app/config/credentials/production.php u locale specific - /client-api-master/app/config/deferred_payment_delegator.php the number and format of configuration options for environments were different from each other. this indicated the deployments were also different from each other. as a result, functional tests executed in one environment (ci deployment) could not guarantee successful deployment in the other environment (production). the list of hard-coded urls, s3 bucket names and aws arns is placed in the affected resources section. recommendation: in a mature sdl environment it is beneficial to have very similar deployments in integration test and production. this allows to quickly root cause issues without interrupting production application. new development can also be tested efficiently in the integration test environment before deployment in production. to achieve very similar deployments, the configuration options for both environments should be generated from the same template. this ensures number of options and their format matches between environments. the configuration options should be stored in non-executable format to avoid side effects of php execution. it is recommended to re-engineer the configuration system as follows: u store all secrets, credentials and urls in a secure database u create single configuration file per environment. use high-privilege script with access to secrets database to generate configuration file u inject configuration to the process environment this process will allow to separate life cycle of configuration from source code. the changes in urls and s3 buckets can be tracked in the configuration database. affects: file line notes /client-api-master/app/config/deferred_payment_delegator.php 6, 12, 21, 27 aws s3 buckets /client-api-master/app/config/locale_specific_config/discount_sales_items_banner.p hp 10-12, 18-20 urls",
  "nccgrpphp-015": "nccgrpphp-015 http basic authentication in use risk rating low status open description: the application was accessible from the internet and made use of http basic authentication. in http basic authen- tication, http requests are sent by the client with the authorization header, containing the username and password in a base64-encoded string. this is not a significant security concern by itself and this issue has been included in the report for informational and completeness purposes. the following code used http basic authentication for a curl connection: line 103 curl_setopt($curl, curlopt_userpwd, sprintf(\"%s:%s\", $api[\"basicauth_user\"], $api[\"basicauth_password\"])); the username and password in http basic authentication can be trivially decoded by an attacker who is able to intercept network traffic. for this reason, a secure encrypted transport mechanism should be used in conjunction with http basic authentication. as the application did not enforce validation of tls certificate (details in the issuefind- ing nccgrpphp-014 on page 9), a suitably positioned attacker able to intercept network traffic, would be able to derive the username and password. recommendation: ensure that all traffic between the user's browser and the web server should be enforced over an encrypted channel. this can be achieved by using https, which uses ssl/tls to protect the data. do not disable tls certificate validation as it effectively removes the protection of an encrypted channel."
}