report for: web application, internal infrastructure and mobile application security assessment sample report clientname march 23, 2021 version: 3.0 prepared by: ncc consultant email: n.consultant@nccgroup.com telephone: +44 (0)161 209 5200 ncc group plc - security testing audit and compliance xyz building, 2 hardman boulevard, spinningfields, manchester, m3 3aq https://www.nccgroup.com version 3.0- page 1 of 32 client confidential1 executive summary this report presents the findings of the web application, internal infrastructure and mobile application security as- sessment conducted on behalf of client company ltd (clientname). the assessment was conducted between 15/03/ 2021 and 19/03/2021 and was authorised by clientname. the system being assessed was a website together with its associated mobile application and supporting infrastruc- ture. these platforms allowed client to provide lifestyle advice to their customer base. the ios application collected data on the customer's physical activity during the day. it also allowed the customer to enter details of the food they consumed by scanning bar codes and the weight eaten. data could also be uploaded to client's website for analysis by experts employed by client. 1.1 overview the assessment determined that the security posture of all three components which were examined would benefit from further work to improve the security which was afforded. a number of medium risk issues were identified during the assessment of the mobile application. the issues which were identified could threaten the confidentiality of application data held on a device. only two issues were identified during the assessment of the internal infrastructure; however, one of these was assessed to pose a high risk. the two medium risk issues identified in the web application could be exploited by an attacker in order to capture the credentials of other users or to attack the server. the following table breaks down the issues which were identified by component and severity of risk (issues which are reported for information only are not included in the totals): component critical high medium low total phase 1-web application assessment 0 0 2 3 5 phase 2-internal infrastructure assessment 0 1 0 1 2 phase 3-mobile application and web service assessment 0 0 4 3 7 total 0 1 6 7 14 1.2 assessment summary the most significant issue which was identified was a high risk issue found during the internal infrastructure assess- ment. one item of software had reached the end of its life and was no longer supported by the manufacturer. as such it contained publicly documented security vulnerabilities that would never be addressed by software updates. it is worth noting that all other software was found to be up-to-date and that no security patches were still to be applied. as such, it is possible that this version was in use to provide compatibility with a legacy system. nevertheless, the use of unsupported software still exposes client to long term risk. the assessment of the mobile application identified five medium risk issues. it was found that the application lacked mechanisms to detect whether it was being run on a jailbroken device. this increases the risk that a malicious user could override operating system restrictions. this could allow them to access data which would otherwise be restricted and also to download software from unofficial sources. in addition, it was found that the mobile application used hard-coded credentials to communicate with the web service. an attacker who had jailbroken their device could therefore potentially bypass the normal authentication mechanisms and gain access to server-side systems. the two remaining medium risk issues were associated with the configuration of the encryption used by the web service. one of the encryption protocols is now regarded as cryptographically insecure and has been superseded by a more secure version. the other issue could allow an attacker to launch a denial of service attack. version 3.0- page 2 of 32 client confidentialthe assessment of the web application identified two medium risk issues. the application was vulnerable to reflected cross-site scripting. attacks of this nature can be used to target other legitimate users of an application and are typically used to recover sensitive information such as login credentials or other personal information. a weakness in the file upload mechanism was also assessed to pose a medium risk. the types of file which could be uploaded were not suitably restricted and, as a consequence, it was possible to upload a file containing malicious code. it is acknowledged that no practical means of exploiting this activity was identified during the time available for this security assessment. nevertheless, a determined attacker with more time available might be able to identify a viable technique. this would then allow them to execute code on the server from a remote location. more detailed information on each of the issues which were identified is included in the technical details section of this report. 1.3 strategic recommendations it is recommended that the reason for the use of the outdated software identified in the infrastructure assessment should be investigated. steps should be taken to prepare for the decommissioning and replacement of the unsup- ported software and any associated or legacy systems, as relevant. it is acknowledged that projects of this nature can require considerable resource; nevertheless, this is the only effective way to mitigate the risk these systems expose given that the operating system is no longer supported by the vendor. any gaps in the otherwise robust patching process should also be addressed. it is recommended that the credential handling and authentication methods used by the application should be re- viewed. in particular, the use of hard-coded credentials should be replaced with a more secure mechanism. it is recognised that this will require some redevelopment of the application and so this may also require significant resource. several instances of cross-site scripting were identified in the web application. it is seldom possible to identify all the instances of this issue within a black box assessment of this type and so it is recommended that a code review of the application should be performed. it is important that any remedial activity which is taken should be applied to the entire application rather than just those instances documented here. it is acknowledged that no practical method of exploiting the file upload vulnerability was identified during the assess- ment. nevertheless, given the potential impact if a practical attack were identified, it is recommended that this issue should be addressed as part of a robust, defence in depth approach to security. version 3.0- page 3 of 32 client confidential2 table of contents 1 executive summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.1 overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.2 assessment summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.3 strategic recommendations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 2 table of contents. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 3 technical summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.1 scope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.2 caveats . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.3 post assessment cleanup. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 3.4 risk ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 3.5 findings overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 4 technical details. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 4.1 phase 1 -web application assessment. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 4.2 phase 2 -internal infrastructure assessment. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15 4.3 phase 3 -mobile application and web service assessment. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19 5 supplemental data - reflected cross-site scripting. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 6 supplemental data - network scan results. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 7 supplemental data - sslscan output. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30 8 document control. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 8.1 document data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 8.2 document history . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 8.3 document distribution list . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 9 assessment team . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32 version 3.0- page 4 of 32 client confidential3 technical summary ncc group was contracted by client to conduct a security assessment of the systems within scope in order to identify security issues that could negatively affect client's business or reputation if they led to the compromise or abuse of systems. 3.1 scope the security assessment was carried out in the live environment and included: u web application assessment u internal infrastructure assessment u mobile application assessment the ip address and url within the scope of this test are listed below: u phase 1 assessment: web application assessment https://www.nccgroup-client.co.uk (192.1.1.111) u phase 2 assessment: internal infrastructure testing internaladdress.nccgroup-client.co.uk (10.1.1.123) u phase 3 assessment: mobile application assessment and back-end web service assessment sample mobileapp-version 1.023 publicly released to the store. web service located on: mobilesample.nccgroup-client.co.uk (192.1.1.121) 3.2 caveats during the initial day of testing, test credentials were only available for a standard user for the web application. cre- dentials for a user with administrator's privileges were provided on the second day of testing. this did not significantly affect the coverage that was achieved. due to the nature of the environment, checks that would have a high probability of causing disruption to the named hosts were excluded. denial of service attempts were excluded for the same reason. 3.3 post assessment cleanup any test accounts which were created for the purpose of this assessment should be disabled or removed, as appro- priate, together with any associated content. revert any waf/ids/ips/firewall changes which were made for the purposes of the assessment. version 3.0- page 5 of 32 client confidential3.4 risk ratings the table below gives a key to the icons and symbols used throughout this report to provide a clear and concise risk scoring system. it should be stressed that quantifying the overall business risk posed by any of the issues found in any test is outside our remit. this means that some risks may be reported as high from a technical perspective but may, as a result of other controls unknown to us, be considered acceptable. symbol risk rating cvssv2 score explanation critical 9.0 - 10 a vulnerability was discovered that has been rated as critical. this requires resolution as quickly as possible. high 7.0 - 8.9 a vulnerability was discovered that has been rated as high. this requires resolution in the short term. medium 4.0 - 6.9 a vulnerability was discovered that has been rated as medium. this should be resolved as part of the ongoing security maintenance of the system. low 1.0 - 3.9 a vulnerability was discovered that has been rated as low. this should be addressed as part of routine maintenance tasks. info 0 - 0.9 a discovery was made that is reported for information. this should be addressed in order to meet leading practice. good n/a good security practices were being followed or an audit item was found to be present and correct. version 3.0- page 6 of 32 client confidential3.5 findings overview all the issues identified during the assessment are listed below with a risk rating for each issue. phase 1-web application assessment ref finding risk sr-102-001 reflected cross-site scripting (xss) medium sr-102-002 uploaded file types were not restricted medium sr-102-003 http header discloses internal ip address low sr-102-004 username enumeration via login function low sr-102-005 verbose error messages low phase 2-internal infrastructure assessment ref finding risk sr-102-006 unsupported operating system high sr-102-007 certificate signed with md5 hash low sr-102-008 closed udp ports discovered info phase 3-mobile application and web service assessment ref finding risk sr-102-009 hard-coded credentials medium version 3.0- page 7 of 32 client confidentialref finding risk sr-102-010 ssl certificate checking disabled medium sr-102-011 no jailbreak detection medium sr-102-012 ssl/tls renegotiation dos medium sr-102-014 backgrounding screenshots enabled low sr-102-015 manual screenshots not disabled low sr-102-016 no support for tls versions above 1.0 low version 3.0- page 8 of 32 client confidential4 technical details 4.1 phase 1 -web application assessment sr-102-001 reflected cross-site scripting (xss) risk rating medium status open description: the website was vulnerable to reflected, or non-persistent, cross-site scripting (xss) attacks. this type of vulnerability occurs when data provided by a web client is used immediately by server-side scripts to generate a page of results for the user. if unvalidated user-supplied data is included in the resulting page without full and proper html escaping, client-side executable code may be injected into the dynamic page. in the case of a get request, this means that a url which appears to be associated with the site (and therefore trustworthy to regular users) could contain malicious code that would be executed by the user's browser within the context of the website when the link is visited. in the case of a post request, a victim user would have to first be coerced to an otherwise unrelated site which then launches attack using a form. in this case it was established that theemail_address parameter in the following two urls were vulnerable. evidence of urls requests, payloads and responses redacted other vulnerable locations are noted insupplemental data - reflected cross-site scripting on page 28. reflected cross-site scripting vulnerabilities are extremely common in web applications but can have a serious impact. they are typically used to launch site impersonation or phishing attacks, in which unsuspecting users are lured to malicious sites via links that appear legitimate. the attacker is then free to present the user with what appears to be genuine content, in an attempt, for example, to capture authentication credentials. another common method of exploitation is to capture the session token of the victim user, allowing their session to be hijacked by the attacker. recommendation: reliable avoidance of cross-site scripting vulnerabilities should consist of two stages - input validation and output encoding. input validation involves the application rejecting any characters which are invalid for the field in question, preferably by whitelisting a limited set of characters (in a telephone number field, for example, the whitelisted characters could be 0-9, parentheses, and hyphens). this strategy can also help in mitigating other flaws which stem from a failure to sanitise input, such as sql or http header injection attacks. output encoding requires the encoding of all special characters (such as those used in html and javascript) in potentially malicious data. this is generally done directly before display by web applications (or client-side script), and many programming languages have built-in functions or libraries which provide this encoding (also called quoting or escaping in this context). note that the correct encoding of the output depends on the location that the data is to be used within the response. in the case of it being within the main body of the document, html entities must be encoded. if the input is to be used within a script inside of a string, the quotes used for that string must be escaped. in general, it is important to ensure that it is not possible for the data to include whatever sequence is used to demark the end of that data and the beginning of something else. the application should be reviewed and, if necessary, modified, to handle malicious data properly. the specific in- stances identified in this finding should be addressed, and the application code base should also be examined for any similar issues which may exist. version 3.0- page 9 of 32 client confidentialaffects: ip address dns name page parameter(s) 10.x.x.x www.nccgroup-client.co.uk vulnerablepage.html vulnerablepage2.html email_address email_address version 3.0- page 10 of 32 client confidentialsr-102-002 uploaded file types were not restricted risk rating medium status open description: the web application allowed any type of file to be uploaded, although anti-virus scanning was in place and would detect any attempt to upload malware. the lack of restrictions could allow an attacker to upload an otherwise legitimate file containing malicious code. for example, an attacker might be able target the server itself, by uploading a web shell that would provide the attacker with the capability to run commands on the server and access the file system with the full privileges of the web server process. as a proof of concept, a .php file was uploaded containing malicious code. if triggered, this would have given the attacker command line execution. figure 1: uploaded php file although it was possible to upload a file containing malicious code, access to the directory used to store the uploaded files required an active directory account. accordingly, the risk associated with this issue has been lowered to medium. recommendation: the file types allowed to be uploaded should be restricted to only those that are necessary for business functionality. u the application should perform filtering and content checking on any files which are uploaded to the server. files should be thoroughly scanned and validated before being made available to other users. if in doubt, the file should be discarded. note that the effectiveness of content-checking controls should not be wholly relied upon, and that they will only provide benefit if the anti-virus and malware signatures are regularly updated. it is also recommended that some consideration should be given to storing uploaded files in a database, rather than on the file system. this would significantly reduce the risk associated with the file upload facility, but it is recognised that this might require extensive changes to the current application design affects: ip address dns name 192.1.1.111 www.nccgroup-client.co.uk version 3.0- page 11 of 32 client confidentialsr-102-003 http header discloses internal ip address risk rating low status open description: it was possible to determine an internal ip address by sending a crafted request to the application. an attacker could use this information to gain a greater understanding of the internal network and tailor further attacks. the http request and response shown below illustrate this issue. figure 2: figure 2-http response recommendation: on iis version 7 and above, this issue can be addressed by setting the iis alternatehostname property (as described at the www.iis.net link below). this allows the specified hostname to be used in place of the internal ip address in redirection responses. testing should be performed to ensure that this does not adversely affect any legitimate redirection functionality in the application.1, 2 affects: ip address dns name 192.1.1.111 www.nccgroup-client.co.uk 1cwe-200: information exposure: https://cwe.mitre.org/data/definitions/200.html 2microsoft support - fix: http://support.microsoft.com/kb/834141 version 3.0- page 12 of 32 client confidentialsr-102-004 username enumeration via login function risk rating low status open description: it was possible to enumerate users of the website through the login mechanism. this provided different responses to failed login attempts depending on whether or not the supplied username was valid. an attacker could potentially use this difference in behaviour to compile a list of valid usernames which could then be used as the basis for further attacks against the application. when an authentication attempt was made with a valid username but an incorrect password, the application returned 'invalid password-please try again'. when the username was not in use, the application returned 'your user name has not been recognised-please re-enter it'. figure 3: different responses returned by login functionality recommendation: the login mechanism should be modified to return the same error message for a failed login attempt regardless of whether or not the supplied username is valid.3, 4 affects: ip address dns name 192.1.1.111 www.nccgroup-client.co.uk 3username enumeration vulnerabilitieshttps://www.gnucitizen.org/blog/username-enumeration-vulnerabilities/ 4preventing username enumerationhttps://blog.portswigger.net/2007/04/preventing-username-enumeration.html version 3.0- page 13 of 32 client confidentialsr-102-005 verbose error messages risk rating low status open description: the web application was configured to display detailed error messages when an application exception was generated. printing debugging information in the form of a stack trace associated with an error can leak information about the internal structure of the application which could potentially lead to the discovery or classification of additional vulnerabilities. figure 4: example of verbose error message recommendation: application errors should be handled gracefully, and unnecessary technical information should not be presented to users. applications should return suitably generic but user friendly error messages that do not disclose sensitive information. affects: ip address dns name 192.1.1.111 www.nccgroup-client.co.uk version 3.0- page 14 of 32 client confidential4.2 phase 2 -internal infrastructure assessment sr-102-006 unsupported operating system risk rating high status open description: windows server 2008 was found to be installed on the affected host. this software reached its end of life date in january 2020 and is no longer supported by microsoft. it may contain security vulnerabilities that will never be addressed by microsoft. figure 5: windows server 2008 login page in addition, the length of time this issue has remained unaddressed may indicate a gap in the software patching process. recommendation: this software should be upgraded to the latest stable, secure and supported version of the software.5 investigate the software patching policy and procedures and ensure that updates are applied to all software installa- tions, including third party applications, on a regular basis. 5microsoft product support statushttps://docs.microsoft.com/en-us/lifecycle/products/windows-server-2003- version 3.0- page 15 of 32 client confidentialin particular, it should be ensured that the patching procedures are sufficient to identify software which is about to reach end of life sufficiently early for extended support to be purchased or alternative software purchasedbefore end of life is reached. these procedures should acknowledge that software upgrades sometime also require hardware upgrades and factor this into the relevant timescales. affects: ip address dns name 192.1.1.111 www.nccgroup-client.co.uk version 3.0- page 16 of 32 client confidentialsr-102-007 certificate signed with md5 hash risk rating low status open description: the ssl/tls service on the affected hosts listed below presented an ssl certificate whose digital signature relied on the md5 hashing algorithm. md5 is cryptographically weak and is vulnerable to collision attacks (in which input can be crafted that will result in a hash identical to some other input). this principle can be used to generate spoofed ssl certificates which will be accepted as valid by browsers. this would allow an attacker to create their own certificate with the same signature as the genuine one. they could then use this to masquerade as the affected service as the spoofed certificate would be indistinguishable from the genuine one. whilst this attack has been shown to be possible, it requires a significant amount of computing effort to produce the false certificate. nevertheless, major browser vendors have already implemented updates which treat md5 based certificates as insecure and issue warnings to users (see references below). figure 6: screenshot with signed with md5 hash recommendation: request that the certificate authority reissue the certificate using a stronger hashing algorithm such as sha-256.6, 7, 8, 9 affects: ip address dns name 192.1.1.111 www.nccgroup-client.co.uk 6ssl certificate attack using md5 collisionhttps://www.win.tue.nl/hashclash/rogue-ca/ 7apple https://support.apple.com/kb/ht4999 8microsoft https://support.microsoft.com/kb/2862973 9chromium https://code.google.com/p/chromium/issues/detail?id=101123 version 3.0- page 17 of 32 client confidentialsr-102-008 closed udp ports discovered risk rating informational status open description: port scans revealed the presence of closed udp ports, which can be useful in fingerprinting systems and greatly speed up an attacker's network scans. open udp ports do not have to send an acknowledgement in response to a request, and closed ports are not even required to send an error packet. however, some devices do send an icmp port unreachable packet when a packet is sent to a closed udp port. thus it may be possible to determine if a port is not open. closed udp ports can be useful for fingerprinting remote systems, and increase the accuracy of scan results. unused ports allowed through the firewall also provide an attacker with the ability to bind new services to them if a compromise has occurred. this can enable an attacker to gain extended access or to bounce packets to deeper layers within the architecture. furthermore, closed ports can reveal the administrative habits and history of the device, potentially enabling identifi- cation of services that have been active in the past and that could be accessible in the future. recommendation: all attempts to access unused udp ports should be silently dropped by filtering devices. this can be achieved through blocking the relevant port on the firewall device. affects: ip address dns name 192.1.1.111 www.nccgroup-client.co.uk version 3.0- page 18 of 32 client confidential4.3 phase 3 -mobile application and web service assessment sr-102-009 hard-coded credentials risk rating medium status open description: during testing, it was discovered that the application communicated with the web service using http basic authenti- cation. when http basic authentication is used, the credentials are sent to the server in a base64 encoded format. no cookie or session is upheld, as the authentication header (the base64 string) is sent with each request to authenticate the application's request to the server. the authentication token was the same for every request sent to the web service, suggesting that authentication was on an application level, and users were only authenticated locally. the base64 encoded authentication token was decoded, as per below: authentication token: abcdefghijklmnopqrstuvwftjtratvhxwv5asdrv decoded from base64: svc-sitesbcert:r!m123456qy^zh4u the consultant then inspected the application binary, and discovered that these credentials were hard-coded into the application. if an attacker is able to gain access to the application binary, they would be able to recover the clear-text credentials used to communicate with the web service. additionally, any attacker performing a successful man in the middle attack could sniff the credentials from the http session. once the attacker has successfully obtained the credentials, they would then be able to communicate directly with the web service, and carry out transactions with the same permissions as the application. recommendation: credentials should not be hard-coded into the application as these can easily be recovered by an attacker with access to the binary. if http basic authentication is used, it should be used in conjunction with properly configured tls/ssl. in addition to authentication, each user of the application should be identified to the web service using an authorisation token, which should be checked to ensure the user is authorised to carry out the requested action. this ensures that even if an attacker gains access to the web service authentication credentials, they would not be authorised to carry out any transactions without an authorisation token. affects: "abc 123.ipa" version 3.0- page 19 of 32 client confidentialsr-102-010 ssl certificate checking disabled risk rating medium status open description: the application was found to ignore the in-built ios ssl certificate checking functionality. this meant that it was possible for an attacker to perform a man-in-the-middle attack by presenting their own ssl certificate, and thus nullifies the use of ssl. in ios, when connecting to an https website, if the common name field in the ssl certificate presented by the server does not match the host and domain component of the url, the warning message "cannot verify server identity" is automatically displayed. the application should handle this case gracefully with nsurlconnection's "connection: d idfailwitherror" method. it was discovered that the application disabled the default certificate checking, by using the nsurlconnectionconti nuewithoutcredentialforauthenticationchallenge method. this may have been set by the developer to aid in debugging, or for use when the ssl certificate is self-signed or unknown. certificate checking should never be disabled in a production environment, and the server should always present a valid certificate from a trusted ca. recommendation: in a production environment, ssl certificate checking should be enforced to ensure the confidentiality and integrity of users' information. the application should handle certificate mismatch errors, using the nsurlconnection "conn ection:didfailwitherror" method, and deny connections where there is a certificate mismatch. for a defence in depth strategy, consider the use of certificate pinning to allow only connections using a specific certificate or signed by a specific ca. affects: "abc 123.ipa" version 3.0- page 20 of 32 client confidentialsr-102-011 no jailbreak detection risk rating medium status open description: allowing the application to be installed or run on a jailbroken device exposes the application to trivial and sophisticated attacks, and to reverse engineering. ios jailbreaking refers to the process of removing the limitations imposed by apple on devices (such as the iphone, ipod touch and ipad) through the use of exploit tools. jailbreaking enables users to gain complete control of the ios operating system, allowing them to download additional applications which are not available via the apple store, and to use the device freely with any carrier. jailbreaking an ios device can be a trivial process which takes around five or ten minutes; this process can be undone by reinstalling ios (in around thirty minutes). however, jailbreaking an ios device in this way has security implications, because untrusted code can be installed, security protections can be removed, and installed applications and data can be tampered with (as well as an increased potential for malware on the device). in short, all ios protection mechanisms can be bypassed if a device has been jailbroken, and as such there can be no inherent guarantee of a secure platform, and any data at rest can potentially be decrypted. additionally, jailbreaking can be used on a stolen device in order to help retrieve data from it and access installed applications and services. if the device has no passcode, or a weak passcode set, then the device could be jailbroken to break the security protections included by default. recommendation: it is considered a good security practice to:10 u detect the presence of a jailbreak u refuse to install or run on a system which has been jailbroken below is a very simple example of a test for jailbroken devices (obviously to be successful, more sophisticated checks are required): bool isjailbroken() { #if target_iphone_simulator return no; #else file *f = fopen("/bin/bash", "r"); if (errno == enoent) { // device is not jailbroken fclose(f); return no; } else { // device is jailbroken fclose(f); return yes; } #endif } affects: "abc 123.ipa" 10owasp jailbreak cheatsheethttps://www.owasp.org/index.php/mobile_jailbreaking_cheat_sheet version 3.0- page 21 of 32 client confidentialsr-102-012 ssl/tls renegotiation dos risk rating medium status open description: the remote service encrypts traffic using tls/ssl but allows a client to renegotiate the connection after the initial handshake. an attacker could use this vulnerability to trigger renegotiation of existing ssl connections to cause a denial of service due to resource exhaustion on the server. publicly available dos tools could take advantage of the renegotiation to automate an attack against the server. recommendation: disable renegotiation on the server-side completely. affects: ip address dns name port 192.1.1.121 nccgroup-client.co.uk 7083 version 3.0- page 22 of 32 client confidentialsr-102-014 backgrounding screenshots enabled risk rating low status open description: by default, when an ios application is sent to the background (e.g. by pressing the home button), the operating system will take a screenshot of the current ui and store it for future use. the mobile application did not disable this feature, and hence screenshots containing information on an on-going credit card transaction could be written to the device file system. a user can put an application into a background or suspended state by either single-clicking or double-clicking the home button on the ios device. double-clicking the home button will show the current list of backgrounded appli- cations available for switching to the foreground. to help users identify each application, ios by default will capture a screenshot of the application as it is closed and display that to the user. two images will be saved in the following locations: <app>/library/caches/snapshots/<app identifier>/main/<image.png> <app>/library/caches/snapshots/<app identifier>/main-downscaled/<image.png> figure 7: backgrounding screenshot [example] version 3.0- page 23 of 32 client confidentialin order to exploit this issue, an attacker would have to gain access to the device file system (e.g. by stealing a device, obtaining the user's pin, and jailbreaking it). recommendation: the application should prevent ios from taking a snapshot of sensitive data when the background or suspended state is entered.11, 12, 13 the application can programmatically hide or eliminate sensitive data from the screen before the snapshot is taken. this can be accomplished by setting window.hidden to yes in the applicationdidenterbackground delegate and win- dow.hidden to no in the applicationwillenterforeground delegate. this will have the effect of blanking out the ui before the screenshot is taken and redraws is when the application is relaunched. the exact method used to hide the sensitive data will depend on the application, but some common techniques include blanking of sensitive data fields, covering the entire ui with a default image, or distorting the ui using the uiimageeffects class which is available from ios 7 onwards. affects: "abc 123.ipa" 11ios developer documentation for uiimageeffects: https://developer.apple.com/library/prerelease/ios/samplecode/uiimageeffects/introduction/ intro.html#//apple_ref/doc/uid/dts40013396-intro-dontlinkelementid_2 12ios background screen caching: https://www.virtuesecurity.com/blog/ios-background-screen-caching/ 13ios developer documentation ignoresnapshot: https://developer.apple.com/library/ios/documentation/uikit/reference/uiapplication_class/#// apple_ref/occ/instm/uiapplication/ignoresnapshotonnextapplicationlaunch version 3.0- page 24 of 32 client confidentialsr-102-015 manual screenshots not disabled risk rating low status open description: it was possible for the user to take screen captures of the mobile application, using ios's screenshot key combination. this could lead to images containing sensitive information (such as recently accessed client information) being stored in unencrypted form on the device file system. although it is perhaps unlikely that the user would deliberately take screenshots of their online banking data, it is relatively easy to press the relevant key combination by accident, and this could lead to the inadvertent leakage of sensitive data. the image below is a manual screenshot taken on an ios device (using thepower+home key combination): figure 8: mobile application screenshot [example] recommendation: there is no documented method to prevent manual screenshots being taken on ios at the time of writing, and hence this risk has to be accepted by clientname.14 affects: "abc 123.ipa" 14how to take a screenshot on your iphone, ipad, and ipod touchhttps://support.apple.com/en-gb/ht200289 version 3.0- page 25 of 32 client confidentialsr-102-016 no support for tls versions above 1.0 risk rating low status open description: the affected server did not support tls above version 1.0. since 2008, tls has been at version 1.2, with version 1.3 being defined in august 2018. versions 1.2 and 1.3 of tls are more resistant to known attacks, and tlsv1.2 supports more modern cipher suites that are widely acknowledged to offer the best cryptography available for securing internet connections. tlsv1.3 further improves on security by removing unsafe or unused features, eliminating unnecessary handshake steps and forcing the use of newer encryption methods. it should be noted that use of tls 1.0 and 1.1 is now flagged as insecure (such as by browser warnings) by the major browsers, and in january 2021 the nsa issued guidance urging system administrators to only provide support for tls versions 1.2 or 1.3.15 tls 1.0 was the highest protocol version supported, as shown insupplemental data - sslscan output on page 30. recent versions of all web browsers support 1.2 and 1.3, and therefore supporting these protocols server-side offers better security for those clients using modern browsers. tlsv1.2 also supports a class of cipher suites that offer authenticated encryption with associated data (aead). these cipher suites include an authenticated integrity check within the encryption operation, and are resistant to more attacks than their older counterparts. google's chrome browser states that the security of connections to websites that do not use aead ciphers is "obsolete". currently, this is not presented as an error to the user, merely as information for anyone viewing the page's security report (in the browser's developer console). however, as google continues to push for the rapid adoption of more robust internet cryptography, this message may become more prominent. tlsv1.3 was approved for use in august 2018 and goes to further enhance security. the security benefits of tlsv1.3 include the removal of unsafe or unused features, elimination of unnecessary handshake steps and the forced use of newer encryption methods. as well as preventing encryption downgrade attacks, the streamlined approach to session initiation will offer performance gains over previous tls implementations. it should be noted that major browser vendors have stated that support for tlsv1.0 and 1.1 will be dropped in the near future. supporting tls 1.0 as a security control is non-compliant with the payment card industry (pci) data security standard (dss). while these regulations may not be directly relevant, it should be expected that this directive will become security best practice and may also be reflected in more obvious ways, such as web browser warnings. recommendation: add support for tls v1.2 and v1.3.16, 17, 18, 19, 20, 21, 22 support for tls version 1.0 should be disabled unless there is a specific business requirement to allow users of older, less secure browsers to continue to connect. consider also disabling support for version 1.1, which will become unsupported by major browsers in the near future. all affected hosts should be configured to prefer the latest cipher suites that they offer, such as aes-gcm (tls 1.2 and 1.3 only). the reference from mozilla below provides recommendations on cipher suite ordering based on the profile of con- 15eliminating obsolete transport layer security (tls) protocol configurations -https://media.defense.gov/2021/jan/05/2002560140/-1/-1/0/elimi nating_obsolete_tls_uoo197443-20.pdf 16mozilla server side tls:https://wiki.mozilla.org/security/server_side_tls#recommended_configurations 17obsolete cipher suites:https://www.chromium.org/home/chromium-security/education/tls#toc-obsolete-cipher-suites 18owasp transport layer protection cheat sheet:https://cheatsheetseries.owasp.org/cheatsheets/transport_layer_protection_cheat_sheet.html 19ncc group whitepaper on the configuration of ssl/tls services:www.nccgroup.com 20pci security standards council:https://www.pcisecuritystandards.org/documents/migrating-from-ssl-early-tls-info-supp-v1_1.pdf 21saying goodbye to ssl/early tls:blog.pcisecuritystandards.org 22overview of tls v1.3:https://owasp.org/www-pdf-archive/owasplondon20180125_tlsv1.3_andy_brodie.pdf version 3.0- page 26 of 32 client confidentialnecting clients. affects: ip address dns name port 192.1.1.121 nccgroup-client.co.uk 7083 version 3.0- page 27 of 32 client confidential5 supplemental data - reflected cross-site scripting the vulnerable locations included: <http://www.nccgroup- client.co.uk/ vulnerablepage.html?sortcolumn=&ascending=&nocache=123456789012345&abcde= <script>alert(document.cookie)</script>;//&klmno=&isfromhomepage= http://www.nccgroup- client.co.uk/ vulnerablepage.html?sortcolumn=&ascending=&nocache=123456789012345&abcde =&klmno= <script>alert(document.cookie)</script>;//&isfromhomepage=> http://www.nccgroup-client.co.uk/ vulnerablepage2.html?ajyard=';alert(document.cookie)//klmno =a http://www.nccgroup-client.co.uk/ vulnerablepage2.html?klmno=a';alert(document.cookie)// http://www.nccgroup-client.co.uk/vulnerablepage2.html?ajtype=';alert(document.cookie)// http://www.nccgroup-client.co.uk/vulnerablepage2.html?isfromhomepage=';alert(document.cookie)// an example response is included below: request: http://www.nccgroup- client.co.uk/c2/vulnerablepage.html?sortcolumn=&ascending=&nocache=123456789012345&abcde = </script><script>alert(document.cookie);//&ajlane=&isfromhomepage= response: http/1.1 200 ok server: resin/3.1.8 cache-control: private content-language: en-gb vary: accept-encoding set-cookie: psid=12abcdefghijklmnnpqr==; path=/; expires=tue, 09-mar-2021 23:13:36 gmt content-type: text/html; charset=utf-8 date: mon, 08 mar 2021 23:13:36 gmt content-length: 18349 [...] <script type="text/javascript"> //<![cdata[ autojoin('</script><script>alert(document.cookie);//','',aj type); //></script> version 3.0- page 28 of 32 client confidential6 supplemental data - network scan results this section has been redacted. version 3.0- page 29 of 32 client confidential7 supplemental data - sslscan output redacted. version 3.0- page 30 of 32 client confidential8 document control client confidentiality this document contains client confidential information and may not be copied without written permission. proprietary information the content of this document should be considered proprietary information and should not be disclosed outside of client company ltd (clientname). ncc group gives permission to copy this report for the purposes of disseminating information within your organisation or any regulatory agency. 8.1 document data data classification client confidential client name clientname project reference 99999 proposal reference p99999-sample document title web application, internal infrastructure and mobile application security assessment sample report author ncc consultant 8.2 document history issue no. issue date issued by change description 0.1 2015-01-15 ncc consultant draft for ncc group internal review only 0.2 2015-01-16 a reviewer revised qa 1.0 2018-01-15 ncc consultant released to client 2.0 2018-02-14 ncc consultant cover page address updated 3.0 2021-03-23 ncc consultant minor content and format changes 8.3 document distribution list name role a. sponsor project sponsor, clientname ncc consultant senior security consultant, ncc group a. manager account manager, ncc group version 3.0- page 31 of 32 client confidential9 assessment team the following members of staff were assigned to this assessment: name job title comments ncc consultant senior security consultant crest registered tester (crt), check team member (ctm) version 3.0- page 32 of 32 client confidential