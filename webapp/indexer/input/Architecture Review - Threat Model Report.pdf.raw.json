{
  "ncc-examplecorp001-003": "finding details finding lack of authorization controls for storage api risk high impact: high, exploitability: high identifier ncc-examplecorp001-003 category access controls component camera repository location device association mapper impact a successful exploit would result in the compromise of a1 (user camera images), and lead to a loss of user trust in the secure camera brand. description during interviews, ncc group was notified that the camera repository and storage api use the device id sent in the request to fetch the images that belong to the specified camera. as a result of those interviews, ncc group believes that no validation is performed to ensure the specified device id is associated with the logged in user's account or session id. it appears that a malicious authorized external user could modify the device id sent in their camera's request to the storage api, and potentially view images from the camera repository that they are not authorized to view. exploitation of this issue would result in severe privacy violations for examplecorp's users. if it is true that any user could modify their device id in order to read images from other users' cameras, it would result in significant harms to those users (whose cameras have likely recorded many sensitive images) and to examplecorp's reputation. recommendation ncc group recommends this attack vector be thoroughly assessed during the upcoming manual penetration testing effort. the device association mapper component should confirm with the device ownership manager component that the device id sent in the request belongs to the authenticated user whose session id was presented in the original request. 12 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-011": "finding weak administrative credentials risk high impact: high, exploitability: medium identifier ncc-examplecorp001-011 category configuration component administration api impact if a malicious user is able to guess or brute force the administrator password, they would get unauthorized access to all data in the secure camera system (a1, a2, a6, a7, a8, a9, a10, a11, a12 and a13) from the assets identified inthreat model on page 7. description administrative accounts and internal infrastructure must take extra care to ensure attackers cannot gain access. if the interface allows access using credentials (for example, using a username and password), those credentials should be randomly generated and unguessable. credentials that are simple, widely known, or not changed from the default values represent a single point of compromise for the application. the application has an administrative interface that is protected with weak or default cre- dentials. an attacker with access to this interface may be able to gain access by guessing or brute-forcing those credentials, resulting in full compromise of the application. recommendation change the password to a strong, random value. do not store the password in source code; ensure that only a small number of trusted users have access to the primary admin password. do not use this account for day-to-day access. instead, set up individual accounts for each user with tightly-scoped permissions, and only use the high-privileged account in exceptional scenarios. when employees leave the company, all accounts they have access to should rotate credentials. 13 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-012": "finding plaintext passwords written to logs risk high impact: high, exploitability: medium identifier ncc-examplecorp001-012 category auditing and logging component user management impact an attacker who obtains access to the application's log files would be able to view sensitive information such as user credentials. description applications make use of logging functions to ease development, monitor application activity, or audit actions after the fact. access controls on the log files are often more lax than those on the application itself. for example, if information that is normally stored in an encrypted form is written to a log, an attacker could access it without obtaining the decryption key. additionally, an organization may permit internal access to log files with less strict controls than to the application's database. when creating log entries, therefore, care should be taken to ensure that no sensitive information is written, since this could provide attackers an easier path to obtaining that data. while reviewing the application's design documentation, ncc group identified a code snippet that appears to log sensitive information. the code snippet is listed below: logger.log(\"user entered username \" + username + \" and password \" + password); listing 1:authentication_proof_of_concept.java line 55 recommendation either remove the noted log entries entirely, or carefully sanitize them to remove any sensitive information. once that is done, clear or sanitize the existing logs to remove sensitive data stored within. 14 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-001": "finding sensitive production data used in staging risk medium impact: high, exploitability: medium identifier ncc-examplecorp001-001 category data exposure component processes/procedures impact cloning sensitive data into the staging environment reveals several critical assets of the secure camera system to unauthorized secure camera employees (ta8), and could lead to a loss of user trust in the secure camera brand. description during interviews, ncc group was informed that developers routinely clone data from the production databases for testing purposes into the staging environment. generally, a staging environment is a non-production environment and should not be considered secure. ncc group's experience has shown that non-production environments often have more lax secu- rity controls, including: * less-strict access control policies for administration * high-privileged accounts accessible to testing staff * shared accounts and credentials, which prevent traceability and increase the risk of pass- word leakage * deployment processes allowing for lower-privileged users to deploy code and enable untested, vulnerable code to be deployed recommendation non-production environments should not be considered secure and there should be minimal cross-over between a non-production environment and production data and systems. developers should not have access to sensitive customer information stored in the produc- tion environment, including user camera images (a1), user authentication tokens (a2), user credentials (a9), customer pii (a12), or the oauth signing key (a13). if data is needed in the staging environment databases for testing purposes, ncc group recommends examplecorp develop fake or masked test data for developers to use. this data should contain no customer identifiable information, or reveal any sensitive user data. 15 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-002": "finding use of shared administrator credentials risk medium impact: high, exploitability: medium identifier ncc-examplecorp001-002 category authentication component administration api impact the use of shared credentials removes the ability for examplecorp to track user activity once they are logged into the system. if a malicious insider misuses their access on the system, it will be difficult (or impossible) to determine who was responsible for the malicious act. description during interviews, ncc group was informed that examplecorp employees share the same username and password to login to the secure camera administration web application. fur- thermore, ncc group was informed that these shared credentials have never been changed. recommendation set a strong, complex and unique password for each user who has access to the administrative component. if possible, use public key authentication, with keys protected by a passphrase for authentication into the components. ensure that the host is configured to log both successful and failed login attempts, as well as record activity performed on the hosts after a successful login. 16 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-004": "finding firmware or bootloader downgrades not prevented risk medium impact: medium, exploitability: high identifier ncc-examplecorp001-004 category patching component camera impact an attacker can revert to older images in order to exploit vulnerabilities that had since been fixed. because of the lack of secure boot, it is not possible to implement effective downgrade prevention for this device at the hardware level. description the bootloader does not implement a means to prevent software downgrades. it is common for attackers to downgrade the firmware or software to a version that is known to contain exploitable vulnerabilities. in fact, the release of a security patch can trigger attackers to take notice and develop an exploit for older versions. recommendation implement an effective downgrade prevention mechanism at each stage of the boot process. this could be in the form of a blacklist of \"bad\" software versions. the blacklist must be signed to prevent tampering and must itself be protected from downgrades. many processors contain general-purpose fuses that can be used to implement such protection. 17 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-005": "finding ineffective firmware integrity validation risk medium impact: medium, exploitability: medium identifier ncc-examplecorp001-005 category data validation component camera impact a malicious user can install modified device firmware images on the camera, which could be used to bypass business logic or gain unauthorized access to sensitive information. description during interviews, ncc group was informed that the firmware download package includes a sha256 hash of the firmware image, which is used by the camera to ensure the firmware image has not been tampered with by a malicious user. this is not a sufficient security control, as a malicious user who has the ability to modify the firmware image can simply recompute the sha256 hash of the modified image, and replace the hash included in the firmware package. recommendation the firmware package should be protected using a digital signature as apposed to a simple hash. the firmware package should be signed using a private key maintained by exam- plecorp, and the signature validated on the camera prior to firmware installation. 18 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-007": "finding unencrypted communication channel (camera web services) risk medium impact: medium, exploitability: medium identifier ncc-examplecorp001-007 category data exposure component camera impact attackers on the user's local network can intercept and modify traffic, capturing user creden- tials, tokens, and data or modifying traffic flowing between the mobile and web applications and the camera. description the mobile and web applications communicate with the camera using unencrypted http. an attacker with access to the user's local network could easily intercept and monitor or modify the application's communication. the unencrypted data includes the following types of data, which could be captured or mod- ified by an attacker: * credentials, including plaintext wifi passwords and authentication tokens * personally identifiable information (pii) * video footage and audio recordings recommendation where possible, unencrypted protocols should be replaced with encrypted alternatives. http connections should be replaced with https using tls 1.2. in a local-network scenario, it is generally more difficult to deploy and manage tls certificates to enable tls communication. ncc group recommends generating and deploying a device-specific tls certificate to each camera during the manufacturing or registration process. assuming the serial number of the camera is \"sn12345\", then examplecorp's backend could request a tls certificate from a globally-trusted ca for \"sn12345.examplecorpwificameras.com\". alternatively, a self-signed certificate could be generated at registration time and pinned in the mobile application. however, this would not protect any communications occurring from the web application. in addition to simply configuring https, the following changes are also needed to enable secure communications: 1. ensure that unencrypted requests are redirected to https. 2. set the \"secure\" attribute on all sensitive cookies. this will prevent the cookies from leaking over unencrypted channels. 19 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-008": "finding horizontal authorization bypass in storage api risk medium impact: high, exploitability: medium identifier ncc-examplecorp001-008 category access controls component camera repository location auth controller impact employees or contractors of advertising partners are able to modify session identifiers to gain access to end user image files in cloud storage. description authorization controls refer to an application's functionality for verifying user roles and per- missions. authorization controls ensure safe access to the application, the data within, the ability to change the system, and more. every functional piece of the application should have a set of authorization controls that encompasses the use cases surrounding it and prevents unauthorized users from accessing the protected functionality. the application has insufficient authorization controls for access to the storage api. according to interviews with the development team, it was explained that end user and advertising partner authentication uses the same session identifier mechanism, with a specially-modified session token used to differentiate end users from advertising partner sessions. as a result, in certain scenarios, advertising partner employees (threat agent 4, or ta4) may be able to compute valid end user session identifiers to gain access to the storage api as an authorized end user (ta1). although advertising partners were considered out of scope for this engagement, ncc group documented this finding for further verification due to the potential risks to end user data. recommendation all application functionality should have authorization controls in place and validate those controls prior to performing an action, including both data retrieval and data modification. specifically, examplecorp should implement an authorization mechanism that ties user roles to session identifiers in a way that cannot be modified by end users to bypass role-based authorization checks. 20 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-010": "finding application uses weak hash to store passwords risk medium impact: medium, exploitability: medium identifier ncc-examplecorp001-010 category cryptography component user management impact an attacker who is able to compromise the application's storage, such as through a database flaw or information disclosure, can more easily recover user passwords. description the application stores user passwords using unsalted sha256. this hash can be performed very quickly, thus hashed passwords are vulnerable to brute- force cracking. an attacker with access to the hashed passwords is likely to be able to recover significant numbers of plaintext passwords using a tool such ashashcat. passwords are hashed without being salted. a salt is a random per-password value which slows down cracking attempts by requiring attackers to perform a new brute-force attack on each password. for example, with a salt, two users with the password \"123456\" would have different password hashes. without a salt, an attacker can perform their brute-force attack on all of the application's passwords at once without any additional work, or make use of a rainbow table. recommendation ncc group recommends usingbcrypt, a widely-supported hash that handles salting automat- ically. this hashing algorithm is designed to resist brute-forcing attempts. the only aspect of bcrypt that requires manual configuration is the \"cost factor\", a value which determines how many iterations to perform1 (thus determining the amount of processing time necessary to hash a single password). ncc group recommends that most application use a cost factor of 12. on modern processors, this cost factor results in hashing taking approximately half a second for each password.2 to upgrade to a modern password hash, there are a number of possible strategies: * discard all existing hashes and force users to set new passwords. this strategy may work well for applications with a small number of users who can be reached directly, such as internal company applications. * upgrade users at their next login by comparing the existing hash, saving the new hash, and finally discarding the existing hash. this strategy is effective for active users, but can have issues with users who do not log in for long periods of time: their old, weak password hash will remain in the database until they log in. * immediately upgrading all hashes by using the new hashing algorithm on the existing hashed passwords. when users log in, first hash their password with the legacy algorithm, then hash again with the modern algorithm. this strategy is safe in most cases (even for weak algorithms like md5), but requires the application to maintain the backwords-compatibility logic indefinitely. 1see https://security.stackexchange.com/a/3993 for a more in-depth explanation of work factors for password hashing. 2see https://security.stackexchange.com/a/83382 for a benchmark of bcrypt on a recent intel processor. 21 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-013": "finding insecure random number generation risk medium impact: medium, exploitability: medium identifier ncc-examplecorp001-013 category cryptography component device ownership manager impact a malicious user who is able to predict device ids of other cameras can take advantage of finding ncc-examplecorp001-003 on page 12to view the images taken by the camera identified by the device id. description the secure camera system makes use of an insecure random number generator (rng) for the camera device id generation. when used in a context that requires the numbers to be truly unpredictable, usage of an insecure random number generator can completely defeat the security of the system. using an insecure generator, or seeding a secure generator with a predictable value, can allow an attacker to predict the generator's output. the following random number generators are known to be insecure, and should not be used: * java random * php rand, mt_rand * javascript math.random * libc random() * any other random number generator that does not advertise cryptographic randomness recommendation any functionality that relies on a random number generator to generate unpredictable values should use a cryptographically-secure random number generator (csprng). it is strongly encouraged to use a secure rng unless the application's functionality depends on the output being predictable. any usage of an insecure rng should be replaced by a csprng. ncc group recommends using: * unix getrandom() (falling back to/dev/urandom if not available) * windows cryptgenrandom * java securerandom (do not manually seed securerandom) * php random_bytes * javascript window.crypto.getrandomvalues * other: randombytes_buf from libsodium 22 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-006": "finding revenue generating advertisement delivery can be bypassed risk low impact: medium, exploitability: low identifier ncc-examplecorp001-006 category other component mobile application impact users who are able to disable the targeted advertisements will impact the secure camera business model, which relies on advertisement delivery for revenue generation. description during design documentation review, ncc group determined the mobile application peri- odically fetches advertisements from the advertising partner, which is the primary source of revenue for the secure camera platform. it appears possible for a malicious user to disable advertisements by blocking client communication to the advertisement partner, or using a modified version of the client application. this would undermine examplecorp's business model and could ultimately mean the service does not achieve profitability. however, the overall risk of the issue is low because it is very unlikely that the issue would be exploited at scale due to the technical expertise required for users to set up network blocking of the advertising hosts. recommendation client-side controls are difficult to enforce as they are running in an untrusted environment, such as a user's mobile device. consider modifying the current architecture to deliver the targeted advertisements through the secure camera api responses, which then must be called to meet the functional requirement of the mobile application. 23 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample ",
  "ncc-examplecorp001-009": "finding weak password complexity requirements risk low impact: medium, exploitability: low identifier ncc-examplecorp001-009 category authentication component user management impact an attacker may guess insecure user passwords or brute-force weak user passwords in the event of a password database breach. description the secure camera platform does not enforce any restrictions on user or administrator pass- words. the only current password requirement is a length requirement of 4 characters. as a result, it is possible for users to set their passwords to simple values such as \"1234\" or \"abcd\". if a user does use a weak password, an attacker could guess their password and gain access to their account. alternatively, in the event of a password database breach, an attacker is more likely to recover a weak password from a brute-force attack. recommendation when creating or changing user passwords, the application should perform checks for pass- word complexity and reuse of previous credentials. complexity checks may be performed client side in order to provide immediate user feedback, but must be enforced by the backend service, since client-side controls should not be considered an effective security control. ncc group recommends setting a minimum password length of 12 or more characters. do not require users to regularly update passwords, as this results in weaker passwords overall (seenist's new password rules-what you need to knowfrom sophos). finally, strongly consider providing users with the option to use multi-factor authentication for all applications. 24 | sample architecture review - (C) ncc group 2020 ncc group confidentialsample "
}