{
  "sr-128-1-1": "sr-128-1-1 ssh private key in s3 bucket risk rating high ssh private key in s3 bucket description: one ssl private key was identified in the private github repository. whilst the key was not immediately exposed to unauthorised access, storing keys such as this in an online location (and in an unencrypted format) places them at risk of compromise if an attacker gains access to the github account or aws s3 bucket. information could also be disclosed if a client device where the repositories had been cloned were lost or stolen. recommendation: ensure that all ssl private keys which will be used in test, staging and production environments are store d securely and not exposed on public facing systems such as a github repository or in aws s3 buckets. affects: s3 bucket name s3://dev.client.com",
  "sr-128-1-2": "sr-128-1-2 credentials in github repository risk rating medium credentials in github repository some instances of what appeared to be aws and jfrog passwords or credentials were noted in the private github project repository. whilst it was not possible to establish from the repositories alone whether all of these were in use in production, in general it is not recommended that credentials should be stored in source code repositories in clear text. instances of passwords stored in cloud formation template files: https://github/clientuk/project/develop/config https://github/clientuk/project/develop/deployment/fullstart.json additionally, a hard-coded password was noted in python and shell scripts: https://github/clientuk/project/develop/scripts/s3_pull.py https://github/clientuk/project/develop/deployment/s3_pull_t.py it was not possible to perform any successful privilege escalation with these credentials. the aws credentials were for roles or iam users with s3 buckets who were accorded only limited permissions. a list of the files found to contain passwords is available in supplemental data, section 3.1. recommendation: ensure that credentials are not stored in clear text in github repositories or in aws s3 buckets. affects: github repository project",
  "sr-128-1-3": "sr-128-1-3 good practice observed risk rating good good practice observed description: it was apparent that security had been a consideration in the development and deployment of the pipeline and its environment. the risk from various security flaws had been effectively mitigated. a number of useful controls and processes were observed to be in place. these included: * enforced code reviews * defined checks for committing * separate teams were responsible for different systems * developers could not bypass pipeline steps to introduce new code or change existing code * the use of multi-factor authentication was enforced for all aws and github access recommendation: ensure that these practices are maintained by means of training programmes and supporting procedures which define secure and acceptable practices within the organisation.",
  "sr-128-2-1": "sr-128-2-1 github oauth misconfiguration risk rating high github oauth misconfiguration description: the github oauth plugin provided authentication and authorisation methods for the jenkins server. the authorisation settings granted read permissions to all authenticated users. this meant that any user registered with and logged into github could access jenkins, even though the participant in organization setting was originally set to prevent users from outside the organisation being able to access jenkins. figure 1 -read permissions granted to all authenticated users it was possible to exploit this issue in combination with the security weakness described in the jenkins broken access control issue in order to gain access to the build output from all jobs. figure 2 - accessing jenkins with a user who was not a member of the organization recommendation: remove the read permissions to all authenticated users in the global security settings. affects: dns name project-app-jenkins.staging.clientuk references: github oauth plugin https://wiki.jenkins.io/display/jenkins/github+oauth+plugin",
  "sr-128-2-2": "sr-128-2-2 jenkins broken access control risk rating high jenkins broken access control description: jenkins extends its functionality with plugins that c an be developed by third party companies or by individuals. the github oauth plugin was identified as being responsible for authentication and authorisation. however, this plugin contained a bug that ignored the permission relationships and allowed any users to access data , even when this should have been denied as a result of that user's permissions. figure 3 - current user had no access to job details by default figure 4 - bypassing restriction using the available third party url recommendation: apply the workaround in the references or consider using a different authorisation and authentication plugin (after testing has provided a suitable level of assurance). affects: dns name project-app-jenkins.staging.clientuk references: github oauth plugin bug https://issues.jenkins-ci.org/browse/jenkins-54031",
  "sr-128-2-3": "sr-128-2-3 outdated jenkins software risk rating medium outdated jenkins software description: the installed version of jenkins server was outdated and affected by a number of security vulnerabilities. the observed version of the jenkins was 2. 231 while the latest version (at the time of writing) is 2. 259. known software vulnerabilities which were unpatched in the observed version included csrf and xss weaknesses. known issues also included missing permissions checks and the potential disclosure of s mtp passwords. these vulnerabilities could allow an attacker to steal the session of an administrator, gain access to sensitive information or create files and potentially execute code on the host system. this issue has been rated as a medium risk to reflect these issues and their assigned cvss scores. recommendation: update the version of the affected jenkins server to the latest stable and secure version available. perform any testing necessary to ensure that this does not break or conflict with required functionality. review the current policy for upgrading jenkins servers and create a plan that ensures jenkins can be maintained at the latest stable version, while still ensuring adequate testing so as to minimise disruption. affects: dns name project-app-jenkins.staging.clientuk references: jenkins security advisory 2020-08-12 https://www.jenkins.io/security/advisory/2020-08-12/ jenkins website: changelog https://jenkins.io/changelog/ https://jenkins.io/changelog-stable/",
  "sr-128-2-4": "sr-128-2-4 csrf protection disabled risk rating medium csrf protection disabled description: the built-in jenkins csrf token had not been enabled. this increases the risk of a successful csrf attack which could allow an attacker to manipulate a user or an administrator into unwittingly performing actions within the application (such as changing the account password, adding accounts to the system and changing settings) on behalf of the attacker. figure 5 - crsf protection option not enabled for a csrf attack to succeed, the victim must click a malicious link or visit a malicious web page while logged in to the vulnerable application. this would cause the victim's browser to issue get or post requests to the vulnerable site by means of hidden images or embedded javascript code. as far as the application is concerned, these forged requests would appear to be the result of genuine actions performed by real users clicking on elements within the application. this is because the application did not sufficiently validate requests (such as by means of random tokens) to allow it to make this distinction. recommendation: enable the csrf token protection in jenkins. one time tokens are t he primary defence against csrf . tokens are validated server-side to ensure that requests can only be executed once. the token which is received must match the server -side information. affects: dns name project-app-jenkins.staging.clientuk references: jenkins csrf protection https://wiki.jenkins.io/display/jenkins/csrf+protection remote access api https://wiki.jenkins.io/display/jenkins/remote+access+api jenkins csrf protection explained https://support.cloudbees.com/hc/en-us/articles/219257077-csrf-protection-explained",
  "sr-128-2-5": "sr-128-2-5 clear text credentials risk rating low clear text credentials description: jenkins uses the workspace directory to build projects, to store the checkout source code and to store the files generated by the build itself. however, some files in the workspace directory w ere not automatically deleted . some of these remaining files included credentials in clear text format, and had world readable permissions. figure 6 - example file containing api key in the workspace directory figure 7 - some files had world readable permissions in the workspace directory this could allow an attacker with ssh or script console access to recover credentials to different systems. recommendation: use the workspace cleanup plugin to remove files that contain credentials such as docker configuration file s or shell scripts. affects: dns name project-app-jenkins.staging.clientuk references: workspace cleanup plugin https://wiki.jenkins.io/display/jenkins/workspace+cleanup+plugin how to use workspace cleanup plugin https://blog.clairvoyantsoft.com/jenkins-cleanup-workspace-reduce-disk-usage-18310097d3ef",
  "sr-128-3-1": "sr-128-3-1 root account used recently risk rating medium root account used recently description: it was confirmed that the \"root\" account had been used recently as part of the security checks of the amazon console. amazon security best practice recommends that this account should only be used when strictly necessary. other accounts with more suitably restricted permissions should be used for daily administrative duties. the following screenshot demonstrates that the root account was used recently on t he 2020-08-12: figure 8 - root account usage the use of the root account was discussed with client staff, who revealed that the use of the root account is part of a corporate account, and project staff had no direct control over the account. recommendation: the use of the root account should be minimised. other accounts should be created following the principle of least privilege and used for management. this will reduce the risk of accidental changes and unintended disclosure of highly privileged credentials. this would also better align the aws account with amazon recommended security best practice. affects: aws account 123456789012:root references: aws identity and access management (iam) https://aws.amazon.com/iam/ aws identity and access management documentation https://aws.amazon.com/documentation/iam/ aws documentation - iam best practices http://docs.aws.amazon.com/iam/latest/userguide/iambestpractices.html cis amazon web services foundations https://d0.awsstatic.com/whitepapers/compliance/aws_cis_foundations_benchmark.pdf",
  "sr-128-3-2": "sr-128-3-2 iam password policy risk rating medium iam password policy description: weaknesses were noted in the password policy enabled in the iam settings. this could result in the creation of weak user passwords , more easily susceptible to recovery by an attacker . furthermore, these settings could allow a weak password to be used for an extended period of time. the following screenshot illustrates the password policy settings that were observed. note that the check boxes for the options prevent password reuse, require at least one non-alphanumeric character and enable password expiration were not selected: figure 9 - password policy not enforced the prevent password reuse option will not allow a user to reuse a previous password value when setting a new password (which otherwise might allow continued use of the same password). the number of previous passwords which are not allowed can be set between 1 and 24. passwords can be set to expire after a period between 1 and 1095 days. it is worth noting that some more recent password guidance suggests not setting passwords to expire, but that this advice is given in the expectation that all passwords are of suitably strong and that other controls (such as mfa) are used where appropriate. recommendation: ensure a strong password policy is in place. specifically, ensure that the following password policy is enforced: * passwords should include at least one symbol * passwords cannot be reused * passwords should be reused * passwords should use mixed case * passwords should include at least one number * passwords require minimum length of 14 characters affects: aws account 123456789012 references: aws identity and access management (iam) https://aws.amazon.com/iam/ aws identity and access management documentation https://aws.amazon.com/documentation/iam/ aws documentation - managing passwords http://docs.aws.amazon.com/iam/latest/userguide/credentials-managingpasswords.html",
  "sr-128-3-3": "sr-128-3-3 ebs volumes without encryption risk rating medium ebs volumes without encryption description: elastic block store (ebs) based full disk encryption (fde) was not enabled on the ebs volumes. due to the nature of a cloud -hosted environment, hosted data stored on virtual drives can be re -assigned to other hosts, often beyond the account that owns it. i f an administrator removes a virtual drive from a hosted machine, this data can be re-assigned elsewhere and in some circumstances recovered. amazon have stated that drives are wiped after deletion; however, fde ensures that if a virtual drive is removed and re-assigned to a different host controlled by another aws account then this data would be very difficult, if not impossible, to recover. the following figure highlights the volumes that did not have encryption enabled: figure 10 - ebs volumes lacking encryption 114 volumes were flagged and are detailed in supplemental data, section 3.3. recommendation: encrypt all hosted machine virtual drives that host intellectual property or sensitive data. furthermore, os based encryption (such as luks or bitlocker) ca n be leveraged in order to mitigate the risk from this issue. affects: see supplemental data, section 3.3. references: amazon ec2 https://aws.amazon.com/ec2/ amazon elastic compute cloud documentation https://aws.amazon.com/documentation/ec2/ aws security whitepaper - elastic block storage security (page 24) https://d0.awsstatic.com/whitepapers/aws-security-whitepaper.pdf aws documentation - amazon elastic block store (amazon ebs) https://docs.aws.amazon.com/awsec2/latest/userguide/amazonebs.html",
  "sr-128-3-4": "sr-128-3-4 automated backups not enabled for rds instances risk rating medium automated backups not enabled for rds instances automated backups had not been enabled for a number of relational database service (rds) instances. this feature facilitates the creation of periodic rds instance snapshots, which in turn ensure that data restoration is possible in the event of an incident affecting the source database. the following screenshot from the aws trusted advisor shows that the main-components-db-stage and region-components-db-stage rds instances had automated backups disabled: figure 11 - rds instances with automated backups disabled recommendation: ensure that all rds database instances that host sensitive data have automated backups enabled for point-in-time recovery. affects: rds instance main-components-db-stage region-components-db-stage references: amazon relational database service (rds) https://aws.amazon.com/rds/ amazon relational database service documentation https://aws.amazon.com/documentation/rds/ aws documentation - backing up and restoring amazon rds db instances https://docs.aws.amazon.com/amazonrds/latest/userguide/chap_commontasks.backuprestore.html",
  "sr-128-3-5": "sr-128-3-5 s3 bucket configuration allowing clear text communications risk rating medium s3 bucket configuration allowing clear text communications description: the observed configuration for several s3 buckets did not enforce the use of ssl/tls connections, or prevent clients from connecting over clear text protocols. communication between clients and s3 buckets could use unencrypted http as well as https as the use of https was not enforced. as a result, sensitive information could be transmitted in clear text over the network. the following buckets were found not to enforce the use of encrypted communication: * project-jenkins-stage * project-xa-jenkins-stage * project-xb-jenkins-stage the following screenshot shows the policy for one of the buckets listed above: figure 12 - policy allowing clear text communications this configuration presents an opportunity for an intercepting party to capture sensitive data. in general, any data that is in any way sensitive should only be communicated over https. recommendation: the use of clear text protocols should be prevented by enforcing tls as a transport method. adding the following statement to a bucket configuration will ensure objects can only be accessed over tls connections. { \"statement\":[ { \"action\": \"s3:*\", \"effect\":\"deny\", \"principal\": \"*\", \"resource\":[\"arn:aws:s3:::<bucketname>\", \"arn:aws:s3:::<bucketname>/*\"], \"condition\":{ \"bool\": { \"aws:securetransport\": false } } } ] } affects: s3 buckets project-jenkins-stage project-xa-jenkins-stage project-xb-jenkins-stage references: amazon s3 https://aws.amazon.com/s3/ amazon simple storage service documentation https://aws.amazon.com/documentation/s3/ aws documentation - aws global and iam condition context keys https://docs.aws.amazon.com/iam/latest/userguide/reference_policies_condition-keys.html aws documentation - iam json policy elements: condition operators https://docs.aws.amazon.com/iam/latest/userguide/reference_policies_elements_condition_operators.html aws documentation - iam policy elements: variables https://docs.aws.amazon.com/iam/latest/userguide/reference_policies_variables.html",
  "sr-128-3-6": "sr-128-3-6 s3 bucket without default encryption risk rating medium s3 bucket without default encryption description: analysis of the s3 configuration indicated that a number of buckets did not have default encryption enabled. s3 default encryption provides a way to set the default encryption behaviour for an s3 bucket. w hen enabled, all objects will be encrypted when they are stored in the bucket. this will be done automatically, without having to construct a bucket policy that rejects objects that are not encrypted. the following buckets were found not to have default encryption enabled: * project-jenkins-stage * project-xa-jenkins-stage * project-xc-jenkins-stage * project-y99-jenkins-stage * project-za-jenkins-stage * project-xab-jenkins-stage * project-zd-jenkins-stage the following screenshot shows an s3 bucket with default encryption not enabled: figure 13 - bucket without default encryption enabled it was noted that default encryption was enabled on other s3 buckets configured on the system. recommendation: enable default encryption on all s3 buckets. affects: s3 buckets project-jenkins-stage project-xa-jenkins-stage project-xc-jenkins-stage project-y99-jenkins-stage project-za-jenkins-stage project-xab-jenkins-stage project-zd-jenkins-stage references: amazon s3 https://aws.amazon.com/s3/ amazon simple storage service documentation https://aws.amazon.com/documentation/s3/ aws documentation - using encryption https://docs.aws.amazon.com/amazons3/latest/dev/usingencryption.html aws documentation - how do i create an s3 bucket? https://docs.aws.amazon.com/amazons3/latest/user-guide/create-bucket.html aws documentation - amazon s3 default encryption for s3 buckets https://docs.aws.amazon.com/amazons3/latest/dev/bucket-encryption.html aws news blog - new amazon s3 encryption & security features https://aws.amazon.com/blogs/aws/new-amazon-s3-encryption-security-features/",
  "sr-128-3-7": "sr-128-3-7 policy allows \"assumerole\" action for any resource risk rating medium policy allows \"assumerole\" action for any resource description: one of the iam inline security policies reviewed during the assessment included the assumerole action, without limiting it to a specific resource. the security token service (sts) is a service that enables requesting temporary, limited-privilege credentials for users. the assumerole action implemented by the sts returns a set of temporary credentials that can be used to access aws resources. a user, group or role with access to this action through the identified policies would be allowed to assume any role in any account that trusts the user's account. this is contrary to the principle of least privilege, as suggested by aws security best practice. the following security policy was affected by this issue: * arn:aws:iam::123456789012:policy/jenkins-policy the following statement was included in this policy: { \"action\": [ \"sts:assumerole\" ], \"effect\": \"allow\", \"resource\": [ \"*\" ] } if resource is set to * as in the case above, then the user receiving this policy can assume any role in any account that trusts the user's aws account ( that is, the role's trust policy specifies the user's account as principal). recommendation: the policies affected by this issue should be reviewed. one potential mitigation is to specify the complete arn of the role that the user should be allowed to assume. for example, the following policy sets this restriction: { \"version\": \"2012-10-17\", \"statement\": { \"effect\": \"allow\", \"action\": \"sts:assumerole\", \"resource\": \"arn:aws:iam::<account-id>:role/[role to be assumed]\" } } this helps prevent the user from assuming roles that have more permissions than the user has been granted - that is, from being able to obtain elevated privileges. affects: iam policy jenkins-policy references: aws identity and access management (iam) https://aws.amazon.com/iam/ aws identity and access management documentation https://aws.amazon.com/documentation/iam/ aws documentation - granting a user permissions to switch roles http://docs.aws.amazon.com/iam/latest/userguide/id_roles_use_permissions-to-switch.html aws documentation - assumerole https://docs.aws.amazon.com/sts/latest/apireference/api_assumerole.html",
  "sr-128-3-8": "sr-128-3-8 policy allows \"passrole\" action for any resource risk rating medium policy allows \"passrole\" action for any resource description: a number of the iam managed and inline security policies reviewed during the assessment included the \"passrole\" action, without lim iting it to a specific resource. to pass a role (and its permissions) to an aws service, a user must have permissions to pass the role to the service. this helps administrators ensure that only approved users can configure a service with a role that grants permissions. creating a policy that includes the \"passrole\" permission without restrictions could enable the entity to which this policy is attached to access resources to which it has not been granted explicit access. this is contrary to the principle of least privilege, as suggested by aws security best practice. the following security policies were affected by this issue: * arn:aws:iam::123456789012:role/jenkins-role * arn:aws:iam::123456789012:role/jenkins-role1 the following \"passrole\" permission was configured for the jenkins-role policy: { \"action\": [ \"iam:addroletoinstanceprofile\", \"iam:attachrolepolicy\", \"iam:createinstanceprofile\", \"iam:createpolicy\", \"iam:createrole\", \"iam:deletepolicy\", \"iam:deleterole\", \"iam:detachrolepolicy\", \"iam:getpolicy\", \"iam:getrole\", \"iam:listattachedrolepolicies\", \"iam:listpolicies\", \"iam:listroles\", \"iam:passrole\", \"iam:putrolepolicy\", \"iam:updateassumerolepolicy\" ], \"effect\": \"allow\", \"resource\": [ \"*\" ] } , if resource is set to \"*\" as in the case above, then the user can pass any role. for example, imagine that a user has permissions only to launch ec2 instances, but the roles that the user can pass to an ec2 instance have permissions to work with iam and amazon s3. in this case, the user might be able to launch the instance, log into it, get temporary security credentials and then perform iam or s3 acti ons for which that the user is not authorised. recommendation: the policies affected by this issue should be reviewed. one potential mitigation is to specify the complete arn of the role that the user should be allowed to pass. for example, the following policy sets this restriction: { \"version\": \"2012-10-17\", \"statement\": [{ \"effect\": \"allow\", \"action\": [ \"iam:getrole\", \"iam:passrole\" ], \"resource\": \"arn:aws:iam::<account-id>:role/<role-name>\" }] } this helps prevent the user from running applications that have more permissions than the user has been granted - that is, from being able to obtain elevated privileges. affects: iam policy jenkins-role jenkins-role1 servicerolepolicy autoscalingclusterpolicy references: aws identity and access management (iam) https://aws.amazon.com/iam/ aws identity and access management documentation https://aws.amazon.com/documentation/iam/ aws documentation - granting a user permissions to pass a role to an aws service https://docs.aws.amazon.com/iam/latest/userguide/id_roles_use_passrole.html aws documentation - pass role permissions https://docs.aws.amazon.com/iot/latest/developerguide/pass-role.html aws documentation - using an iam role to grant permissions to applications running on amazon ec2 instances https://docs.aws.amazon.com/iam/latest/userguide/id_roles_use_switch-role-ec2.html aws security blog - granting permission to launch ec2 instances with iam roles (passrole permission) https://aws.amazon.com/blogs/security/granting-permission-to-launch-ec2-instances-with-iam-roles-passrole-permission",
  "sr-128-3-9": "sr-128-3-9 default security group hardening not implemented risk rating medium default security group hardening not implemented description: a number of security groups were identified to be using the default rules, allowing all inbound traffic from instances assigned to the same security group, as well as all outbound traffic. the default security group is assigned to new instances created within a vpc if no custom security groups are assigned to it during configuration. these rules may be overly permissive, for instance allowing an attacker who has compromised one instance with the default security group assigned to use horizontal privilege escalation to compromise all other instances configured with the default security group. as can be seen in the following screenshot from an test organization internal tool used during the assessment, the default security group had permissive rules defined: figure 14 - rules present in default security group the following vpcs were found to have default security groups configured with the default rules: * region 1: vpc 1 vpc 5 * region 2: vpc a vpc b it is good security practice to harden the default security group by removing all rules. any new instance created within a vpc will then be unable to communicate with other instances until custom security groups (conforming to security best practice) have been assigned. recommendation: in order to improve system hardening, remove all rules from the default security group so that it restricts all traffic. should an instance be created without custom security groups, it will inherit the default security group and be unable to communicate with other instances within the vpc until the required custom security groups are assigned. each vpc should be configured with custom security groups that conform to the practice of 'least privilege'. these custom security groups should be assigned on a case-by-case basis to the instances that require them, allowing communication within instances and to the wider internet under tightly controlled conditions. affects: ip address vpc 1 vpc 5 vpc a vpc b references: amazon virtual private cloud https://aws.amazon.com/vpc/ amazon virtual private cloud documentation https://aws.amazon.com/documentation/vpc/ aws documentation - security groups for your vpc https://docs.aws.amazon.com/amazonvpc/latest/userguide/vpc_securitygroups.html cis amazon web services foundations https://d0.awsstatic.com/whitepapers/compliance/aws_cis_foundations_benchmark.pdf",
  "sr-128-3-10": "sr-128-3-10 single availability zone rds instance risk rating low single availability zone rds instance description: one relational database service (rds) instance was configured without the multi availability zone option enabled. without this, should an availabili ty zone specific database failure occur, then amazon rds cannot automatically fail over to the standby availability zone so that database operations can resume quickly without administrative intervention. the following database instance was configured with multi-az disabled: * components-db-stage the following screenshot shows that multi-az was disabled for the instance listed above: figure 15 - rds availability zones recommendation: consideration should be given to modifying the configuration of the database instance to enable multi-az. this is especially important if the applications using the database require high availability. affects: rds instance components-db-stage references: amazon relational database service (rds) https://aws.amazon.com/rds/ amazon relational database service documentation https://aws.amazon.com/documentation/rds/ aws documentation - high availability (multi-az) https://docs.aws.amazon.com/amazonrds/latest/userguide/concepts.multiaz.html",
  "sr-128-4-1": "sr-128-4-1 kubernetes pod security policy overly permissive risk rating medium kubernetes pod security policy overly permissive description: the cluster did make use of the kubernetes pod security policy feature , but was configured to allow any user to create privileged containers. as a result, any user with the ability to create new pods on the cluster would be able to gain privileged access to the underlying cluster nodes and any secrets contained within them. kubernetes provides this feature to restrict the privileges which can be granted by users to newly created pods. this can be used to prevent mounting of host file systems and other rights, which could allow unauthorised access to the underlying operating system running on the cluster nodes. the policies configured within the project-staging cluster did not force pods to run as non-root users, and allowed privileged containers to be created and run. the output below provides evidence of the affected configuration option: <redacted> recommendation: ensure that a pod security policy is defined for all namespaces in the cluster. this policy should provide minimal rights restricting the ability of pods to gain escalated privileges within the cluster. affects: cluster name project-staging references: cis kubernetes benchmark - check 1.1.24 https://www.cisecurity.org/benchmark/kubernetes/ kubernetes pod security policies https://kubernetes.io/docs/concepts/policy/pod-security-policy/ effective implantation of pod security policies https://octetz.com/posts/setting-up-psps",
  "sr-128-4-2": "sr-128-4-2 kubernetes unrestricted cluster network risk rating medium kubernetes unrestricted cluster network description: there were no egress restrictions on traffic from pods in the cluster network. as a result, a compromised container would be able to attack kubernetes' management interfaces. by default, kubernetes clusters provide an unrestricted flat network for all pods running on them. this can be restricted in recent versions by using kubernetes net work policies. these policies can be defined to restrict inbound and outbound access from the pods running on the cluster. as this feature was not in place it was possible to contact services running in the cluster and the management services running on the nodes. recommendation: ensure that kubernetes network policies are in place for all services running on the cluster. these policies should be constructed on a 'least privilege' basis to allow only required traffic. affects: cluster name project-staging references: cis kubernetes benchmark check 1.6.2 https://www.cisecurity.org/benchmark/kubernetes/ kubernetes network policy https://kubernetes.io/docs/concepts/services-networking/network-policies/",
  "sr-128-4-3": "sr-128-4-3 outdated kubernetes in use risk rating medium outdated kubernetes in use description: the kubernetes service was found to be out of date, leaving the clusters and their respective containers potentially open to both security and functional issues that have been patched in later versions. due to its very fast development rate, vulnerabilities that are found in kubernetes often apply to numerous versions; however, patches are usually released soon after to remediate any current issues. issues disclosed in previous versions have included privilege escalation and information disclosure issues, some of which could potentially allow a malicious user to take full control of a cluster. although no significant vulnerabilities were found in the observed versions of kubernetes, it is strongly recommended that all clusters are kept up to date, in line with security best practice. the code snippet below shows the current version of the kubernetes clusters under review: server version: version.info{major:\"1\", minor:\"16\", gitversion:\"v1.16.2\", gitcommit:\" xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\", gittreestate:\"clean\", builddate:\"2019-10-20t09:56:31z\", compiler:\"gc\", platform:\"linux/amd64\"} recommendation: review the current patching policy for kubernetes and ensure that all clusters are updated to the latest stable version regularly. it should also be noted that the current support life cycle length for versions of kubernetes is nine months. affects: cluster project-staging"
}