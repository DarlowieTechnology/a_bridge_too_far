{
"finding_dict": {
"iSEC-WMF1214-8" : {
  "title": "Reflected XSS in api.php",
  "vulnClass": "Data Validation",
  "severity": "High",
  "difficulty": "Low",
  "identifier": "iSEC-WMF1214-8",
  "targets": "The API endpoint, available at http://devwiki/w/api.php.",
  "description": "The API supports multiple data output formats, some of which have recently been deprecated. The wddx output format will return a response with Content-Type: text/xml . The response always indicates that the wddx output format has been deprecated and instructs the API user to use the json format instead. However, if an API request with this output format is sent to api.php with an invalid parameter, the response will also include an error message that reflects the user-supplied parameter without any output encoding. This allows an attacker to inject XML, which can be used to trick the browser into interpreting the response as XHTML and executing injected JavaScript.",
  "exploitScenario": "An attacker crafts a malicious link with JavaScript that attempts to assign administrative rights to their own user account. They insert the link on a MediaWiki page and wait for an active administrator with the appropriate privileges to click it. When the administrator clicks the link, the JavaScript is reflected in the response, which results in the administrator's browser silently sending a request to grant administrator privilege to the attacker's MediaWiki account.",
  "shortTermSolution": "In this case, because the wddx format is deprecated, no user-supplied data needs to be reflected in the response at all. If there is a specific need to display this error data, including the user-supplied parameters, apply the same output encoding that is used when the xml output format is requested.",
  "longTermSolution": "Implement security regression tests that ensure that appropriate output encoding occurs for all user-supplied data. Implement a content security policy (CSP). CSP is an HTTP header that can control what types of active content (such as JavaScript, applets, and CSS) the browser will allow, based on how the content is presented"
},
"iSEC-WMF1214-3" : {
  "title": "External reference in SVG",
  "vulnClass": "Data Validation",
  "severity": "High",
  "difficulty": "Low",
  "identifier": "iSEC-WMF1214-3",
  "targets": null,
  "description": null,
  "exploitScenario": null,
  "shortTermSolution": null,
  "longTermSolution": null
},
"iSEC-WMF1214-11" : {
  "title": "Stored XSS in uploaded SVG files",
  "vulnClass": "Data Validation",
  "severity": "Medium",
  "difficulty": "Low",
  "identifier": "iSEC-WMF1214-11",
  "targets": "The upload feature, available at http://devwiki/wiki/Special:Upload.",
  "description": "When uploading an SVG file, it is possible to bypass the validation filters and upload an SVG file that executes JavaScript when rendered. The SVG validation is a blacklist-based approach and contains protections against numerous techniques for embedding JavaScript in SVG files; however, the protections against nested SVG files are inadequate due to a missing MIME type blacklist.",
  "exploitScenario": "An attacker crafts a malicious SVG document that contains canned JavaScript exploit code and uploads it to a popular section on the MediaWiki application. When the SVG file is viewed, the victim's browser is fingerprinted and instructed to download appropriate exploit code from an attacker-controlled server.",
  "shortTermSolution": "Modify the SVG validation blacklist filters to include the application/xml MIME type. Verify that no other MIME types can be used to embed nested SVG files.",
  "longTermSolution": "Transition the SVG validation logic to a whitelist-based approach."
},
"iSEC-WMF1214-13" : {
  "title": "Entity expansion in SVG and XMP Metadata",
  "vulnClass": "Denial of Service",
  "severity": "Medium",
  "difficulty": "Low",
  "identifier": "iSEC-WMF1214-13",
  "targets": "The XML parser of the upload feature, available at http://devwiki/wiki/Special:Upload.",
  "description": "When uploading an SVG file, or any file that includes XMP metadata, it is possible to include XML Doctype Declarations that trigger an XML entity expansion attack against the XML parser when the uploaded file is processed. This attack uses a series of expanding XML entities that, when fully expanded, can consume a large amount of memory . This causes the XML parser to consume all available resources on the system, leaving the webserver unresponsive.",
  "exploitScenario": "A MediaWiki user wishes to suppress information contained on Wikimedia Foundation's website during a sensitive election period. To accomplish this, the attacker uploads a hostile SVG file containing the Billion Laughs attack. The attacker is able to bring the MediaWiki application online for an extended period during a critical timeframe.",
  "shortTermSolution": "Determine if XML DTD support is necessary for the correct processing of uploaded files. Disable DTD parsing if it is unnecessary .",
  "longTermSolution": "Set limits on execution time and resource usage for all scripts that perform entity substitution on XML data."
},
"iSEC-WMF1214-1" : {
  "title": "Lack of upper limit on password length allows DoS",
  "vulnClass": "Denial of Service",
  "severity": "Medium",
  "difficulty": "Low",
  "identifier": "iSEC-WMF1214-1",
  "targets": "The login page, available at http://devwiki/w/index.php?title=Special:UserLogin.",
  "description": "The application does not have an upper limit on the length of a user-supplied password, which allows for arbitrarily large strings to be passed to the password hashing function. Because passwords are hashed by default using PBKDF2+SHA256 with a cost of 10,000, extremely large passwords can be used to consume large amounts of system resources, resulting in the site becoming unresponsive to other requests.",
  "exploitScenario": "An unauthenticated attacker writes a script that attempts to log into a user account with a very large password,e.g. 24MB in size. Running this script repeatedly against Wikimedia Foundation endpoints could cause enough servers to consume their resources, causing the site to become unresponsive or inaccessible to legitimate users.",
  "shortTermSolution": "Implement an upper limit for password strings128 characters should be more than sufficient. Enforce this limit before performing any further processing on user-supplied passwords.",
  "longTermSolution": "Before performing any compression, decompression or hashing operation, ensure that user-supplied data meets basic sanity parameters in terms of size and length."
},
"iSEC-WMF1214-15" : {
  "title": "External reference in PDF",
  "vulnClass": "Data Validation",
  "severity": "Medium",
  "difficulty": "Medium",
  "identifier": "iSEC-WMF1214-15",
  "targets": "The upload feature, available at http://devwiki/wiki/Special:Upload.",
  "description": "PDF files can contain references to external content, such as images, audio, and video. Loading external content from a PDF can be used to de-anonymize users who view the PDF directly using Adobe Reader or another PDF reader.",
  "exploitScenario": "An attacker wishes to determine who reads a specific wiki article. The attacker creates a PDF that loads content from an attacker-controlled server, using an existing PDF document related to the article as a base. A user interested in the topic opens the PDF for more information while reading the article and their PDF reader sends a request to the attacker's server, revealing their IP address, and by extension, their location.",
  "shortTermSolution": "Provide a click-through warning informing users that PDF documents are active content that could potentially de-anonymize them when viewed directly .",
  "longTermSolution": "Convert uploaded PDFs to static images to avoid issues with active content. Ensure the library used for conversion is robust as it will be parsing potentially malicious content on the server side, which could be a greater compromise than individual users. Consider setting up a sandboxed environment."
},
"iSEC-WMF1214-14" : {
  "title": "Stored XSS in PDF files",
  "vulnClass": "Data Validation",
  "severity": "Medium",
  "difficulty": "Medium",
  "identifier": "iSEC-WMF1214-14",
  "targets": "The upload feature, available at http://devwiki/wiki/Special:Upload.",
  "description": "The PDF format allows for documents containing embedded JavaScript. During testing, a PDF that executes JavaScript when the document is opened was successfully uploaded. Testing indicated that this feature only works in Adobe Reader, whereas other readers such as the PDF reader built into Firefox and the PDF reader built into Chrome do not support JavaScript actions.",
  "exploitScenario": "An attacker wishes to determine who reads a specific wiki article. The attacker creates a PDF that uses JavaScript to make surreptitious HTTP requests to an attacker-controlled server, using an existing PDF document related to the article as a base. A user interested in the topic opens the PDF for more information while reading the article and their PDF reader sends a request to the attacker, revealing their IP address, and by extension, their location.",
  "shortTermSolution": "Provide a click-through warning informing users that PDF documents are active content that could potentially de-anonymize them when viewed directly .",
  "longTermSolution": "Convert uploaded PDFs to static images to avoid issues with active content. Ensure the library used for conversion is robust as it will be parsing potentially malicious content on the server side, which could be a greater compromise than individual users. Consider setting up a sandboxed environment."
},
"iSEC-WMF1214-10" : {
  "title": "Custom JavaScript may yield privilege escalation",
  "vulnClass": "Data Validation",
  "severity": "Medium",
  "difficulty": "Medium",
  "identifier": "iSEC-WMF1214-10",
  "targets": "User's custom scripts, such as http://devwiki/w/index.php?title=User:Foo/common.js&action= submit.",
  "description": "When editing any user's custom JavaScript, the script is executed whenever the  Show Preview or  Show Changes buttons are clicked. This could allow an attacker to trick another user into executing JavaScript which hijacks their session. Because privileged users can edit the JavaScript of lower privileged users, this could lead to privilege escalation.",
  "exploitScenario": "A low-privileged user adds some complex custom JavaScript to their account, with malicious code embedded within that directs people to a fake login screen or performs actions on the victim's behalf. The user complains to an Administrator that they are having difficulty with their custom  skin , and asks the Administrator to change a small portion of the script for them. Upon previewing the edit or viewing changes, the malicious code executes in the context of the Administrator's session.",
  "shortTermSolution": "Do not include another user's custom script when previewing or showing changes. These pages should only allow users to edit and view code.",
  "longTermSolution": "The custom JavaScript system has two security flaws (see finding 10 on page 27). Consider deprecating this functionality and allowing users to customize the site using client-side code instead."
},
"iSEC-WMF1214-2" : {
  "title": "Weak password policy",
  "vulnClass": "Configuration",
  "severity": "Medium",
  "difficulty": "High",
  "identifier": "iSEC-WMF1214-2",
  "targets": "The signup page, available at http://devwiki/w/index.php?title=Special:UserLogin&type=",
  "description": "Wikimedia Foundation does not enforce a strong password policy for the MediaWiki application. Upon account creation, a user can enter any password as long as the password is at least 1 character long and different than the user's username. The lack of password complexity requirements often results in a number of users choosing weak passwords, which increases the odds of an attacker to successfully guess user's passwords by performing a brute force or dictionary attack.",
  "exploitScenario": "An attacker makes a small list of very common passwords that likely to be used on MediaWiki, such as ``password'' or ``wiki''. The attacker enumerates all usernames and tries to login with the weak passwords. Because of the large amount of users on MediaWiki, and the weak password policy, the success rate of the attack is high, giving the attacker mass account takeover.",
  "shortTermSolution": "Implement and enforce a policy to require complex passwords. The following is an example of a complex password policy. Passwords should:   be a minimum of eight characters long   contain at least one of each of the following:    an uppercase letter    a lowercase letter    a number    a special character   be different than a user's username   implement a blacklist of passwords that the user cannot use. (e.g., 123456, password, pass-word123, qwerty1!, etc.)",
  "longTermSolution": "In addition to enforcing the use of strong passwords, Wikimedia Foundation should require all admins to authenticate using multi-factor authentication, with the option for non-privileged users to opt-in."
},
"iSEC-WMF1214-5" : {
  "title": "10. Lack of registry lock on domain names",
  "vulnClass": "Configuration",
  "severity": "Medium",
  "difficulty": "High",
  "identifier": "iSEC-WMF1214-5",
  "targets": "The DNS configuration of wikimedia.org, wikipedia.org and mediawiki.org.",
  "description": "There is no DNS registry lock on the various domains of the Wikimedia Foundation. iSEC performed DNS WHOIS queries on the target domains and observed that while ags are in place to prevent client transfers, no registry locks are set up to prohibit server transfers. This could allow for a malicious or compromised registrar 7 to transfer the domain to malicious hosts.",
  "exploitScenario": "An attacker nds a vulnerability on WMF's registrar and is able to comprise it. The attacker modifies the DNS records of all WMF domains and subdomains and redirects all traces to their own servers. Because emails are relying on the DNS records, internal WMF communications are also sabotaged, which slows down investigation of the issue.",
  "shortTermSolution": "Add a registry lock on all WMF domains by adding the following DNS ags: Domain Status : serverDeleteProhibited Domain Status : serverTransferProhibited Domain Status : serverUpdateProhibited",
  "longTermSolution": "Consider setting up a backup communication channel that does not depend on WMF domains to avoid interruption in the event of a failure or compromise of the DNS infrastructure of WMF."
},
"iSEC-WMF1214-7" : {
  "title": "Users can inspect each other's personal JavaScript",
  "vulnClass": "Data Exposure",
  "severity": "Low",
  "difficulty": "Low",
  "identifier": "iSEC-WMF1214-7",
  "targets": "The following pages:  http://devwiki/w/index.php?title=User:Admin/common.js  http://devwiki/w/load.php?debug=false&lang=en&modules=user&only=scripts&skin=vector&user= Admin  http://devwiki/wiki/User:Admin/(skinname).js",
  "description": "MediaWiki allows users to upload custom JavaScript and CSS to alter the interface and functionality of the system. This code is stored as a wiki page, and is visible to any user of the system.",
  "exploitScenario": "A user uploads JavaScript containing personal information that may de-anonymize that user. While the contents of this script are not part of the main indexed website, another user changes the username in one of the above URLs to view the victim's custom code, learning information that may be used to identify the owner of the custom code.",
  "shortTermSolution": "Treat custom script the same as other user preferences by disallowing users from examining these customizations unless they are associated with the logged in account.",
  "longTermSolution": "The custom JavaScript system has two security flaws (see nding 8 on page 24). Consider deprecating this functionality and allowing users to customize the site using client-side code instead."
},
"iSEC-WMF1214-6" : {
  "title": "Check User page lacks Cross Site Request Forgery (CSRF) protection",
  "vulnClass": "Data Validation",
  "severity": "Low",
  "difficulty": "Medium",
  "identifier": "iSEC-WMF1214-6",
  "targets": null,
  "description": null,
  "exploitScenario": null,
  "shortTermSolution": null,
  "longTermSolution": null
},
"iSEC-WMF1214-12" : {
  "title": "User access roles are public",
  "vulnClass": "Data Exposure",
  "severity": "Informational",
  "difficulty": "Low",
  "identifier": "iSEC-WMF1214-12",
  "targets": "The following pages:  http://devwiki/codwiki/index.php/Special:ActiveUsers  http://devwiki/codwiki/index.php/Special:GlobalUsers  http://devwiki/codwiki/index.php/Special:CentralAuth",
  "description": "The target links allow unauthenticated users to look up privileges associated with roles, and the role associated with any existing user. The roles, such as ``administrator'' or ``steward' , disclose the list of operations a specic user has permission to perform. An attacker can use this information to enumerate users with higher privileges and create targeted attacks against them.",
  "exploitScenario": "",
  "shortTermSolution": "Do not show the user roles in the list of users to unauthenticated users while displaying the list of users. Restrict the Global Account information to the privileged users only .",
  "longTermSolution": "Make a chart of what parts of user accounts are considered private or protected, and go through each way of accessing user data and make sure it conforms to specications. Perform regression checks to verify that there is no information disclosure which can be useful to the attacker."
},
"iSEC-WMF1214-4" : {
  "title": "14. RC4 cipher enabled",
  "vulnClass": "Configuration",
  "severity": "Informational",
  "difficulty": "High",
  "identifier": "iSEC-WMF1214-4",
  "targets": "The TLS configuration of WMF servers, such as https://www.mediawiki.org.",
  "description": "The RC4-SHA cipher is enabled in the SSL/TLS configuration of WMF's servers. RC4 is a stream cipher that is often preferred by TLS servers due to its speed; however, security researchers currently demonstrated that this cipher is not suitable to guarantee message confidentiality . The RC4 cipher is flawed in its generation of a pseudo-random stream of bytes so that a wide variety of small biases are introduced into the stream, decreasing its randomness thus creating potential for plain text recovery attacks. An advisory from the IETF, 8 released October 2013, has noted that recent improvements in the attack vectors on RC4 mean that they are on the verge of becoming practically exploitable.",
  "exploitScenario": "An advisory from the IETF advises that:  TLS clients MUST NOT include RC4 cipher suites in the ClientHello message.  TLS servers MUST NOT select an RC4 cipher suite when a TLS client sends such a cipher suite in the ClientHello message.",
  "shortTermSolution": "Remove RC4 from production environments. Update the SSL/TLS configuration to only allow cryptographically strong cipher suites. Refer tohttps://wiki.mozilla.org/Security/ Server_Side_TLS for the latest recommended cipher suite configurations. This list should prefer cipher suites that provide perfect forward secrecy, such as those using elliptic curve Diffie-Hellman (ECDHE).",
  "longTermSolution": "Stay abreast of security community news, such that new SSL/TLS attacks or configuration weaknesses can be immediately patched or remedied. Regularly check web server SSL/TLS configuration using tools like SSLyze10 or SSLLabs.11 Keep cipher suite configurations current with the latest recommended configurations found on the Mozilla Wiki."
}}
}
